<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>心跳信号分类_XCC</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = '@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.7.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.7.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.fa-pull-left {
  float: left;
}
.fa-pull-right {
  float: right;
}
.fa.fa-pull-left {
  margin-right: .3em;
}
.fa.fa-pull-right {
  margin-left: .3em;
}
/* Deprecated as of 4.4.0 */
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
  animation: fa-spin 1s infinite steps(8);
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook-f:before,
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-feed:before,
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before,
.fa-gratipay:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper-pp:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-resistance:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-y-combinator-square:before,
.fa-yc-square:before,
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
.fa-buysellads:before {
  content: "\f20d";
}
.fa-connectdevelop:before {
  content: "\f20e";
}
.fa-dashcube:before {
  content: "\f210";
}
.fa-forumbee:before {
  content: "\f211";
}
.fa-leanpub:before {
  content: "\f212";
}
.fa-sellsy:before {
  content: "\f213";
}
.fa-shirtsinbulk:before {
  content: "\f214";
}
.fa-simplybuilt:before {
  content: "\f215";
}
.fa-skyatlas:before {
  content: "\f216";
}
.fa-cart-plus:before {
  content: "\f217";
}
.fa-cart-arrow-down:before {
  content: "\f218";
}
.fa-diamond:before {
  content: "\f219";
}
.fa-ship:before {
  content: "\f21a";
}
.fa-user-secret:before {
  content: "\f21b";
}
.fa-motorcycle:before {
  content: "\f21c";
}
.fa-street-view:before {
  content: "\f21d";
}
.fa-heartbeat:before {
  content: "\f21e";
}
.fa-venus:before {
  content: "\f221";
}
.fa-mars:before {
  content: "\f222";
}
.fa-mercury:before {
  content: "\f223";
}
.fa-intersex:before,
.fa-transgender:before {
  content: "\f224";
}
.fa-transgender-alt:before {
  content: "\f225";
}
.fa-venus-double:before {
  content: "\f226";
}
.fa-mars-double:before {
  content: "\f227";
}
.fa-venus-mars:before {
  content: "\f228";
}
.fa-mars-stroke:before {
  content: "\f229";
}
.fa-mars-stroke-v:before {
  content: "\f22a";
}
.fa-mars-stroke-h:before {
  content: "\f22b";
}
.fa-neuter:before {
  content: "\f22c";
}
.fa-genderless:before {
  content: "\f22d";
}
.fa-facebook-official:before {
  content: "\f230";
}
.fa-pinterest-p:before {
  content: "\f231";
}
.fa-whatsapp:before {
  content: "\f232";
}
.fa-server:before {
  content: "\f233";
}
.fa-user-plus:before {
  content: "\f234";
}
.fa-user-times:before {
  content: "\f235";
}
.fa-hotel:before,
.fa-bed:before {
  content: "\f236";
}
.fa-viacoin:before {
  content: "\f237";
}
.fa-train:before {
  content: "\f238";
}
.fa-subway:before {
  content: "\f239";
}
.fa-medium:before {
  content: "\f23a";
}
.fa-yc:before,
.fa-y-combinator:before {
  content: "\f23b";
}
.fa-optin-monster:before {
  content: "\f23c";
}
.fa-opencart:before {
  content: "\f23d";
}
.fa-expeditedssl:before {
  content: "\f23e";
}
.fa-battery-4:before,
.fa-battery:before,
.fa-battery-full:before {
  content: "\f240";
}
.fa-battery-3:before,
.fa-battery-three-quarters:before {
  content: "\f241";
}
.fa-battery-2:before,
.fa-battery-half:before {
  content: "\f242";
}
.fa-battery-1:before,
.fa-battery-quarter:before {
  content: "\f243";
}
.fa-battery-0:before,
.fa-battery-empty:before {
  content: "\f244";
}
.fa-mouse-pointer:before {
  content: "\f245";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-object-group:before {
  content: "\f247";
}
.fa-object-ungroup:before {
  content: "\f248";
}
.fa-sticky-note:before {
  content: "\f249";
}
.fa-sticky-note-o:before {
  content: "\f24a";
}
.fa-cc-jcb:before {
  content: "\f24b";
}
.fa-cc-diners-club:before {
  content: "\f24c";
}
.fa-clone:before {
  content: "\f24d";
}
.fa-balance-scale:before {
  content: "\f24e";
}
.fa-hourglass-o:before {
  content: "\f250";
}
.fa-hourglass-1:before,
.fa-hourglass-start:before {
  content: "\f251";
}
.fa-hourglass-2:before,
.fa-hourglass-half:before {
  content: "\f252";
}
.fa-hourglass-3:before,
.fa-hourglass-end:before {
  content: "\f253";
}
.fa-hourglass:before {
  content: "\f254";
}
.fa-hand-grab-o:before,
.fa-hand-rock-o:before {
  content: "\f255";
}
.fa-hand-stop-o:before,
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-scissors-o:before {
  content: "\f257";
}
.fa-hand-lizard-o:before {
  content: "\f258";
}
.fa-hand-spock-o:before {
  content: "\f259";
}
.fa-hand-pointer-o:before {
  content: "\f25a";
}
.fa-hand-peace-o:before {
  content: "\f25b";
}
.fa-trademark:before {
  content: "\f25c";
}
.fa-registered:before {
  content: "\f25d";
}
.fa-creative-commons:before {
  content: "\f25e";
}
.fa-gg:before {
  content: "\f260";
}
.fa-gg-circle:before {
  content: "\f261";
}
.fa-tripadvisor:before {
  content: "\f262";
}
.fa-odnoklassniki:before {
  content: "\f263";
}
.fa-odnoklassniki-square:before {
  content: "\f264";
}
.fa-get-pocket:before {
  content: "\f265";
}
.fa-wikipedia-w:before {
  content: "\f266";
}
.fa-safari:before {
  content: "\f267";
}
.fa-chrome:before {
  content: "\f268";
}
.fa-firefox:before {
  content: "\f269";
}
.fa-opera:before {
  content: "\f26a";
}
.fa-internet-explorer:before {
  content: "\f26b";
}
.fa-tv:before,
.fa-television:before {
  content: "\f26c";
}
.fa-contao:before {
  content: "\f26d";
}
.fa-500px:before {
  content: "\f26e";
}
.fa-amazon:before {
  content: "\f270";
}
.fa-calendar-plus-o:before {
  content: "\f271";
}
.fa-calendar-minus-o:before {
  content: "\f272";
}
.fa-calendar-times-o:before {
  content: "\f273";
}
.fa-calendar-check-o:before {
  content: "\f274";
}
.fa-industry:before {
  content: "\f275";
}
.fa-map-pin:before {
  content: "\f276";
}
.fa-map-signs:before {
  content: "\f277";
}
.fa-map-o:before {
  content: "\f278";
}
.fa-map:before {
  content: "\f279";
}
.fa-commenting:before {
  content: "\f27a";
}
.fa-commenting-o:before {
  content: "\f27b";
}
.fa-houzz:before {
  content: "\f27c";
}
.fa-vimeo:before {
  content: "\f27d";
}
.fa-black-tie:before {
  content: "\f27e";
}
.fa-fonticons:before {
  content: "\f280";
}
.fa-reddit-alien:before {
  content: "\f281";
}
.fa-edge:before {
  content: "\f282";
}
.fa-credit-card-alt:before {
  content: "\f283";
}
.fa-codiepie:before {
  content: "\f284";
}
.fa-modx:before {
  content: "\f285";
}
.fa-fort-awesome:before {
  content: "\f286";
}
.fa-usb:before {
  content: "\f287";
}
.fa-product-hunt:before {
  content: "\f288";
}
.fa-mixcloud:before {
  content: "\f289";
}
.fa-scribd:before {
  content: "\f28a";
}
.fa-pause-circle:before {
  content: "\f28b";
}
.fa-pause-circle-o:before {
  content: "\f28c";
}
.fa-stop-circle:before {
  content: "\f28d";
}
.fa-stop-circle-o:before {
  content: "\f28e";
}
.fa-shopping-bag:before {
  content: "\f290";
}
.fa-shopping-basket:before {
  content: "\f291";
}
.fa-hashtag:before {
  content: "\f292";
}
.fa-bluetooth:before {
  content: "\f293";
}
.fa-bluetooth-b:before {
  content: "\f294";
}
.fa-percent:before {
  content: "\f295";
}
.fa-gitlab:before {
  content: "\f296";
}
.fa-wpbeginner:before {
  content: "\f297";
}
.fa-wpforms:before {
  content: "\f298";
}
.fa-envira:before {
  content: "\f299";
}
.fa-universal-access:before {
  content: "\f29a";
}
.fa-wheelchair-alt:before {
  content: "\f29b";
}
.fa-question-circle-o:before {
  content: "\f29c";
}
.fa-blind:before {
  content: "\f29d";
}
.fa-audio-description:before {
  content: "\f29e";
}
.fa-volume-control-phone:before {
  content: "\f2a0";
}
.fa-braille:before {
  content: "\f2a1";
}
.fa-assistive-listening-systems:before {
  content: "\f2a2";
}
.fa-asl-interpreting:before,
.fa-american-sign-language-interpreting:before {
  content: "\f2a3";
}
.fa-deafness:before,
.fa-hard-of-hearing:before,
.fa-deaf:before {
  content: "\f2a4";
}
.fa-glide:before {
  content: "\f2a5";
}
.fa-glide-g:before {
  content: "\f2a6";
}
.fa-signing:before,
.fa-sign-language:before {
  content: "\f2a7";
}
.fa-low-vision:before {
  content: "\f2a8";
}
.fa-viadeo:before {
  content: "\f2a9";
}
.fa-viadeo-square:before {
  content: "\f2aa";
}
.fa-snapchat:before {
  content: "\f2ab";
}
.fa-snapchat-ghost:before {
  content: "\f2ac";
}
.fa-snapchat-square:before {
  content: "\f2ad";
}
.fa-pied-piper:before {
  content: "\f2ae";
}
.fa-first-order:before {
  content: "\f2b0";
}
.fa-yoast:before {
  content: "\f2b1";
}
.fa-themeisle:before {
  content: "\f2b2";
}
.fa-google-plus-circle:before,
.fa-google-plus-official:before {
  content: "\f2b3";
}
.fa-fa:before,
.fa-font-awesome:before {
  content: "\f2b4";
}
.fa-handshake-o:before {
  content: "\f2b5";
}
.fa-envelope-open:before {
  content: "\f2b6";
}
.fa-envelope-open-o:before {
  content: "\f2b7";
}
.fa-linode:before {
  content: "\f2b8";
}
.fa-address-book:before {
  content: "\f2b9";
}
.fa-address-book-o:before {
  content: "\f2ba";
}
.fa-vcard:before,
.fa-address-card:before {
  content: "\f2bb";
}
.fa-vcard-o:before,
.fa-address-card-o:before {
  content: "\f2bc";
}
.fa-user-circle:before {
  content: "\f2bd";
}
.fa-user-circle-o:before {
  content: "\f2be";
}
.fa-user-o:before {
  content: "\f2c0";
}
.fa-id-badge:before {
  content: "\f2c1";
}
.fa-drivers-license:before,
.fa-id-card:before {
  content: "\f2c2";
}
.fa-drivers-license-o:before,
.fa-id-card-o:before {
  content: "\f2c3";
}
.fa-quora:before {
  content: "\f2c4";
}
.fa-free-code-camp:before {
  content: "\f2c5";
}
.fa-telegram:before {
  content: "\f2c6";
}
.fa-thermometer-4:before,
.fa-thermometer:before,
.fa-thermometer-full:before {
  content: "\f2c7";
}
.fa-thermometer-3:before,
.fa-thermometer-three-quarters:before {
  content: "\f2c8";
}
.fa-thermometer-2:before,
.fa-thermometer-half:before {
  content: "\f2c9";
}
.fa-thermometer-1:before,
.fa-thermometer-quarter:before {
  content: "\f2ca";
}
.fa-thermometer-0:before,
.fa-thermometer-empty:before {
  content: "\f2cb";
}
.fa-shower:before {
  content: "\f2cc";
}
.fa-bathtub:before,
.fa-s15:before,
.fa-bath:before {
  content: "\f2cd";
}
.fa-podcast:before {
  content: "\f2ce";
}
.fa-window-maximize:before {
  content: "\f2d0";
}
.fa-window-minimize:before {
  content: "\f2d1";
}
.fa-window-restore:before {
  content: "\f2d2";
}
.fa-times-rectangle:before,
.fa-window-close:before {
  content: "\f2d3";
}
.fa-times-rectangle-o:before,
.fa-window-close-o:before {
  content: "\f2d4";
}
.fa-bandcamp:before {
  content: "\f2d5";
}
.fa-grav:before {
  content: "\f2d6";
}
.fa-etsy:before {
  content: "\f2d7";
}
.fa-imdb:before {
  content: "\f2d8";
}
.fa-ravelry:before {
  content: "\f2d9";
}
.fa-eercast:before {
  content: "\f2da";
}
.fa-microchip:before {
  content: "\f2db";
}
.fa-snowflake-o:before {
  content: "\f2dc";
}
.fa-superpowers:before {
  content: "\f2dd";
}
.fa-wpexplorer:before {
  content: "\f2de";
}
.fa-meetup:before {
  content: "\f2e0";
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
div.traceback-wrapper pre.traceback {
  max-height: 600px;
  overflow: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  padding: 5px;
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
[dir="rtl"] #ipython_notebook {
  margin-right: 10px;
  margin-left: 0;
}
[dir="rtl"] #ipython_notebook.pull-left {
  float: right !important;
  float: right;
}
.flex-spacer {
  flex: 1;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#kernel_logo_widget {
  margin: 0 10px;
}
span#login_widget {
  float: right;
}
[dir="rtl"] span#login_widget {
  float: left;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
.modal-header {
  cursor: move;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
[dir="rtl"] .center-nav form.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] .center-nav .navbar-text {
  float: right;
}
[dir="rtl"] .navbar-inner {
  text-align: right;
}
[dir="rtl"] div.text-left {
  text-align: right;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  position: absolute;
  display: block;
  width: 100%;
  height: 100%;
  overflow: hidden;
  cursor: pointer;
  opacity: 0;
  z-index: 2;
}
.alternate_upload .btn-xs > input.fileinput {
  margin: -1px -5px;
}
.alternate_upload .btn-upload {
  position: relative;
  height: 22px;
}
::-webkit-file-upload-button {
  cursor: pointer;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
ul#tabs {
  margin-bottom: 4px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
[dir="rtl"] ul#tabs.nav-tabs > li {
  float: right;
}
[dir="rtl"] ul#tabs.nav.nav-tabs {
  padding-right: 0;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons .pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .list_toolbar .col-sm-4,
[dir="rtl"] .list_toolbar .col-sm-8 {
  float: right;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: text-bottom;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
[dir="rtl"] .list_item > div input {
  margin-right: 0;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_modified {
  margin-right: 7px;
  margin-left: 7px;
}
[dir="rtl"] .item_modified.pull-right {
  float: left !important;
  float: left;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
[dir="rtl"] .item_buttons.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .item_buttons .kernel-name {
  margin-left: 7px;
  float: right;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
.sort_button {
  display: inline-block;
  padding-left: 7px;
}
[dir="rtl"] .sort_button.pull-right {
  float: left !important;
  float: left;
}
#tree-selector {
  padding-right: 0px;
}
#button-select-all {
  min-width: 50px;
}
[dir="rtl"] #button-select-all.btn {
  float: right ;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
  margin-top: 2px;
  height: 16px;
}
[dir="rtl"] #select-all.pull-left {
  float: right !important;
  float: right;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.fa-pull-left {
  margin-right: .3em;
}
.folder_icon:before.fa-pull-right {
  margin-left: .3em;
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.fa-pull-left {
  margin-right: .3em;
}
.file_icon:before.fa-pull-right {
  margin-left: .3em;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
#new-menu .dropdown-header {
  font-size: 10px;
  border-bottom: 1px solid #e5e5e5;
  padding: 0 0 3px;
  margin: -3px 20px 0;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.move-button {
  display: none;
}
.download-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
.CodeMirror-dialog {
  background-color: #fff;
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}
.rendered_html ul {
  list-style: disc;
}
.rendered_html ul ul {
  list-style: square;
  margin-top: 0;
}
.rendered_html ul ul ul {
  list-style: circle;
}
.rendered_html ol {
  list-style: decimal;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin-top: 0;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
  padding: 0px;
  background-color: #fff;
}
.rendered_html code {
  background-color: #eff0f1;
}
.rendered_html p code {
  padding: 1px 5px;
}
.rendered_html pre code {
  background-color: #fff;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  color: #000;
  font-size: 100%;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
.rendered_html .alert {
  margin-bottom: initial;
}
.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] .rendered_html p {
  text-align: right;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered .rendered_html td {
  max-width: none;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
.jupyter-keybindings {
  padding: 1px;
  line-height: 24px;
  border-bottom: 1px solid gray;
}
.jupyter-keybindings input {
  margin: 0;
  padding: 0;
  border: none;
}
.jupyter-keybindings i {
  padding: 6px;
}
.well code {
  background-color: #ffffff;
  border-color: #ababab;
  border-width: 1px;
  border-style: solid;
  padding: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.tags_button_container {
  width: 100%;
  display: flex;
}
.tag-container {
  display: flex;
  flex-direction: row;
  flex-grow: 1;
  overflow: hidden;
  position: relative;
}
.tag-container > * {
  margin: 0 4px;
}
.remove-tag-btn {
  margin-left: 4px;
}
.tags-input {
  display: flex;
}
.cell-tag:last-child:after {
  content: "";
  position: absolute;
  right: 0;
  width: 40px;
  height: 100%;
  /* Fade to background color of cell toolbar */
  background: linear-gradient(to right, rgba(0, 0, 0, 0), #EEE);
}
.tags-input > * {
  margin-left: 4px;
}
.cell-tag,
.tags-input input,
.tags-input button {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  box-shadow: none;
  width: inherit;
  font-size: inherit;
  height: 22px;
  line-height: 22px;
  padding: 0px 4px;
  display: inline-block;
}
.cell-tag:focus,
.tags-input input:focus,
.tags-input button:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.cell-tag::-moz-placeholder,
.tags-input input::-moz-placeholder,
.tags-input button::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.cell-tag:-ms-input-placeholder,
.tags-input input:-ms-input-placeholder,
.tags-input button:-ms-input-placeholder {
  color: #999;
}
.cell-tag::-webkit-input-placeholder,
.tags-input input::-webkit-input-placeholder,
.tags-input button::-webkit-input-placeholder {
  color: #999;
}
.cell-tag::-ms-expand,
.tags-input input::-ms-expand,
.tags-input button::-ms-expand {
  border: 0;
  background-color: transparent;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
.cell-tag[readonly],
.tags-input input[readonly],
.tags-input button[readonly],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  background-color: #eeeeee;
  opacity: 1;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  cursor: not-allowed;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button {
  height: auto;
}
select.cell-tag,
select.tags-input input,
select.tags-input button {
  height: 30px;
  line-height: 30px;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button,
select[multiple].cell-tag,
select[multiple].tags-input input,
select[multiple].tags-input button {
  height: auto;
}
.cell-tag,
.tags-input button {
  padding: 0px 4px;
}
.cell-tag {
  background-color: #fff;
  white-space: nowrap;
}
.tags-input input[type=text]:focus {
  outline: none;
  box-shadow: none;
  border-color: #ccc;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
[dir="rtl"] #kernel_logo_widget {
  float: left !important;
  float: left;
}
.modal .modal-body .move-path {
  display: flex;
  flex-direction: row;
  justify-content: space;
  align-items: center;
}
.modal .modal-body .move-path .server-root {
  padding-right: 20px;
}
.modal .modal-body .move-path .path-input {
  flex: 1;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
[dir="rtl"] #menubar .navbar-toggle {
  float: right;
}
[dir="rtl"] #menubar .navbar-collapse {
  clear: right;
}
[dir="rtl"] #menubar .navbar-nav {
  float: right;
}
[dir="rtl"] #menubar .nav {
  padding-right: 0px;
}
[dir="rtl"] #menubar .navbar-nav > li {
  float: right;
}
[dir="rtl"] #menubar .navbar-right {
  float: left !important;
}
[dir="rtl"] ul.dropdown-menu {
  text-align: right;
  left: auto;
}
[dir="rtl"] ul#new-menu.dropdown-menu {
  right: auto;
  left: 0;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
[dir="rtl"] i.menu-icon.pull-right {
  float: left !important;
  float: left;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
[dir="rtl"] ul#help_menu li a {
  padding-left: 2.2em;
}
[dir="rtl"] ul#help_menu li a i {
  margin-right: 0;
  margin-left: -1.2em;
}
[dir="rtl"] ul#help_menu li a i.pull-right {
  float: left !important;
  float: left;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
[dir="rtl"] .dropdown-submenu > .dropdown-menu {
  right: 100%;
  margin-right: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.fa-pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.fa-pull-right {
  margin-left: .3em;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
[dir="rtl"] .dropdown-submenu > a:after {
  float: left;
  content: "\f0d9";
  margin-right: 0;
  margin-left: -10px;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
[dir="rtl"] #notification_area {
  float: left !important;
  float: left;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] .indicator_area {
  float: left !important;
  float: left;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
[dir="rtl"] #kernel_indicator {
  float: left !important;
  float: left;
  border-left: 0;
  border-right: 1px solid;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] #modal_indicator {
  float: left !important;
  float: left;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  height: 30px;
  margin-top: 4px;
  display: flex;
  justify-content: flex-start;
  align-items: baseline;
  width: 50%;
  flex: 1;
}
span.save_widget span.filename {
  height: 100%;
  line-height: 1em;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
[dir="rtl"] span.save_widget.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] span.save_widget span.filename {
  margin-left: 0;
  margin-right: 16px;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
  white-space: nowrap;
  padding: 0 5px;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
    padding: 0 0 0 5px;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
.toolbar-btn-label {
  margin-left: 6px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
[dir="rtl"] .btn-group > .btn,
.btn-group-vertical > .btn {
  float: right;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
[dir="rtl"] ul.typeahead-list i {
  margin-left: 0;
  margin-right: -10px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
ul.typeahead-list  > li > a.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .typeahead-list {
  text-align: right;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  min-width: 20px;
  color: transparent;
}
[dir="rtl"] .no-shortcut.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .command-shortcut.pull-right {
  float: left !important;
  float: left;
}
.command-shortcut:before {
  content: "(command mode)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
[dir="rtl"] .edit-shortcut.pull-right {
  float: left !important;
  float: left;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
[dir="ltr"] #find-and-replace .input-group-btn + .form-control {
  border-left: none;
}
[dir="rtl"] #find-and-replace .input-group-btn + .form-control {
  border-right: none;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">
    
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#8220;&#25968;&#25454;&#20998;&#26512;-&#8221;&#33267;&#8220;&#27169;&#22411;&#34701;&#21512;&#8221;&#20026;&#21442;&#32771;&#20195;&#30721;"><em>&#8220;&#25968;&#25454;&#20998;&#26512; &#8221;&#33267;&#8220;&#27169;&#22411;&#34701;&#21512;&#8221;&#20026;&#21442;&#32771;&#20195;&#30721;</em><a class="anchor-link" href="#&#8220;&#25968;&#25454;&#20998;&#26512;-&#8221;&#33267;&#8220;&#27169;&#22411;&#34701;&#21512;&#8221;&#20026;&#21442;&#32771;&#20195;&#30721;">&#182;</a></h1><p>参考出处：<a href="https://tianchi.aliyun.com/forum/postDetail?spm=5176.12586969.1002.21.3cf2170epYn0xP&amp;postId=188681">https://tianchi.aliyun.com/forum/postDetail?spm=5176.12586969.1002.21.3cf2170epYn0xP&amp;postId=188681</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>赛题：心电图心跳信号多分类预测</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-Google-Drive"><em>Load Google Drive</em><a class="anchor-link" href="#Load-Google-Drive">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="k">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mounted at /content/drive
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#38382;&#39064;&#20998;&#26512;&#65288;Task_1)">&#38382;&#39064;&#20998;&#26512;&#65288;Task_1)<a class="anchor-link" href="#&#38382;&#39064;&#20998;&#26512;&#65288;Task_1)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>典型的单变量时间序列分类问题</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#25968;&#25454;&#20998;&#26512;&#65288;Task_2)">&#25968;&#25454;&#20998;&#26512;&#65288;Task_2)<a class="anchor-link" href="#&#25968;&#25454;&#20998;&#26512;&#65288;Task_2)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#36890;&#29992;&#27969;&#31243;">&#36890;&#29992;&#27969;&#31243;<a class="anchor-link" href="#&#36890;&#29992;&#27969;&#31243;">&#182;</a></h2><ol>
<li>载入数据科学和可视化的包：<ul>
<li>pandas, numpy, scipy, matplotlib, seaborn</li>
</ul>
</li>
<li>加载数据：<ul>
<li>加载train和test数据集，简略观察数据（.head()和.shape）</li>
</ul>
</li>
<li>数据总览：<ul>
<li>通过.describe()熟悉数据相关的统计量， 通过.info()熟悉数据类型</li>
</ul>
</li>
<li>判断数据缺失和异常：<ul>
<li>按列查看nan值存在情况，异常值检测</li>
</ul>
</li>
<li>了解预测值的分布：<ul>
<li>总体分布，查看skewness和kurtosis，预测值的具体频数</li>
</ul>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>必要的配置</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install missingno
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: missingno in /usr/local/lib/python3.7/dist-packages (0.4.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from missingno) (1.19.5)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from missingno) (3.2.2)
Requirement already satisfied: seaborn in /usr/local/lib/python3.7/dist-packages (from missingno) (0.11.1)
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from missingno) (1.4.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;missingno) (2.4.7)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;missingno) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;missingno) (0.10.0)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;missingno) (2.8.1)
Requirement already satisfied: pandas&gt;=0.23 in /usr/local/lib/python3.7/dist-packages (from seaborn-&gt;missingno) (1.1.5)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from cycler&gt;=0.10-&gt;matplotlib-&gt;missingno) (1.15.0)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.23-&gt;seaborn-&gt;missingno) (2018.9)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-&#20195;&#30721;&#23454;&#29616;">2. &#20195;&#30721;&#23454;&#29616;<a class="anchor-link" href="#2.-&#20195;&#30721;&#23454;&#29616;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1-&#36733;&#20837;&#25968;&#25454;&#31185;&#23398;&#24211;&#21644;&#21487;&#35270;&#21270;&#24211;">1 &#36733;&#20837;&#25968;&#25454;&#31185;&#23398;&#24211;&#21644;&#21487;&#35270;&#21270;&#24211;<a class="anchor-link" href="#1-&#36733;&#20837;&#25968;&#25454;&#31185;&#23398;&#24211;&#21644;&#21487;&#35270;&#21270;&#24211;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 1 载入数据科学库和可视化库</span>
<span class="c1"># coding:utf-8</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>  <span class="c1"># 过滤并忽略警告语句</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">missingno</span> <span class="k">as</span> <span class="nn">msno</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2-&#36733;&#20837;train&#21644;test&#25968;&#25454;&#38598;">2 &#36733;&#20837;train&#21644;test&#25968;&#25454;&#38598;<a class="anchor-link" href="#2-&#36733;&#20837;train&#21644;test&#25968;&#25454;&#38598;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 2 载入train和test数据集</span>
<span class="c1">#----------------------- 本地加载 -----------------------</span>
<span class="n">Train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train.csv&#39;</span><span class="p">)</span>
<span class="n">Test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span>


<span class="c1">#----------------------- Web端加载 -----------------------</span>
<span class="c1"># 从tmp网盘加载文件进行查看数据（限本地jupyter notebook）</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="k">import</span> <span class="n">request</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># 基于tmp.link分享链接直接加载文件</span>
<span class="k">def</span> <span class="nf">get_data_from_tmp_web</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
  <span class="n">file_mark</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">:]</span>
  <span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://tmplinkapp-connect.vx-cdn.com/connect-tz6rhexhflovcrsiq7w5-&#39;</span>
  <span class="n">download_link</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">file_mark</span>

  <span class="n">s</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">download_link</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>  <span class="c1"># 1 读取数据串</span>

  <span class="n">dfile</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>      <span class="c1"># 2 将字符串转换为 StringIO对象，使其具有文件属性 </span>
  <span class="n">creader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">dfile</span><span class="p">)</span>  <span class="c1"># 3 将流 转换为可迭代的 reader（csv row）</span>
  <span class="n">dlists</span><span class="o">=</span><span class="p">[</span><span class="n">rw</span> <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">creader</span><span class="p">]</span>  <span class="c1"># 4 其他转换、操作</span>

  <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dlists</span><span class="p">)):</span>
    <span class="n">row_int</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">dlists</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="p">)]</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_int</span><span class="p">)</span>

  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;voltage_input&#39;</span><span class="p">,</span> <span class="s1">&#39;voltage_output&#39;</span><span class="p">,</span> <span class="s1">&#39;value_tachometer&#39;</span><span class="p">])</span>
  <span class="c1"># print(df.head())</span>

  <span class="k">return</span> <span class="n">df</span>

<span class="n">Train_data</span> <span class="o">=</span> <span class="n">get_data_from_tmp_web</span><span class="p">(</span><span class="s1">&#39;http://tmp.link/f/60b15fc318681&#39;</span><span class="p">)</span>
<span class="n">Test_data</span> <span class="o">=</span> <span class="n">get_data_from_tmp_web</span><span class="p">(</span><span class="s1">&#39;http://tmp.link/f/60b15fc193212&#39;</span><span class="p">)</span>


<span class="c1"># 观察首尾数据</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train首尾数据及shape：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Train_data</span><span class="o">.</span><span class="n">tail</span><span class="p">()),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="n">Train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test首尾数据及shape：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Test_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Test_data</span><span class="o">.</span><span class="n">tail</span><span class="p">()),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Test_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train首尾数据及shape：
           id                                  heartbeat_signals  label
0          0  0.9912297987616655,0.9435330436439665,0.764677...    0.0
1          1  0.9714822034884503,0.9289687459588268,0.572932...    0.0
2          2  1.0,0.9591487564065292,0.7013782792997189,0.23...    2.0
3          3  0.9757952826275774,0.9340884687738161,0.659636...    0.0
4          4  0.0,0.055816398940721094,0.26129357194994196,0...    2.0
99995  99995  1.0,0.677705342021188,0.22239242747868546,0.25...    0.0
99996  99996  0.9268571578157265,0.9063471198026871,0.636993...    2.0
99997  99997  0.9258351628306013,0.5873839035878395,0.633226...    3.0
99998  99998  1.0,0.9947621698382489,0.8297017704865509,0.45...    2.0
99999  99999  0.9259994004527861,0.916476635326053,0.4042900...    0.0 
 (100000, 3)
Test首尾数据及shape：
            id                                  heartbeat_signals
0      100000  0.9915713654170097,1.0,0.6318163407681274,0.13...
1      100001  0.6075533139615096,0.5417083883163654,0.340694...
2      100002  0.9752726292239277,0.6710965234906665,0.686758...
3      100003  0.9956348033996116,0.9170249621481004,0.521096...
4      100004  1.0,0.8879490481178918,0.745564725322326,0.531...
19995  119995  1.0,0.8330283177934747,0.6340472606311671,0.63...
19996  119996  1.0,0.8259705825857048,0.4521053488322387,0.08...
19997  119997  0.951744840752379,0.9162611283848351,0.6675251...
19998  119998  0.9276692903808186,0.6771898159607004,0.242906...
19999  119999  0.6653212231837624,0.527064114047737,0.5166625... 
 (20000, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3-&#24635;&#35272;&#25968;&#25454;">3 &#24635;&#35272;&#25968;&#25454;<a class="anchor-link" href="#3-&#24635;&#35272;&#25968;&#25454;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 3 总览数据（ data.describe() --&gt; 获取数据的统计量， data.info() --&gt; 获取数据类型</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;数据的统计量：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;数据类型信息：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;数据的统计量：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Test_data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;数据类型信息：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Test_data</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>数据的统计量：
                   id          label
count  100000.000000  100000.000000
mean    49999.500000       0.856960
std     28867.657797       1.217084
min         0.000000       0.000000
25%     24999.750000       0.000000
50%     49999.500000       0.000000
75%     74999.250000       2.000000
max     99999.000000       3.000000
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 3 columns):
 #   Column             Non-Null Count   Dtype  
---  ------             --------------   -----  
 0   id                 100000 non-null  int64  
 1   heartbeat_signals  100000 non-null  object 
 2   label              100000 non-null  float64
dtypes: float64(1), int64(1), object(1)
memory usage: 2.3+ MB
数据类型信息：
 None
数据的统计量：
                   id
count   20000.000000
mean   109999.500000
std      5773.647028
min    100000.000000
25%    104999.750000
50%    109999.500000
75%    114999.250000
max    119999.000000
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 20000 entries, 0 to 19999
Data columns (total 2 columns):
 #   Column             Non-Null Count  Dtype 
---  ------             --------------  ----- 
 0   id                 20000 non-null  int64 
 1   heartbeat_signals  20000 non-null  object
dtypes: int64(1), object(1)
memory usage: 312.6+ KB
数据类型信息：
 None
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4-&#21028;&#26029;&#25968;&#25454;&#32570;&#22833;&#21644;&#24322;&#24120;">4 &#21028;&#26029;&#25968;&#25454;&#32570;&#22833;&#21644;&#24322;&#24120;<a class="anchor-link" href="#4-&#21028;&#26029;&#25968;&#25454;&#32570;&#22833;&#21644;&#24322;&#24120;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 4 判断数据缺失和异常（data.isnull().sun() --&gt; 按列查看nan存在情况）</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;数据缺失与异常情况：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;数据缺失与异常情况：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Test_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>数据缺失与异常情况：
 id                   0
heartbeat_signals    0
label                0
dtype: int64
数据缺失与异常情况：
 id                   0
heartbeat_signals    0
dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5-&#20102;&#35299;&#39044;&#27979;&#20540;&#30340;&#20998;&#24067;">5 &#20102;&#35299;&#39044;&#27979;&#20540;&#30340;&#20998;&#24067;<a class="anchor-link" href="#5-&#20102;&#35299;&#39044;&#27979;&#20540;&#30340;&#20998;&#24067;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 5 了解预测值的分布</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Train_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1"># 1)总体分布概况（无界约翰逊分布等）</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Train_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Default&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Normal&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Log Normal&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">lognorm</span><span class="p">)</span>

<span class="c1"># 2) 查看skewness and kurtosis --&gt; 偏度和峰度</span>
<span class="c1"># 偏度系数等于0为正态，大于零为右偏（负偏），小于零为左偏（负偏）；</span>
<span class="c1"># 峰度系数等于3为正态，大于3为尖峰，小于3为平顶；</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skewness: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">y</span><span class="o">.</span><span class="n">skew</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtness: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">y</span><span class="o">.</span><span class="n">kurt</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;偏度：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">峰度：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">kurt</span><span class="p">())</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">kurt</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">axlabel</span><span class="o">=</span><span class="s1">&#39;Kurtness&#39;</span><span class="p">)</span>

<span class="c1"># 3) 查看预测值的具体频数</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.0    64327
3.0    17912
2.0    14199
1.0     3562
Name: label, dtype: int64
Skewness: 0.871005
Kurtness: -1.009573
偏度：
 id       0.000000
label    0.871005
dtype: float64 
峰度：
 id      -1.200000
label   -1.009573
dtype: float64
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXwAAAEWCAYAAABliCz2AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3dd3hc1Z3/8fdXo94tq9ly7xVjI8DUAIHQIQkEQgkkTxIIKZtk97cJm7akk2TDZklCNgRIsqHEoYQaYOkszcY27rbcsS3baraqZbU5vz9mRIyiMpLmzox8P6/n0aPRzJ17v76e+cydc889x5xziIjI0S8p3gWIiEhsKPBFRHxCgS8i4hMKfBERn1Dgi4j4hAJfRMQnFPgiPZjZTWZWZWbNZjZ6mOvaaWZnR6s2keFQ4MtRJxyyrWbWZGb1ZvaGmX3OzAZ8vZtZCnAb8CHnXLZzri6Kdd1iZvdGa30ig6XAl6PVxc65HGAicCvwdeDuCJ5XAqQD6z2sTSQuFPhyVHPONTjnHgeuBK43s3lmlmZm/2Fmu8JNN/9tZhlmNgOoCD+13sxeBDCz/zKz3WbWaGYrzOy07vWb2R/M7AdH/H2Gme3pWYeZnQd8A7gy3FS02st/t0hvFPjiC865ZcAe4DRCR/wzgGOBaUAZ8B3n3GZgbvgp+c65s8K33w4vWwDcDzxoZumD3P4zwI+AJeGmogXD/CeJDJoCX/xkL6HQvgH4qnPugHOuiVAQf7yvJznn7nXO1TnnOp1zPwfSgJkxqVgkipLjXYBIDJURes1nAivMrPt+AwJ9PcnM/h/waWAs4IBcoNDTSkU8oCN88QUzO55Q4D8KtAJznXP54Z8851x2H887DfgacAUwyjmXDzQQ+pAAaCH0AdKttJ8yNDStxJUCX45qZpZrZhcBfwbudc6tBn4H/KeZFYeXKTOzc/tYRQ7QCdQAyWb2HUJH+N1WAReYWYGZlQJf6aecKmBSJN1DRbygF54crZ4wsyZgN/BNQn3rPxV+7OvAVuAtM2sEnqfvNvlngWeAzcC7wOHwOrv9CVgN7AT+F1jST00Phn/XmdnKQf57RIbNNAGKiIg/6AhfRMQnFPgiIj6hwBcR8QkFvoiITyTUhVeFhYVu0qRJ8S5DRGTEWLFiRa1zriiSZRMq8CdNmsTy5cvjXYaIyIhhZu9GuqyadEREfEKBLyLiEwp8ERGfUOCLiPiEAl9ExCcU+CIiPqHAFxHxCQW+iIhPKPBFRHxCgS8i4hMKfBERn1Dgi4j4hAJfRMQnFPgiIj6hwBcR8QkFvoiITyjwRUR8QoEvIuITCTXF4Uh0/9Jdg1r+6hMneFSJiEj/dIQvIuITCnwREZ9Q4IuI+IQCX0TEJxT4IiI+ocAXEfEJBb6IiE8o8EVEfEKBLyLiE54HvpkFzOwdM3vS622JiEjfYnGE/2VgYwy2IyIi/fA08M1sHHAhcJeX2xERkYF5fYT/C+BrQLCvBczsBjNbbmbLa2pqPC5HRMS/PAt8M7sIqHbOrehvOefcnc65cudceVFRkVfliIj4npdH+KcAl5jZTuDPwFlmdq+H2xMRkX54FvjOuX9zzo1zzk0CPg686Jy71qvtiYhI/9QPX0TEJ2Iy45Vz7mXg5VhsS0REeqcjfBERn1Dgi4j4hAJfRMQnFPgiIj6hwBcR8QkFvoiITyjwRUR8QoEvIuITCnwREZ9Q4IuI+IQCX0TEJxT4IiI+ocAXEfEJBb6IiE8o8EVEfEKBLyLiEwp8ERGfUOCLiPiEAl9ExCcU+CIiPqHAFxHxCQW+iIhPKPBFRHxCgS8i4hMKfBERn1Dgi4j4hAJfRMQnFPgiIj6hwBcR8QkFvoiITyjwRUR8QoEvIuITCnwREZ9Q4IuI+IQCX0TEJxT4IiI+ocAXEfEJzwLfzNLNbJmZrTaz9Wb2Xa+2JSIiA0v2cN1twFnOuWYzSwFeM7OnnXNvebhNERHpg2eB75xzQHP4z5Twj/NqeyIi0j9P2/DNLGBmq4Bq4Dnn3FIvtyciIn3zNPCdc13OuWOBccAJZjav5zJmdoOZLTez5TU1NV6WIyLiazHppeOcqwdeAs7r5bE7nXPlzrnyoqKiWJQjIuJLXvbSKTKz/PDtDOAcYJNX2xMRkf552UtnDPBHMwsQ+mD5i3PuSQ+3JyIi/fCyl84aYKFX6xcRkcHRlbYiIj6hwBcR8QkFvoiITyjwRUR8QoEvIuITCnwREZ9Q4IuI+IQCX0TEJyIKfDN7xMwuNDN9QIiIjFCRBvgdwNXAFjO71cxmeliTiIh4IKLAd84975y7BlgE7ASeN7M3zOxT4dmsREQkwUXcRGNmo4FPAp8B3gH+i9AHwHOeVCYiIlEV0eBpZvZXYCbwJ+Bi59y+8ENLzGy5V8WJiEj0RDpa5u+cc3878g4zS3POtTnnyj2oS0REoizSJp0f9HLfm9EsREREvNXvEb6ZlQJlQIaZLQQs/FAukOlxbSIiEkUDNemcS+hE7TjgtiPubwK+4VFNIiLigX4D3zn3R0LTFF7mnHs4RjWJiIgHBmrSudY5dy8wycz+uefjzrnbenmaiIgkoIGadLLCv7O9LkRERLw1UJPOb8O/vxubckRExCuRDp72UzPLNbMUM3vBzGrM7FqvixMRkeiJtB/+h5xzjcBFhMbSmQb8q1dFiYhI9EUa+N1NPxcCDzrnGjyqR0REPBLp0ApPmtkmoBW4ycyKgMPelSUiItEW6fDINwMnA+XOuQ6gBbjUy8JERCS6Ij3CB5hFqD/+kc/5nyjXIyIiHol0eOQ/AVOBVUBX+G6HAl9EZMSI9Ai/HJjjnHNeFiMiIt6JtJfOOqDUy0JERMRbkR7hFwIbzGwZ0NZ9p3PuEk+qEhGRqIs08G/xsggREfFeRIHvnHvFzCYC051zz5tZJhDwtjQREYmmSMfS+SzwEPDb8F1lwKNeFSUiItEX6UnbLwCnAI0AzrktQLFXRYmISPRF2obf5pxrNwtNaRu++Mq3XTQ7u4J8Zckq1lY2kJxkXHn8BLLTBnMNm4hI7EV6hP+KmX2D0GTm5wAPAk94V1Ziu+PlbTy5Zh8zSnLYWXeIx1fvjXdJIiIDijTwbwZqgLXAjcDfgG/19wQzG29mL5nZBjNbb2ZfHl6piWH93gZuf2ELHz52LL+7rpyzZhWzrrKBdZUaQFREElukvXSCZvYo8KhzribCdXcC/+KcW2lmOcAKM3vOObdhqMUmgj+8vpP0lADfvWQeAKdPL2L17npe2VzDvLK8OFcnItK3fo/wLeQWM6sFKoCK8GxX3xloxc65fc65leHbTcBGQr17RqzDHV08s24/580rJS8zBYBAknHcxFFU1rdS29w2wBpEROJnoCadrxLqnXO8c67AOVcAnAicYmZfjXQjZjYJWAgsHWKdCeHlimqa2jq59Nix77v/mHH5AKzZo2YdEUlcAwX+J4CrnHM7uu9wzm0HrgWui2QDZpYNPAx8JTxNYs/HbzCz5Wa2vKYm0tai+Hj0nb0UZqdx8tTC992fl5HCpNGZrNlTH6fKREQGNlDgpzjnanveGW7HTxlo5WaWQijs73POPdLbMs65O51z5c658qKiokhqjovDHV28VFHNRceMIZBk//D4MePyqW5qo7pRE4GJSGIaKPDbh/gYFuq0fzew0Tl322ALSzSrdtfT1hnk1GmFvT4+oyQHgG21LbEsS0QkYgMF/gIza+zlpwmYP8BzTyHUJHSWma0K/1wQlarjYOn2A5jB8ZMLen18VGYKeRkp7FTgi0iC6rdbpnNuyAOkOedeA/6x7WOEemt7HXPG5JKX0XtLlpkxuTCLrdXNOOfovipZRCRRRHrhla+1dXaxctdBTpw8ut/lJo/Oormtk9rmflu7RETiQoEfgdW7G2jrDLJ4Su/NOd0mF2YBsEPNOiKSgBT4EVi2ow6AE/pov+82OjuVnLRkdtQ2x6IsEZFBUeBHYPWeBqYUZpGfmdrvcmbG+IJM9hxsjVFlIiKRU+BHYF1lA/PHRTZOzrhRGdS1tNPa3uVxVSIig6PAH0BNUxv7Gg4zP8KB0cbmZwCwt0FH+SKSWBT4A+ge9jjSwC8LB36lmnVEJMEo8AewZk8DZjA3wsDPSksmPyOFynoFvogkFgX+ANZW1jOlMGtQUxiWjcpgrwJfRBKMAn8Aaysb3hv+OFJl+TpxKyKJR4Hfj9rmNqoa25g7NndQz9OJWxFJRAr8flTsbwJgVungAr80Lx2AKg2VLCIJRIHfj+7An1GaPajn5aQlk5kaUOCLSEJR4PejYn8TBVmpFGWnDep5ZkZJbjr7GxT4IpI4FPj92FTVxMySnCENdVySm05VUxvOOQ8qExEZPAV+H4JBx5aqJmaW5gzp+SW5abR3Bqk/1BHlykREhkaB34c9B1s51N415MAvzdWJWxFJLAr8PlRUhU7YDv0IPxT4+xX4IpIgFPh9qNjfCPx9cvLBSk8JkJ+RosAXkYShwO/Dpv1NjBuVMaghFXoqyU2nurEtilWJiAydAr8Pm6uamDXE5pxuJbnp1DS10RVUTx0RiT8Ffi/aO4Nsr2kZcvt9t9K8NLqco7ZZR/kiEn8K/F5sq2mmM+iG3H7fTSduRSSRKPB7sblqaGPo9FSUnUaSqWumiCQGBX4vNu1vIiVgTC7MGtZ6kgNJFGanUaUhFkQkASjwe7F5fxNTCrNJTR7+7ukeYkFEJN4U+L3YtH/oQyr0VJKbzoGWdto6NRmKiMSXAr+HpsMdVNa3Ri3wS3NDI22qP76IxJsCv4fNVc0AzBxmD51uJRpTR0QShAK/h83DHEOnp1FZqaQETIEvInGnwO+hYn8TWakBysLz0g5XUvdkKAp8EYkzBX4PFfubmF6SQ1LS4Cc96UtJTjpVasMXkTgb+shgRyHnHBVVTXxoTklU11uSl86KXQdpbuuM6npFpH/3L901qOWvPnGCR5UkBh3hH6G2uZ0DLe3DHlKhp5JwTx2144tIPCnwjxDtE7bdNPuViCQCBf4RNu33JvCz05LJTA0o8EUkrhT4R9i8v4nRWakUZqdFdb3W3VNHY+qISBwp8I9QUdUU9fb7bt1j6jinyVBEJD48C3wzu8fMqs1snVfbiKZg0LG5Knpj6PRUkptGe2eQyvpWT9YvIjIQL4/w/wCc5+H6o6qyvpVD7V2eBX73iduK8HkCEZFY8yzwnXOvAge8Wn+0eXXCtlv3mDoVVQp8EYmPuLfhm9kNZrbczJbX1NTErY7uLpnTi7M9WX96SoD8jBQd4YtI3MQ98J1zdzrnyp1z5UVFRXGro2J/E2X5GeSkp3i2jZLcdAW+iMSNhlYIq9jfxCyPmnO6leSm8eb2Ojq6gqQE4v5ZKyOchg2QwVLqAO2dQbbVNDPD88BPp6PLsbO2xdPtiIj0xstumQ8AbwIzzWyPmX3aq20N1/baZjqDLmqTnvSl+8TtRjXriEgceNak45y7yqt1R9v6ykYA5o7N9XQ7xTlppASMDXsbuWTBWE+3JSLSk5p0gHV7G0hPSWJKkTc9dLolB5KYUZLD+r0Nnm5HRKQ3Cnxg/d5GZo/JJRDFSU/6MndsLuv3NmqIBRGJOd8HfjDo2Li30fPmnG7zyvI40NKuKQ9FJOZ8H/i7Dhyiqa2TuWPzYrK97g+WdeHzBiIiseL7wF+/NzYnbLvNHpOLGWrHF5GYU+DvbSA5yTwbFrmnzNRkphRm6QhfRGLO94G/trKBacXZpKcEYrbNeWV5rKvUEb6IxJavAz8YdKzaXc/CCaNiut0F4/LZ33hYM2CJSEz5OvC317bQdLiThePzY7rdhRNC21u1+2BMtysi/ubrwH9nVyhwuwM4VuaMzSU1kMQ7u+pjul0R8TdfB/6q3fXkpCUz1eMrbHtKSw4wZ2wu7+xW4ItI7Pg+8BeMzycpBlfY9rRwQj5r9tTT2RWM+bZFxJ98G/it7V1s2t/EsTFuv++2cMIoDncE35taUUTio6G1g6fX7uPWpzcy/5ZnOfc/X+We13ZwuKMr3qVFnW8Df9XuerqCLubt9926TxSv3KUTtyLxsqW6idtf2MLr22oZNyqTyxaNIyM1wPee3MBlv3mD3QcOxbvEqPJt4L+5vY4kg+MnF8Rl++NGZTAmL52l20fMPO8iR5V1lQ384fWd5GWk8JWzZ3Dt4onccslcHv3CKdx1XTm7DhziI3e8wa66oyf0fRv4b22vY15ZHrkezmHbHzPjpCmjeXN7HcGgRs4UiaV361r4y/LdjC/I5MYPTKEwO+19j589p4RHbjqZzmCQ63+/jAMt7XGqNLp8GfiHO7pYtauexVNGx7WOxVNHc6Clnc3VascXiZXmtk7uW7qLvIwUPrF4ImnJvV9lP70kh7uvL6eyvpWvLll1VByY+TLwV7x7kPauICfFOfBPnhra/pvb6uJah4xcXUFHZX0rK3cdZNO+RhpaO+JdUkJzzvHQit0c7ujimsUTyUrrf9K/4yYW8O0LZ/PK5hrueX1HjKr0jmdTHCayN7fVEUiyuLXfdxs3KpPxBRm8ua2OT50yOa61yMgSDDre2XWQ5zZWUX/o7yGfZDBnTC7nzRtDQVZqHCtMTMt3HmRzVTMXHzOG0vAc0wO5dvFEXt1Sy0+fqeDMWcUxv24nmnx5hP/a1lrml+WRPcCneyycNGU0b22vU398iVhLWyc33beCB1fsISs1mSvKx/GVs6fzudOncOq0QrZUN/PLF7ewVgP0vU9zWydPr9/H5MKsQTXnmhk//Mg80lOS+NZf143o2ep8F/jVTYdZvaeeD84qjncpAJw5s5jGw50sf1fdM2VgDYc6uPLON3luQxUXzB/DTWdM5djxoyjOSWfC6CzOmzeGfzprOiW56TywbBdLd6i5sNvf1u6jo9Nx6bFjMRvcxZbFOencfP5s3txex8MrKz2q0Hu+C/yXNlXjHHxwdkm8SwHgtBlFpAaSeH5DVbxLkQTX3NbJdb9fxub9zdx9/fGcOq2QpF6Ca1RWKp8+dTIzS3J4bNVelu9U19+t1c2s2l3P6TMKKc6JrCmnp48fP57yiaP44VMbRmyvHd8F/nMbqinLz2D2mNhMeDKQ7LRkTp42muc2Vo3or4rira6g40v3r2RdZQO/vmYRZw7wDTUlkMQ1iycwvTibR1dVsqXKvz3BOrqCPLaqkoKsVM6YOfRv9klJxo8+Op+mw5384KkNUawwdnwV+Ic7unhtaw0fnF086K90Xjp7dgnv1h1ia3VzvEuRBPXjv23kpYoavnvJXM6ZE9m30+SkJK46YQLFOencv2wX22v8+fp6dXMNdS3tXLpgLCmB4UXejJIcbvzAFB5ZWckb22qjVGHs+CrwX66o5nBHkLMTpDmnW3c9z6zbH+dKJBE9vnovd722g+tOmsi1iycO6rnpKQGuO2kigSTjxj+toKWt06MqE1NtUxsvb67hmHF5TI/SNKZfOms6Ewoy+dZf19HWObLG2/FV4D+0opLinLT3+r8nitK8dE6cXMDDK/eoWUfeZ2t1Ezc/vIbjJo7iWxfOGdI68jNT+fjxE9hW08zXHlrjm9eYc45HV1eSEjAunD8mautNTwnw/Q/PY3ttC795eVvU1hsLvgn8mqY2Xqqo5iOLykge5tc6L3ysfDw76w6pt468p6Wtk8/du5KMlAC/vnoRqclDf91OK87ma+fN4qm1+/jd/22PYpWJ64Flu9le08K5c0vJifIQKh+YUcTFC8Zyx0vbRlRTWeIln0ceW1VJV9DxsePGxbuUXl0wv5Ss1AB/eXt3vEuRBOCc4+ZH1rK9pplfXrWQ0ryh9Sw50o2nT+H8eaXc+vQm3tg68tqfB2PPwUP88KkNTCnK4oRJ3lxg+e2LZpOWksQ3R1DffF8EfjDouH/ZLo4dn8+04sTondNTZmoyFx0zlqfW7qPhkC6P97vfvrqdJ1bv5V8+NJOTpxVGZZ1mxs8+toApRdl88YF32FvfGpX1JhrnHP/2yFoccNnCcZ510Aj1zZ/Fm9vruHfpLk+2EW3xv9Q0Bp5Zv5/tNS386uqF8S6lX588ZRJLlu/mD2/s5MtnT493OVFz/yDfDFefOMGjSkaGlzZV85NnNnHhMWP4/BlTo7ru7LRkfvuJ47j0V69z070rWHLjSaSn9D542Ei15O3d/N+WWr7/4XkEPO6Nd/UJE3hm3X5+9NRGTp1WyOTCLE+3N1xH/RG+c45fvriVKUVZnD8veiduvDB7TC7nzCnhntd30HRYR/l+tLW6mX964B3mjMnlZ5cf48nR6dSibH5+xQJW72ng3x9bP2KaIyKxtbqZ7z+5gZOnjuaaE7w/cDAzfnb5AlKTk/ji/SsTfpasoz7wn1m3n437GrnpA1MJxGHu2sH60lnTaGjt4J7Xdsa7FImx2uY2Pvs/y0lLSeLO68rJTPXuC/i5c0v50lnTWLJ8N3eMsJ4mfWlu6+Rz964gPSXAz69YELO5qkvz0rntigWs39vIvz+2PibbHKqjOvAbD3dwyxPrmT0mlw8vLIt3ORE5Zlw+F84fw69f3jqizv7L8DS0dnDd3cvY19DKf197HGX5GZ5v86tnz+AjC8v42bMV3PvWu55vz0sdXUG+eP/K0EnuqxcyJs/7/XekD84u4Ytnhj5Af/tK4n6AHtVt+Lc+vYnqpjbu/ET5sK+wi6V/v3gOr26p4eZH1vLAZxePiG8mgxF0joMt7TS0dnC4I0jQOdKSk8jNSGF0tv+G9K1tbuOTv1/Gluom7rr+eMo96lXSU1KS8dPLj6GhtYNvPbqOzq4gnxyBw3R3BR3/+uBqXq6o4ccfnc/JU6Nzknuw/vmcGeyoa+HHT28iPzOFK49PvHNRR23g3790F/cv3cVnT5vMgvHeTVT+jb+u5UcfmR/VdRbnpvPti+bwtYfW8MOnNvKdi4d2wU2i6Ao6dta1sLW6md0HDlFZ30pbZ+/DQScZ3PvWu8wvy+cDM4s4bVoho47icd23VDVxw59WsK+hlTuvK+cDM4qGvK6hvBZTAkn85tpFfOn+d7jliQ3sPtjKv50/KyGvVenN4Y4uvvznd3h2fRX/eu5Mrhpmu/2km59i560XDum5SUnGbVcsoLG1g68/vJamw5185rQpw6on2o7KwH9qzT6+/dg6zphZxNfPmxXvcobkivLxbNrXxD2v76AgK4UvnDktocb/GUhLWyevbq7huQ1VPL1uP60dXQTMKM1LZ+GEfMbmZZCfmUpGaoBfv7SVG0+fwsFDHVQ1HiY5yXhhUxUPr9yDGSwcn8+H5pZy7tzShO8FESnnHH9ZvpvvPrGBzNQA933mRI6bGJ8JedKSA9xxzSJ+8NRG7n5tB2srG/j5xxYwviAzLvVEakdtC196YCXrKhu55eI5CfHtJC05wF3Xl/PVJav4wVMb2bivie9dOnfAmbViJTGqiJK2zi5+/dI2bn9hC8dNHMUvr1o4Yo5UevPNC2dT19LGf/zvZrbXtHDLpXPjNul6JPY1tPL8xmpe2FjFG9vqaO8MkpeRwqzSHGaPyWV6SXaf84dOHJ3FxPCIF1efOIGuoGPNnnpe2VzDCxurufXpTdz69CZmlGTzoTmh8J9XljuiPgS7rXj3ID95ZhPLdhzgxMkF3H7VQkoinH3JK8mBJG65ZC7zy/K45fH1fOg/X+Wzp0/hs6dNjvpVqsPV2t7FXf+3nTte3kZaShK/u6484gHlYiEtOcAvr1rE9OIt3P7iFpbuqOMbF8zm/HmlcX+9ehr4ZnYe8F9AALjLOXerF9tpbe/iyTV7uePlbeyobeGjC8v40Ufnj/j+xYEk4xdXHsuUwmx+8cJmXtlcw01nTOWyReMSopmjpqmNlbsOsnLXQV7bUsv6vY0ATBydybUnTuScOSUcP2kUf1m+Z9DrDiQZCyeMYuGEUXzl7BlU1rfyv+v38+z6/dzx8lZ+9dJWSnPTWTylgMVTRlM+qYDJhVkJe76jpqmNFzdV8dCKPby98yAFWan8+KPzubJ8fMx6k0TisuPGsXjqaH701EZuf2EL97y2g48sLOOiY8ZQPqkgbvvXOcfGfU08sWYvf162i4OHOjh/XinfvmgOY2NwgnuwAknGV8+ZwSnTCvnOY+v4/H0rmV6czTUnTuD8+WPi9gHvWeCbWQD4NXAOsAd428wed85FdSDp5rZOTv3Ji9Qf6mB6cTa//9TxnDmMMa8TjZnx5bOn88HZxXz/yQ384KmN3Pr0JhZNGMWxE/KZUJDJxNGZFOekk5kaICM1QGZqgPTkQMRBEgw62ruCdHQF6exydHQFae8K0tYZ5GBLOwfCP3Ut7VTWt7KjpoXttc1UNbYBkBpIYsH4PG4+fxZnzw7N+RntI5my/Aw+dcpkPnXKZA60tPP8xipeqajhta21PLpqLwDpKUlML85henE2Y/MzGJOfTklOOtnpyWSnhX/Sk0lLTiKQZCSZkZxkBJJs0PU65wi60O/2riAtbV0cau+kpa2LxsMd7K1vpfJgKzvrDrGusoGK8Hj0Uwqz+OYFs7n6xAkJ8zW/p7L8DH59zSI+t6eB37++gyXLd/Ont94lMzXAnDG5zCvLY2pxNsU5aRTnpJGfmUp6ShLpyQHSUwKkJSdF9NpzztEZdLR3hl577Z2h11zj4Q5qm9upaWpjR20z6yobWb+3gdrmdpIsNLrsZ0+fwvExOrk9HCdMLuDJL53K46v3cs/rO7jliQ3c8sQGJhRkMr8sj7lluUwsyGJMfjqLJozyvB4vX3EnAFudc9sBzOzPwKVAVAM/Oy2Zz58xlQXj8jlhckHcvzJ5ZV5ZHktuPImN+xp5bNVe3thWyx/f2NnnyU+A7l1h8N5+sffdb3QGgwQHcd1NXkYKU4qyOHVaEbNKc1g0MZ+5Y/Ni+m2qICuVK8rHc0X5eJxzbKtp4Z1dB6nY30RFVRNvba+jqqmNrkH8w8wgYPb3oHLgcDgHjlA4hX4PrtainDTmjs3lomPGcMbM4hHVDDV/XB63XXks3/vwPF6uqGb5zoOsq2xgydu7aY3wAiOz0GsudNuOuA2dQTfg/kxOMqaX5HDmzGKOmziKs+eUUJidNuR/UzwkB5L46KJxfHTROLZWN/H8xmrW7KlnTWU9T63dB0BhdirLv3WO597CsVMAAAY3SURBVLWYV1fZmdnlwHnOuc+E//4EcKJz7os9lrsBuCH850yg4oiHC4FEH+Up0WtM9PpANUaLahy+RK8P/rHGic65iLp3xf07pXPuTuDO3h4zs+XOufIYlzQoiV5jotcHqjFaVOPwJXp9MLwavezCUgmMP+LvceH7REQkDrwM/LeB6WY22cxSgY8Dj3u4PRER6YdnTTrOuU4z+yLwLKFumfc45wY7slCvTT0JJtFrTPT6QDVGi2ocvkSvD4ZRo2cnbUVEJLGM3MtQRURkUBT4IiI+kVCBb2YFZvacmW0J/+710jMz6zKzVeEfz08Em9l5ZlZhZlvN7OZeHk8zsyXhx5ea2SSvaxpCjZ80s5oj9ttnYlzfPWZWbWbr+njczOz2cP1rzGxRLOuLsMYzzKzhiH34nTjUON7MXjKzDWa23sy+3MsycduXEdYX1/1oZulmtszMVodr/G4vy8T1PR1hjYN/TzvnEuYH+Clwc/j2zcBP+liuOYY1BYBtwBQgFVgNzOmxzOeB/w7f/jiwJMb7LZIaPwn8Ko7/t6cDi4B1fTx+AfA0oQszFwNLE7DGM4An47UPwzWMARaFb+cAm3v5v47bvoywvrjux/B+yQ7fTgGWAot7LBPv93QkNQ76PZ1QR/iEhl74Y/j2H4EPx7GWbu8NEeGcawe6h4g40pF1PwR80GJ7/XwkNcaVc+5V4EA/i1wK/I8LeQvIN7OYTkIcQY1x55zb55xbGb7dBGwEek7nFrd9GWF9cRXeL93TyaWEf3r2XonrezrCGgct0QK/xDm3L3x7P9DXmKfpZrbczN4yM68/FMqA3Uf8vYd/fAG/t4xzrhNoAEZ7XFev2w/rrUaAy8Jf8R8ys/G9PB5Pkf4b4u2k8Nfsp81sbjwLCTczLCR09HekhNiX/dQHcd6PZhYws1VANfCcc67PfRin93QkNcIg39MxD3wze97M1vXy874jUhf6ztLXJ9pEF7q0+GrgF2Y21eu6jwJPAJOcc8cAz/H3oxeJ3EpCr70FwC+BR+NViJllAw8DX3HONcarjr4MUF/c96Nzrss5dyyhEQBOMLN5sa5hIBHUOOj3dMwD3zl3tnNuXi8/jwFV3V89w7+r+1hHZfj3duBlQkcRXolkiIj3ljGzZCAPqPOwpp4GrNE5V+ecawv/eRdwXIxqi1TCD8XhnGvs/prtnPsbkGJmMZ9A1cxSCIXpfc65R3pZJK77cqD6EmU/hrdfD7wEnNfjoXi/p9/TV41DeU8nWpPO48D14dvXA4/1XMDMRplZWvh2IXAKUR5yuYdIhog4su7LgRfD31BiZcAae7ThXkKobTWRPA5cF+5hshhoOKJ5LyGYWWl3O66ZnUDo/RPTEAhv/25go3Putj4Wi9u+jKS+eO9HMysys/zw7QxCc3Zs6rFYXN/TkdQ4pPd0LM88D/RDqI3sBWAL8DxQEL6/nNCMWQAnA2sJ9URZC3w6BnVdQKi3wTbgm+H7vgdcEr6dDjwIbAWWAVPisO8GqvHHwPrwfnsJmBXj+h4A9gEdhNqUPw18Dvhc+HEjNGHOtvD/a3kc9uFANX7xiH34FnByHGo8lVBT5xpgVfjngkTZlxHWF9f9CBwDvBOucR3wnfD9CfOejrDGQb+nNbSCiIhPJFqTjoiIeESBLyLiEwp8ERGfUOCLiPiEAl9ExCcU+OJbZtY8wOOTrI+RM/t5zh/M7PLhVSbiDQW+iIhPKPDF98ws28xeMLOVZra2x7hOyWZ2n5ltDA9QlRl+znFm9oqZrTCzZ2M9sqfIUCjwReAw8BHn3CLgTODnRwyFOxO4wzk3G2gEPh8eK+aXwOXOueOAe4AfxqFukUFJjncBIgnAgB+Z2elAkNDQuN1Dc+92zr0evn0v8E/AM8A84Lnw50KA0JAMIglNgS8C1wBFwHHOuQ4z20loLBX4xyG6HaEPiPXOuZNiV6LI8KlJRyQ09G11OOzPBCYe8dgEM+sO9quB14AKoKj7fjNLifdkKCKRUOCLwH1AuZmtBa7j/cPQVgBfMLONwCjgNy40jeTlwE/MbDWhESFPjnHNIoOm0TJFRHxCR/giIj6hwBcR8QkFvoiITyjwRUR8QoEvIuITCnwREZ9Q4IuI+MT/B6GNW+7xDJImAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAW4AAAEWCAYAAABG030jAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAU+ElEQVR4nO3deZCkdX3H8c9neu7dheWYAgMLq5YhMZQKTAGiRTxigmgwqVAlEq+UZMvywioti1SqtDRlEkzF8ozJFqImAoookaCgqBALE1YHWGSXhXAUyCU7LMfuzszuXN/80U8PPT3d08/M9tPdv+X9qnqqn+O33d95tp/P8/RzOiIEAEhHT6cLAACsDMENAIkhuAEgMQQ3ACSG4AaAxBDcAJAYghtYBds32b6g03Xg+YngRtey/aDtnbbXVI27wPZNHSwL6DiCG92uJOnCA3kDl/Fdx0GDLzO63T9J+qjt9bUTbJ9h+1e2n81ez6iadpPtT9v+haRJSS+yHbbfZ/te23ts/53tF9v+H9u7bV9puz/794fZvtb2uO2ns/5j2/ZXA8sguNHtxiTdJOmj1SNtHy7pB5K+IOkISZ+V9APbR1Q1e4ekTZLWSXooG/cnkk6RdLqkj0naLOntkjZIOlHS27J2PZK+Jul4ScdJmpL0pZb+ZcAqEdxIwcclfdD2SNW4N0m6NyL+IyJmI+IKSXdL+tOqNl+PiO3Z9Jls3GciYndEbJe0TdKPI+KBiHhW0nWSTpKkiNgVEd+NiMmI2CPp05L+sOC/E8iF4EbXi4htkq6VdFHV6N/Rc1vRFQ9JOqZq+OE6b/dEVf9UneG1kmR72Pa/2X7I9m5JP5e03nZpdX8F0DoEN1LxCUl/reeC+TGVd2NUO07So1XDB3Lry49IOkHSaRFxiKQzs/E+gPcEWoLgRhIi4j5J35b0oWzUDyX9ru3zbffafqukl6q8Zd4K61TeAn8m25/+iRa9L3DACG6k5FOS1kjlfdCS3qzylvEulQ80vjkinmzRZ31O0pCkJyXdIun6Fr0vcMDMgxQAIC1scQNAYghuAEgMwQ0AiSG4ASAxvUW86ZFHHhkbN24s4q0B4KB06623PhkRI81bFhTcGzdu1NjYWBFvDQAHJdu1VwI3xK4SAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkBiCGwASQ3ADQGIIbgBITCFXTqbo8i2/aTjt/NOOa2MlALA8trgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxTYPb9gm2t1Z1u21/uB3FAQCWanrJe0TcI+kVkmS7JOlRSVcXXBcAoIGV7ip5vaT7IyL304gBAK210uA+T9IVRRQCAMgnd3Db7pd0jqTvNJi+yfaY7bHx8fFW1QcAqLGSLe43SrotIp6oNzEiNkfEaESMjoyMtKY6AMASKwnut4ndJADQcbmC2/YaSW+Q9L1iywEANJPrCTgRMSHpiIJrAQDkwJWTAJAYghsAEkNwA0BiCG4ASAzBDQCJIbgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkBiCGwASQ3ADQGLyPix4ve2rbN9te4ftVxZdGACgvlwPC5b0eUnXR8S5tvslDRdYEwBgGU2D2/ahks6U9G5JiohpSdPFlgUAaCTPrpIXShqX9DXbt9u+xPaa2ka2N9kesz02Pj7e8kIBAGV5grtX0smSvhIRJ0makHRRbaOI2BwRoxExOjIy0uIyAQAVeYL7EUmPRMSWbPgqlYMcANABTYM7In4r6WHbJ2SjXi/prkKrAgA0lPeskg9Kuiw7o+QBSX9VXEkAgOXkCu6I2CpptOBaAAA5cOUkACSG4AaAxBDcAJAYghsAEkNwA0BiCG4ASAzBDQCJIbgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkJhcz5y0/aCkPZLmJM1GBM+fBIAOyfuUd0l6bUQ8WVglAIBc2FUCAInJG9wh6ce2b7W9qV4D25tsj9keGx8fb12FAIBF8gb3qyPiZElvlPR+22fWNoiIzRExGhGjIyMjLS0SAPCcXMEdEY9mrzslXS3p1CKLAgA01jS4ba+xva7SL+mPJW0rujAAQH15zio5StLVtivtL4+I6wutCgDQUNPgjogHJL28DbUAAHLgdEAASAzBDQCJIbgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkBiCGwASQ3ADQGIIbgBIDMENAInJHdy2S7Zvt31tkQUBAJa3ki3uCyXtKKoQAEA+uYLb9rGS3iTpkmLLAQA0k3eL+3OSPiZpvlED25tsj9keGx8fb0lxAIClmga37TdL2hkRty7XLiI2R8RoRIyOjIy0rEAAwGJ5trhfJekc2w9K+pak19n+ZqFVAQAaahrcEfE3EXFsRGyUdJ6kn0XE2wuvDABQF+dxA0BielfSOCJuknRTIZUAAHJhixsAEkNwA0BiCG4ASAzBDQCJIbgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkBiCGwASQ3ADQGIIbgBITNPgtj1o+5e277C93fYn21EYAKC+PA8L3i/pdRGx13afpJttXxcRtxRcGwCgjqbBHREhaW822Jd1UWRRAIDGcu3jtl2yvVXSTkk3RMSWOm022R6zPTY+Pt7qOgEAmVzBHRFzEfEKScdKOtX2iXXabI6I0YgYHRkZaXWdAIDMis4qiYhnJN0o6axiygEANJPnrJIR2+uz/iFJb5B0d9GFAQDqy3NWyQskfcN2SeWgvzIiri22LABAI3nOKvm1pJPaUAsAIAeunASAxBDcAJAYghsAEkNwA0BiCG4ASAzBDQCJIbgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkJg8DwveYPtG23fZ3m77wnYUBgCoL8/DgmclfSQibrO9TtKttm+IiLsKrg0AGrp8y28aTjv/tOPaWEn7Nd3ijojHI+K2rH+PpB2Sjim6MABAfSvax217o8pPfN9SRDEAgOZyB7fttZK+K+nDEbG7zvRNtsdsj42Pj7eyRgBAlVzBbbtP5dC+LCK+V69NRGyOiNGIGB0ZGWlljQCAKnnOKrGkr0raERGfLb4kAMBy8mxxv0rSOyS9zvbWrDu74LoAAA00PR0wIm6W5DbUAgDIgSsnASAxBDcAJIbgBoDEENwAkJg89yoBULDn8303sHJscQNAYghuAEgMwQ0AiSG4ASAxBDcAJIbgBoDEENwAkBiCGwASQ3ADQGIIbgBIDMENAIkhuAEgMQQ3ACSG4AaAxOR5yvultnfa3taOggAAy8uzxf11SWcVXAcAIKemwR0RP5f0VBtqAQDk0LJ93LY32R6zPTY+Pt6qtwUA1GhZcEfE5ogYjYjRkZGRVr0tAKAGZ5UAQGIIbgBITJ7TAa+Q9L+STrD9iO33FF8WAKCR3mYNIuJt7SgEAJAPu0oAIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEgMwQ0AiSG4ASAxBDcAJKbpJe9AI5dv+U3DaeefdlwbKwGeX9jiBoDEsMVdsNnZWU1NTS10+/bt0+TkpKanp7V//35NT08v6qrH7d+/XzMzMw3bzszMaG5uTvPz85qdndXc3Jzm5uYW+uuNq3Tz8/OSpIhY9rVa9bienh6FLPeU1NPTI/f0qKenRz09JbmnR5cO9atUKk+rvPb29qqnp0d9fX3q6+tTf3+/+vv7F/prxzVq19/fr8HBwYVuaGhoyevAwIB6e/l64+DENzszOzOt/VOTmt43lb1Oan/Wf+VDg5qcnFwI3npBXG/81NSUZmZmVl2TbQ0MDCyEVX9//6Lh3t5elUol9fX1aXBwUKVSaWFcvf5KeFaC1PaSz1vutdIfEZqbm9P2R59RzM9rfn4+e51beD3+8CHNz88vrCSqVzAzMzOamZnRnj17FlZMlXHVK6Xp6emFFcxqVOZLdajXBv7w8LCGh4e1Zs2ahq+14wYGBpbMO6Cdkg3uiND09LT27t2riYmJRa+Tk5NLxk1MTCzqasctF7BXV/WXSiUNDQ0t6iohsH79+oXh4eHhRf2VNtUB0iiQq4O5mwOiHfu45+bmloR55RdI9Qpy3759i7rqcbXTp6amtGvXroWVbOX7Mjs7m6umUqnUNNxrp1W6tWvXLhnu7+9vybzC80dXBfeVV16pPXv25A7bvAtaZQGqLDRr167Vhg0bNDw8vDDu/qdn1T84rIGhYfUPDmlgcEgDQ2vUPzikt57xkoXQZSFrr+oVZZEqGwKVEF/N62OPPbYwPDExoX379uX67L6+PvX2D6p/cFj9Q0MaGBzWwODQwvCDPz1qyQqg3kqgsrLo5pU9WqOrgvviiy/W5OSkbC8K1Up3+OGHLxpXb+ultn94eFg9Pc2PwS639Xj00Ue38s9EF6rslhoYGNBhhx3WkvecnZ1dFOTVGx/V4/fu3avbH/hteTfdvilNT01oanKvnn1qXNP7JvXA1v2amJjItduosuzUWyZqN2Bql516/47jBN2pq/5Xrr/++oVdDHnCFuhmvb29OuSQQ3TIIYc0bdtst1NEaGpqasmv0OV+kVZ3Tz/99KI2eY+9DAwMNAz3RiuBRr8MODbQOl0V3CMjI50uAehKlS3p4eHhliwn09PTq1oBTExMaNeuXXrooYcWfjlMTk7m+sxSqdQw3Cu7wwYGBuoeSK4+oFxp89QTT6m3f0B9WVfq7XverBhyBbftsyR9XlJJ0iUR8Y+FVgWgUJUD4K3YLTQ3N7dkl1DtCmBycrLhcasnnnhiycHlubm5lRdiL4T4V9etWXQSQL2D/9Xj+/r6FrXJM776NNXe3t5F44vWNLhtlyR9WdIbJD0i6Ve2r4mIu4ouDkD3K5VKWrdundatW9eS94sIzczMLDpzqF73s22PaHZmWjP792lmer9mpqc1O13u33Bo38IZRJUzkepdP1H5nAM99bTiiCOO0M0339yCubC8PFvcp0q6LyIekCTb35L0FkkEN4CWs72wNbvcyuDJQ1t7Ours7GyuC9+qT0mtvi5hZmZGfX19K/7c1XC9K+QWNbDPlXRWRFyQDb9D0mkR8YGadpskbcoGT5B0T9XkIyU92aqiC9LtNXZ7fRI1tgo1Hrhur09aWuPxEZHrAEbLDk5GxGZJm+tNsz0WEaOt+qwidHuN3V6fRI2tQo0Hrtvrkw6sxjzn3D0qaUPV8LHZOABAB+QJ7l9JeontF9rul3SepGuKLQsA0EjTXSURMWv7A5J+pPLpgJdGxPYVfk7dXShdpttr7Pb6JGpsFWo8cN1en3QANTY9OAkA6C5cVw4AiSG4ASAxhQS37cNt32D73uy17nW1tudsb826wg942j7L9j2277N9UZ3pA7a/nU3fYntj0TWtosZ32x6vmm8XtLm+S23vtL2twXTb/kJW/69tn9zO+nLW+Brbz1bNw493oMYNtm+0fZft7bYvrNOmY/MyZ30dnY+2B23/0vYdWY2frNOmo8t0zhpXvkxHRMs7SZ+RdFHWf5Gkixu021vE5zf4rJKk+yW9SFK/pDskvbSmzfsk/WvWf56kb7ervhXU+G5JX2pnXTWff6akkyVtazD9bEnXSbKk0yVt6cIaXyPp2k7Nw6yGF0g6OetfJ+n/6vxfd2xe5qyvo/Mxmy9rs/4+SVsknV7TptPLdJ4aV7xMF7Wr5C2SvpH1f0PSnxX0OSuxcOl+RExLqly6X6267qskvd7tvd1Ynho7KiJ+LumpZZq8RdK/R9ktktbbfkF7qivLUWPHRcTjEXFb1r9H0g5Jx9Q069i8zFlfR2XzZW822Jd1tWdbdHSZzlnjihUV3EdFxONZ/28lHdWg3aDtMdu32C463I+R9HDV8CNa+kVcaBMRs5KelXREwXXV/fxMvRol6S+yn85X2d5QZ3on5f0bOu2V2c/X62z/QScLyX6+n6Ty1li1rpiXy9QndXg+2i7Z3ippp6QbIqLhPOzQMp2nRmmFy/Sqg9v2T2xvq9Mt2kKM8m+BRmuY46N8yef5kj5n+8Wrred55L8kbYyIl0m6Qc9tTSC/21T+7r1c0hcl/WenCrG9VtJ3JX04InZ3qo5GmtTX8fkYEXMR8QqVr+g+1faJ7a6hmRw1rniZXnVwR8QfRcSJdbrvS3qi8pMue93Z4D0ezV4fkHSTymv1ouS5dH+hje1eSYdK2lVgTbWa1hgRuyJifzZ4iaRT2lRbXl1/i4SI2F35+RoRP5TUZ/vIdtdhu0/lULwsIr5Xp0lH52Wz+rplPmaf/4ykGyWdVTOp08v0gkY1rmaZLmpXyTWS3pX1v0vS92sb2D7M9kDWf6SkV6nYW8XmuXS/uu5zJf0s+8XQLk1rrNnHeY7K+x67yTWS3pmdEXG6pGerdpt1BdtHV/Zz2j5V5eWgrQtz9vlflbQjIj7boFnH5mWe+jo9H22P2F6f9Q+p/MyAu2uadXSZzlPjqpbpgo6kHiHpp5LulfQTSYdn40dVfoKOJJ0h6U6Vz5y4U9J7iqilpq6zVT46fr+kv83GfUrSOVn/oKTvSLpP0i8lvajomlZR4z9I2p7Ntxsl/V6b67tC0uOSZlTe5/oeSe+V9N547ij6l7P675Q02oF52KzGD1TNw1skndGBGl+t8i7EX0vamnVnd8u8zFlfR+ejpJdJuj2rcZukj2fju2aZzlnjipdpLnkHgMRw5SQAJIbgBoDEENwAkBiCGwASQ3ADQGIIbiTP9t4m0ze6wZ0Cl/k3X7d97oFVBhSD4AaAxBDcOGjYXmv7p7Zvs31nzX1zem1fZntHdiOf4ezfnGL7v23favtH7b6TIbAaBDcOJvsk/XlEnCzptZL+ueoWnidI+peI+H1JuyW9L7sXxxclnRsRp0i6VNKnO1A3sCJNn/IOJMSS/t72mZLmVb6lZ+WWwg9HxC+y/m9K+pCk6yWdKOmGLN9LKl8qD3Q1ghsHk7+UNCLplIiYsf2gyveqkJbeWjhUDvrtEfHK9pUIHDh2leBgcqiknVlov1bS8VXTjrNdCejzJd0s6R5JI5Xxtvs6/VAFIA+CGweTyySN2r5T0ju1+PaZ90h6v+0dkg6T9JUoPx7uXEkX275D5TvgndHmmoEV4+6AAJAYtrgBIDEENwAkhuAGgMQQ3ACQGIIbABJDcANAYghuAEjM/wNpIvR1k8H6hAAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZEAAAEWCAYAAACnlKo3AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAZAklEQVR4nO3de7SddX3n8fdHws0LghCRktRQTbXYWVw8xThOXV4QAl5Cpw6jtSbDosbxVqsdLVqnINpWx1UvdJRVFCVYR8QrkQFjRCwzbbmcCOUqJVpZJAUSDTehgsB3/ti/M2zDSbLz5Ox9cjjv11p77ef5/n7Ps38PBD557qkqJEnq4nHTPQBJ0sxliEiSOjNEJEmdGSKSpM4MEUlSZ4aIJKkzQ0QSAEnOSvLB6R6HZhZDRAKS/DjJkUP+je8l+XmS+X21I5P8eJi/Kw2TISKN1r3Af5+KFSXZZSrWI+0IQ0TaiiS7J/l4kn9tn48n2b2v/d1Jbm1tf5CkkjxzK6s8DXhtkmds4fd+o+2x3JnkuiSv6ms7K8npSS5Ici/w4rYH9a4kVye5N8mZSfZPcmGSe5J8J8k+fev4cpLbktyV5JIkz5mCf0yaxQwRaev+FFgEHAocAhwBvA8gyWLgncCRwDOBFw2wvvXAp4H3b96QZFfgm8C3gacCbwO+kORZfd1+D/hz4EnA/2213wVeBvw68ErgQuC9wFx6/43/Yd/yFwIL2/q/D3xhgDFLW2SISFv3OuDUqtpQVRvp/c//9a3teOBzVXVdVd0HnDLgOv8SeOUkewGLgCcCH6qqB6rqu8D5wGv7+pxXVX9fVQ9X1c9b7a+r6vaqWg/8H+CyqrqytX8dOGxi4ar6bFXdU1X3t/EekuTJA45behRDRNq6XwFu7pu/udUm2m7pa+uf3qIWRv8TOHWS37qlqh7e7PcO3MZv3N43/W+TzD8ReudQknwoyQ+T3A38uPXZb5BxS5MxRKSt+1fg6X3zv9pqALcC8/ra5jO4jwAvBp672W/NT9L/3+Wv0jsENmFHHrv9e8ASeoffngwsaPXswDo1yxki0iN2TbJH32cO8EXgfUnmJtkP+DPgb1v/c4ET2snwx7MdV11V1Z3AXwHv7itfBtwHvDvJrkleRO8cxzk7vGU9TwLuB34KPB74iylar2YxQ0R6xAX0Dv9MfE4BPgiMA1cD19A7Gf1BgKq6kN7VVhcDa4FL23ruH/D3PgE8NDFTVQ/QC41jgJ8AnwKWVtUPdmCb+p1N7/DYeuD6vvFKncWXUklTI8lvANcCu1fVg9M9HmkU3BORdkCS32n3kuwDfBj4pgGi2cQQkXbMG4ENwA/pHZp60/QORxotD2dJkjpzT0SS1Nmc6R7AqO233361YMGC6R6GJM0Ya9as+UlVzZ2sbdaFyIIFCxgfH5/uYUjSjJHk5i21eThLktSZISJJ6swQkSR1ZohIkjozRCRJnRkikqTODBFJUmeGiCSpM0NEktTZrLtjXTNQpvDtrT5wVJpS7olIkjozRCRJnRkikqTODBFJUmeGiCSpM0NEktSZISJJ6swQkSR1ZohIkjobaogk2TvJV5L8IMkNSZ6f5ClJVie5qX3v0/omyWlJ1ia5OsnhfetZ1vrflGRZX/25Sa5py5yWTOWtzZKkbRn2nsgngG9V1bOBQ4AbgJOAi6pqIXBRmwc4BljYPsuB0wGSPAU4GXgecARw8kTwtD5v6Ftu8ZC3R5LUZ2ghkuTJwAuBMwGq6oGquhNYAqxo3VYAx7XpJcDZ1XMpsHeSA4CjgdVVtamq7gBWA4tb215VdWlVFXB237okSSMwzD2Rg4CNwOeSXJnkM0meAOxfVbe2PrcB+7fpA4Fb+pZf12pbq6+bpC5JGpFhhsgc4HDg9Ko6DLiXRw5dAdD2IIb+WNUky5OMJxnfuHHjsH9OkmaNYYbIOmBdVV3W5r9CL1Rub4eiaN8bWvt6YH7f8vNabWv1eZPUH6Wqzqiqsaoamzt37g5tlCTpEUMLkaq6DbglybNa6aXA9cBKYOIKq2XAeW16JbC0XaW1CLirHfZaBRyVZJ92Qv0oYFVruzvJonZV1tK+dUmSRmDYL6V6G/CFJLsBPwJOoBdc5yY5EbgZOL71vQA4FlgL3Nf6UlWbknwAuKL1O7WqNrXpNwNnAXsCF7aPJGlEUrPsTW9jY2M1Pj4+3cPQ9vDNhtK0SrKmqsYma/OOdUlSZ4aIJKkzQ0SS1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM4MEUlSZ4aIJKkzQ0SS1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM4MEUlSZ4aIJKkzQ0SS1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM6GGiJJfpzkmiRXJRlvtackWZ3kpva9T6snyWlJ1ia5OsnhfetZ1vrflGRZX/25bf1r27IZ5vZIkn7ZKPZEXlxVh1bVWJs/CbioqhYCF7V5gGOAhe2zHDgdeqEDnAw8DzgCOHkieFqfN/Qtt3j4myNJmjAdh7OWACva9ArguL762dVzKbB3kgOAo4HVVbWpqu4AVgOLW9teVXVpVRVwdt+6JEkjMOwQKeDbSdYkWd5q+1fVrW36NmD/Nn0gcEvfsutabWv1dZPUHyXJ8iTjScY3bty4I9sjSeozZ8jr/w9VtT7JU4HVSX7Q31hVlaSGPAaq6gzgDICxsbGh/54kzRZD3ROpqvXtewPwdXrnNG5vh6Jo3xta9/XA/L7F57Xa1urzJqlLkkZkaCGS5AlJnjQxDRwFXAusBCausFoGnNemVwJL21Vai4C72mGvVcBRSfZpJ9SPAla1truTLGpXZS3tW5ckaQSGeThrf+Dr7arbOcD/qqpvJbkCODfJicDNwPGt/wXAscBa4D7gBICq2pTkA8AVrd+pVbWpTb8ZOAvYE7iwfSRJI5LehU2zx9jYWI2Pj0/3MLQ9pvL2n1n2512aCknW9N2m8Uu8Y12S1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM4MEUlSZ4aIJKkzQ0SS1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM4MEUlSZ4aIJKkzQ0SS1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM4MEUlSZ0MPkSS7JLkyyflt/qAklyVZm+RLSXZr9d3b/NrWvqBvHe9p9RuTHN1XX9xqa5OcNOxtkST9slHsibwduKFv/sPAx6rqmcAdwImtfiJwR6t/rPUjycHAa4DnAIuBT7Vg2gX4JHAMcDDw2tZXkjQiQw2RJPOAlwOfafMBXgJ8pXVZARzXppe0eVr7S1v/JcA5VXV/Vf0LsBY4on3WVtWPquoB4JzWV5I0IsPeE/k48G7g4Ta/L3BnVT3Y5tcBB7bpA4FbAFr7Xa3//69vtsyW6o+SZHmS8STjGzdu3NFtkiQ1QwuRJK8ANlTVmmH9xqCq6oyqGquqsblz5073cCTpMWPOENf9AuBVSY4F9gD2Aj4B7J1kTtvbmAesb/3XA/OBdUnmAE8GftpXn9C/zJbqkqQRGNqeSFW9p6rmVdUCeifGv1tVrwMuBl7dui0DzmvTK9s8rf27VVWt/pp29dZBwELgcuAKYGG72mu39hsrh7U9kqRHGyhEknwtycuTTEXo/AnwziRr6Z3zOLPVzwT2bfV3AicBVNV1wLnA9cC3gLdU1UNtT+atwCp6V3+d2/pKkkYkvb/sb6NTciRwArAI+DLwuaq6cchjG4qxsbEaHx+f7mFoeyRTt64B/rxL+mVJ1lTV2GRtA+1ZVNV32qGow4EfA99J8g9JTkiy69QNVZI0kwx8eCrJvsB/Af4AuJLeSfLDgdVDGZkkaac30NVZSb4OPAv4PPDKqrq1NX0piceGJGmWGvQS309X1QX9hSS7t7vIJz1OJkl67Bv0cNYHJ6n941QORJI082x1TyTJ0+g9SmTPJIcBE5fJ7AU8fshjkyTt5LZ1OOtoeifT5wEf7avfA7x3SGOSJM0QWw2RqloBrEjyu1X11RGNSZI0Q2zrcNbvV9XfAguSvHPz9qr66CSLSZJmiW0dznpC+37isAciSZp5tnU462/a9/tHMxxJ0kwy6AMY/0eSvZLsmuSiJBuT/P6wBydJ2rkNep/IUVV1N/AKes/OeibwrmENSpI0MwwaIhOHvV4OfLmq7hrSeCRJM8igjz05P8kPgH8D3pRkLvDz4Q1LkjQTDPoo+JOAfw+MVdUvgHuBJcMcmCRp57c971h/Nr37RfqXOXuKxyNJmkEGfRT854FnAFcBD7VyYYhI0qw26J7IGHBwDfIuXUnSrDHo1VnXAk8b5kAkSTPPoHsi+wHXJ7kcuH+iWFWvGsqoJEkzwqAhcsowByFJmpkGCpGq+rskTwcWVtV3kjwe2GW4Q5Mk7ewGfXbWG4CvAH/TSgcC39jGMnskuTzJPyW5Lsn7W/2gJJclWZvkS0l2a/Xd2/za1r6gb13vafUbkxzdV1/camuTnLQ9Gy5J2nGDnlh/C/AC4G6AqroJeOo2lrkfeElVHQIcCixOsgj4MPCxqnomcAdwYut/InBHq3+s9SPJwcBrgOcAi4FPJdklyS7AJ4FjgIOB17a+kqQRGTRE7q+qByZm2g2HW73ct3p+1mZ3bZ8CXkJvrwZgBXBcm17S5mntL02SVj+nqu6vqn8B1gJHtM/aqvpRG9s5eBe9JI3UoCHyd0neC+yZ5GXAl4FvbmuhtsdwFbABWA38ELizqh5sXdbROzRG+74FoLXfBezbX99smS3VJxvH8iTjScY3btw4wOZKkgYxaIicBGwErgHeCFwAvG9bC1XVQ1V1KDCP3p7DszuOc4dU1RlVNVZVY3Pnzp2OIUjSY9KgV2c9nOQbwDeqarv/Kl9Vdya5GHg+sHeSOW1vYx6wvnVbD8wH1rXDZU8GftpXn9C/zJbqkqQR2OqeSHpOSfIT4EbgxvZWwz/b1oqTzE2yd5veE3gZcANwMfDq1m0ZcF6bXtnmae3fbY9ZWQm8pl29dRCwELgcuAJY2K722o3eyfeVg264JGnHbWtP5B30rsr6rXZSmyS/Bpye5B1V9bGtLHsAsKJdRfU44NyqOj/J9cA5ST4IXAmc2fqfCXw+yVpgE71QoKquS3IucD3wIPCWqnqojeWtwCp696x8tqqu287tlyTtgGztmYpJrgReVlU/2aw+F/h2VR025PFNubGxsRofH5/uYWh7JFO3Lp8hKm23JGuqamyytm2dWN918wABaOdFdp2KwUmSZq5thcgDHdskSbPAts6JHJLk7knqAfYYwngkSTPIVkOkqnzIoiRpiwa92VCSpEcxRCRJnRkikqTODBFJUmeGiCSpM0NEktSZISJJ6swQkSR1ZohIkjozRCRJnRkikqTODBFJUmeGiCSpM0NEktSZISJJ6swQkSR1ZohIkjozRCRJnRkikqTOhhYiSeYnuTjJ9UmuS/L2Vn9KktVJbmrf+7R6kpyWZG2Sq5Mc3reuZa3/TUmW9dWfm+SatsxpSTKs7ZEkPdow90QeBP64qg4GFgFvSXIwcBJwUVUtBC5q8wDHAAvbZzlwOvRCBzgZeB5wBHDyRPC0Pm/oW27xELdHkrSZoYVIVd1aVd9v0/cANwAHAkuAFa3bCuC4Nr0EOLt6LgX2TnIAcDSwuqo2VdUdwGpgcWvbq6ouraoCzu5blyRpBEZyTiTJAuAw4DJg/6q6tTXdBuzfpg8EbulbbF2rba2+bpL6ZL+/PMl4kvGNGzfu0LZIkh4x9BBJ8kTgq8AfVdXd/W1tD6KGPYaqOqOqxqpqbO7cucP+OUmaNYYaIkl2pRcgX6iqr7Xy7e1QFO17Q6uvB+b3LT6v1bZWnzdJXZI0IsO8OivAmcANVfXRvqaVwMQVVsuA8/rqS9tVWouAu9phr1XAUUn2aSfUjwJWtba7kyxqv7W0b12SpBGYM8R1vwB4PXBNkqta7b3Ah4Bzk5wI3Awc39ouAI4F1gL3AScAVNWmJB8Armj9Tq2qTW36zcBZwJ7Ahe0jSRqR9E5LzB5jY2M1Pj4+3cPQ9pjK239m2Z93aSokWVNVY5O1ece6JKmzYR7OkqTZYar2lmfgnrJ7IpKkzgwRSVJnhogkqTNDRJLUmSEiSerMEJEkdWaISJI6M0QkSZ0ZIpKkzgwRSVJnhogkqTOfnSVpuHwK82OaeyKSpM4MEUlSZ4aIJKkzQ0SS1JkhIknqzBCRJHVmiEiSOjNEJEmdGSKSpM6GFiJJPptkQ5Jr+2pPSbI6yU3te59WT5LTkqxNcnWSw/uWWdb635RkWV/9uUmuacuclkzlbbGSpEEMc0/kLGDxZrWTgIuqaiFwUZsHOAZY2D7LgdOhFzrAycDzgCOAkyeCp/V5Q99ym/+WJGnIhhYiVXUJsGmz8hJgRZteARzXVz+7ei4F9k5yAHA0sLqqNlXVHcBqYHFr26uqLq2qAs7uW5ckaURGfU5k/6q6tU3fBuzfpg8Ebunrt67VtlZfN0ldkjRC03Zive1BjOSRnEmWJxlPMr5x48ZR/KQkzQqjDpHb26Eo2veGVl8PzO/rN6/VtlafN0l9UlV1RlWNVdXY3Llzd3gjJEk9ow6RlcDEFVbLgPP66kvbVVqLgLvaYa9VwFFJ9mkn1I8CVrW2u5MsaldlLe1blyRpRIb2UqokXwReBOyXZB29q6w+BJyb5ETgZuD41v0C4FhgLXAfcAJAVW1K8gHgitbv1KqaOFn/ZnpXgO0JXNg+kqQRSs2yN4WNjY3V+Pj4dA9D28M3481ss+Hf31Rt4066fUnWVNXYZG3esS5J6swQkSR1ZohIkjozRCRJnRkikqTODBFJUmeGiCSpM0NEktSZISJJ6swQkSR1ZohIkjozRCRJnRkikqTODBFJUmeGiCSps6G9lErSgGbD+zb0mOWeiCSpM0NEktSZISJJ6swQkSR1ZohIkjozRCRJnRkikqTODBFJUmczPkSSLE5yY5K1SU6a7vFI0mwyo0MkyS7AJ4FjgIOB1yY5eHpHJUmzR2oGPyYhyfOBU6rq6Db/HoCq+sstLTM2Nlbj4+MjGuHscPlf/Weec8eq4f3AVP4RncInjEwZt29wO+P2wdRt4xC3764Hd+NXPrSh07JJ1lTV2GRtM/3ZWQcCt/TNrwOet3mnJMuB5W32Z0luHMHYhmE/4CfTPYhp4HbPPrN124e73R/unFJP31LDTA+RgVTVGcAZ0z2OHZVkfEt/G3gsc7tnn9m67TNxu2f0ORFgPTC/b35eq0mSRmCmh8gVwMIkByXZDXgNsHKaxyRJs8aMPpxVVQ8meSuwCtgF+GxVXTfNwxqmGX9IriO3e/aZrds+47Z7Rl+dJUmaXjP9cJYkaRoZIpKkzgyRGSTJf0pyXZKHk8yoywC7mo2PtUny2SQbklw73WMZpSTzk1yc5Pr25/zt0z2mUUmyR5LLk/xT2/b3T/eYBmWIzCzXAv8RuGS6BzIKs/ixNmcBi6d7ENPgQeCPq+pgYBHwllny7xvgfuAlVXUIcCiwOMmiaR7TQAyRGaSqbqiqmXq3fRdHAGur6kdV9QBwDrBkmsc0dFV1CbBpuscxalV1a1V9v03fA9xA76kUj3nV87M2u2v7zIirngwR7cwme6zNrPifymyXZAFwGHDZ9I5kdJLskuQqYAOwuqpmxLbP6PtEHouSfAd42iRNf1pV5416PNKoJXki8FXgj6rq7ukez6hU1UPAoUn2Br6e5Deraqc/L2aI7GSq6sjpHsNOxMfazDJJdqUXIF+oqq9N93imQ1XdmeRieufFdvoQ8XCWdmY+1mYWSRLgTOCGqvrodI9nlJLMbXsgJNkTeBnwg+kd1WAMkRkkye8kWQc8H/jfSYb4Eo/pV1UPAhOPtbkBOPcx/lgbAJJ8EfhH4FlJ1iU5cbrHNCIvAF4PvCTJVe1z7HQPakQOAC5OcjW9vzytrqrzp3lMA/GxJ5KkztwTkSR1ZohIkjozRCRJnRkikqTODBFJUmeGiNRBkp/1TR+b5J+TPH07lj9uFj1cUI9hhoi0A5K8FDgNOKaqbh5wmTnAcfSeTCzNaIaI1FGSFwKfBl5RVT9MsqD/HSBJ/luSU9r095J8PMk48CfAq4CPtBvqntHaP9zeKfHPSX67LbdLko8kuSLJ1Une2OoHJLmkLX9tkt9ufc9q89ckeceo/5lo9vHZWVI3uwPfAF5UVYM+nmK3qhoDSLIQOL+qvtLmAeZU1RHtLu2TgSOBE4G7quq3kuwO/H2Sb9N7r8yqqvrz9t6Vx9N7D8WBVfWbbZ17T9XGSlvinojUzS+Af6D3P/lBfWkb7RMPHFwDLGjTRwFL2yPCLwP2BRbSezTGCW1P59+192/8CPi1JH+dZDEwa56Aq+ljiEjdPAwcDxyR5L2t9iC//N/UHpstc+821nl/+36IR44SBHhbVR3aPgdV1bfbi6teSO+pxmclWVpVdwCHAN8D/ivwmQ7bJW0XQ0TqqKruA14OvK49JPF24KlJ9m2Hnl6xlcXvAZ40wM+sAt7UHpFOkl9P8oR2JdjtVfVpemFxeJL9gMdV1VeB9wGHd944aUCeE5F2QFVtaoeOLgE2AqcCl9PbQ9jauZJzgE8n+UPg1Vvp9xl6h7a+3x6VvpHelV0vAt6V5BfAz4Cl9N76+LkkE385fE/HzZIG5lN8JUmdeThLktSZISJJ6swQkSR1ZohIkjozRCRJnRkikqTODBFJUmf/D7JdKZ2dADjQAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6-&#29992;pandas_profiling&#20570;EDA">6 &#29992;pandas_profiling&#20570;EDA<a class="anchor-link" href="#6-&#29992;pandas_profiling&#20570;EDA">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Colab上的pandas_profiling版本有些老旧，需要更新到最新版（具体更新的操作可能需要执行两次）</span>
<span class="o">!</span>pip install --upgrade pandas_profiling 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting pandas_profiling
  Downloading https://files.pythonhosted.org/packages/dd/12/e2870750c5320116efe7bebd4ae1709cd7e35e3bc23ac8039864b05b9497/pandas_profiling-2.11.0-py2.py3-none-any.whl (243kB)
     |████████████████████████████████| 245kB 8.3MB/s 
Requirement already satisfied, skipping upgrade: matplotlib&gt;=3.2.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (3.2.2)
Collecting requests&gt;=2.24.0
  Downloading https://files.pythonhosted.org/packages/29/c1/24814557f1d22c56d50280771a17307e6bf87b70727d975fd6b2ce6b014a/requests-2.25.1-py2.py3-none-any.whl (61kB)
     |████████████████████████████████| 61kB 6.3MB/s 
Requirement already satisfied, skipping upgrade: jinja2&gt;=2.11.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (2.11.3)
Collecting tangled-up-in-unicode&gt;=0.0.6
  Downloading https://files.pythonhosted.org/packages/ec/d1/58bfbe263494741a47140049b989ad42a8941854e8d34f1af90640c6c9f9/tangled_up_in_unicode-0.0.7-py3-none-any.whl (3.1MB)
     |████████████████████████████████| 3.2MB 13.3MB/s 
Collecting tqdm&gt;=4.48.2
  Downloading https://files.pythonhosted.org/packages/72/8a/34efae5cf9924328a8f34eeb2fdaae14c011462d9f0e3fcded48e1266d1c/tqdm-4.60.0-py2.py3-none-any.whl (75kB)
     |████████████████████████████████| 81kB 8.7MB/s 
Requirement already satisfied, skipping upgrade: seaborn&gt;=0.10.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (0.11.1)
Requirement already satisfied, skipping upgrade: attrs&gt;=19.3.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (20.3.0)
Requirement already satisfied, skipping upgrade: missingno&gt;=0.4.2 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (0.4.2)
Requirement already satisfied, skipping upgrade: joblib in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (1.0.1)
Collecting phik&gt;=0.10.0
  Downloading https://files.pythonhosted.org/packages/b7/ce/193e8ddf62d4be643b9b4b20e8e9c63b2f6a20f92778c0410c629f89bdaa/phik-0.11.2.tar.gz (1.1MB)
     |████████████████████████████████| 1.1MB 35.8MB/s 
Collecting htmlmin&gt;=0.1.12
  Downloading https://files.pythonhosted.org/packages/b3/e7/fcd59e12169de19f0131ff2812077f964c6b960e7c09804d30a7bf2ab461/htmlmin-0.1.12.tar.gz
Collecting confuse&gt;=1.0.0
  Downloading https://files.pythonhosted.org/packages/6d/55/b4726d81e5d6509fa3441f770f8a9524612627dc1b2a7d6209d1d20083fe/confuse-1.4.0-py2.py3-none-any.whl
Requirement already satisfied, skipping upgrade: scipy&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (1.4.1)
Requirement already satisfied, skipping upgrade: ipywidgets&gt;=7.5.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (7.6.3)
Collecting visions[type_image_path]==0.6.0
  Downloading https://files.pythonhosted.org/packages/98/30/b1e70bc55962239c4c3c9660e892be2d8247a882135a3035c10ff7f02cde/visions-0.6.0-py3-none-any.whl (75kB)
     |████████████████████████████████| 81kB 9.3MB/s 
Requirement already satisfied, skipping upgrade: pandas!=1.0.0,!=1.0.1,!=1.0.2,!=1.1.0,&gt;=0.25.3 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (1.1.5)
Requirement already satisfied, skipping upgrade: numpy&gt;=1.16.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling) (1.19.5)
Requirement already satisfied, skipping upgrade: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling) (2.8.1)
Requirement already satisfied, skipping upgrade: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling) (1.3.1)
Requirement already satisfied, skipping upgrade: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling) (0.10.0)
Requirement already satisfied, skipping upgrade: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling) (2.4.7)
Requirement already satisfied, skipping upgrade: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas_profiling) (2020.12.5)
Requirement already satisfied, skipping upgrade: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas_profiling) (2.10)
Requirement already satisfied, skipping upgrade: urllib3&lt;1.27,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas_profiling) (1.24.3)
Requirement already satisfied, skipping upgrade: chardet&lt;5,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas_profiling) (3.0.4)
Requirement already satisfied, skipping upgrade: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.7/dist-packages (from jinja2&gt;=2.11.1-&gt;pandas_profiling) (1.1.1)
Requirement already satisfied, skipping upgrade: pyyaml in /usr/local/lib/python3.7/dist-packages (from confuse&gt;=1.0.0-&gt;pandas_profiling) (3.13)
Requirement already satisfied, skipping upgrade: ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34; in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.5.0)
Requirement already satisfied, skipping upgrade: traitlets&gt;=4.3.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.0.5)
Requirement already satisfied, skipping upgrade: widgetsnbextension~=3.5.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (3.5.1)
Requirement already satisfied, skipping upgrade: nbformat&gt;=4.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.1.3)
Requirement already satisfied, skipping upgrade: ipykernel&gt;=4.5.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (4.10.1)
Requirement already satisfied, skipping upgrade: jupyterlab-widgets&gt;=1.0.0; python_version &gt;= &#34;3.6&#34; in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (1.0.0)
Requirement already satisfied, skipping upgrade: networkx&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.6.0-&gt;pandas_profiling) (2.5.1)
Requirement already satisfied, skipping upgrade: Pillow; extra == &#34;type_image_path&#34; in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.6.0-&gt;pandas_profiling) (7.1.2)
Collecting imagehash; extra == &#34;type_image_path&#34;
  Downloading https://files.pythonhosted.org/packages/8e/18/9dbb772b5ef73a3069c66bb5bf29b9fb4dd57af0d5790c781c3f559bcca6/ImageHash-4.2.0-py2.py3-none-any.whl (295kB)
     |████████████████████████████████| 296kB 48.0MB/s 
Requirement already satisfied, skipping upgrade: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas!=1.0.0,!=1.0.1,!=1.0.2,!=1.1.0,&gt;=0.25.3-&gt;pandas_profiling) (2018.9)
Requirement already satisfied, skipping upgrade: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib&gt;=3.2.0-&gt;pandas_profiling) (1.15.0)
Requirement already satisfied, skipping upgrade: decorator in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (4.4.2)
Requirement already satisfied, skipping upgrade: pygments in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (2.6.1)
Requirement already satisfied, skipping upgrade: pickleshare in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.7.5)
Requirement already satisfied, skipping upgrade: setuptools&gt;=18.5 in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (54.2.0)
Requirement already satisfied, skipping upgrade: pexpect; sys_platform != &#34;win32&#34; in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (4.8.0)
Requirement already satisfied, skipping upgrade: simplegeneric&gt;0.8 in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.8.1)
Requirement already satisfied, skipping upgrade: prompt-toolkit&lt;2.0.0,&gt;=1.0.4 in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (1.0.18)
Requirement already satisfied, skipping upgrade: ipython-genutils in /usr/local/lib/python3.7/dist-packages (from traitlets&gt;=4.3.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.2.0)
Requirement already satisfied, skipping upgrade: notebook&gt;=4.4.1 in /usr/local/lib/python3.7/dist-packages (from widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.3.1)
Requirement already satisfied, skipping upgrade: jupyter-core in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (4.7.1)
Requirement already satisfied, skipping upgrade: jsonschema!=2.5.0,&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (2.6.0)
Requirement already satisfied, skipping upgrade: tornado&gt;=4.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.1.1)
Requirement already satisfied, skipping upgrade: jupyter-client in /usr/local/lib/python3.7/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.3.5)
Requirement already satisfied, skipping upgrade: PyWavelets in /usr/local/lib/python3.7/dist-packages (from imagehash; extra == &#34;type_image_path&#34;-&gt;visions[type_image_path]==0.6.0-&gt;pandas_profiling) (1.1.1)
Requirement already satisfied, skipping upgrade: ptyprocess&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from pexpect; sys_platform != &#34;win32&#34;-&gt;ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.7.0)
Requirement already satisfied, skipping upgrade: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit&lt;2.0.0,&gt;=1.0.4-&gt;ipython&gt;=4.0.0; python_version &gt;= &#34;3.3&#34;-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.2.5)
Requirement already satisfied, skipping upgrade: Send2Trash in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (1.5.0)
Requirement already satisfied, skipping upgrade: terminado&gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.9.4)
Requirement already satisfied, skipping upgrade: nbconvert in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (5.6.1)
Requirement already satisfied, skipping upgrade: pyzmq&gt;=13 in /usr/local/lib/python3.7/dist-packages (from jupyter-client-&gt;ipykernel&gt;=4.5.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (22.0.3)
Requirement already satisfied, skipping upgrade: defusedxml in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.7.1)
Requirement already satisfied, skipping upgrade: testpath in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.4.4)
Requirement already satisfied, skipping upgrade: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (1.4.3)
Requirement already satisfied, skipping upgrade: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.8.4)
Requirement already satisfied, skipping upgrade: bleach in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (3.3.0)
Requirement already satisfied, skipping upgrade: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.3)
Requirement already satisfied, skipping upgrade: packaging in /usr/local/lib/python3.7/dist-packages (from bleach-&gt;nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (20.9)
Requirement already satisfied, skipping upgrade: webencodings in /usr/local/lib/python3.7/dist-packages (from bleach-&gt;nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.5.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling) (0.5.1)
Building wheels for collected packages: phik, htmlmin
  Building wheel for phik (setup.py) ... done
  Created wheel for phik: filename=phik-0.11.2-cp37-none-any.whl size=1107413 sha256=9b926be9d6a1b275d0a15272ba6980440cc06f63322c10a211381a5bb868e6a4
  Stored in directory: /root/.cache/pip/wheels/c0/a3/b0/f27b1cfe32ea131a3715169132ff6d85653789e80e966c3bf6
  Building wheel for htmlmin (setup.py) ... done
  Created wheel for htmlmin: filename=htmlmin-0.1.12-cp37-none-any.whl size=27085 sha256=8ec48c4ea96904174c45990f4f7b01767521ad59a88e3b985d5006d3ae2e7e51
  Stored in directory: /root/.cache/pip/wheels/43/07/ac/7c5a9d708d65247ac1f94066cf1db075540b85716c30255459
Successfully built phik htmlmin
<span class="ansi-red-fg">ERROR: google-colab 1.0.0 has requirement requests~=2.23.0, but you&#39;ll have requests 2.25.1 which is incompatible.</span>
<span class="ansi-red-fg">ERROR: datascience 0.10.6 has requirement folium==0.2.1, but you&#39;ll have folium 0.8.3 which is incompatible.</span>
<span class="ansi-red-fg">ERROR: phik 0.11.2 has requirement scipy&gt;=1.5.2, but you&#39;ll have scipy 1.4.1 which is incompatible.</span>
Installing collected packages: requests, tangled-up-in-unicode, tqdm, phik, htmlmin, confuse, imagehash, visions, pandas-profiling
  Found existing installation: requests 2.23.0
    Uninstalling requests-2.23.0:
      Successfully uninstalled requests-2.23.0
  Found existing installation: tqdm 4.41.1
    Uninstalling tqdm-4.41.1:
      Successfully uninstalled tqdm-4.41.1
  Found existing installation: pandas-profiling 1.4.1
    Uninstalling pandas-profiling-1.4.1:
      Successfully uninstalled pandas-profiling-1.4.1
Successfully installed confuse-1.4.0 htmlmin-0.1.12 imagehash-4.2.0 pandas-profiling-2.11.0 phik-0.11.2 requests-2.25.1 tangled-up-in-unicode-0.0.7 tqdm-4.60.0 visions-0.6.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 6 用pandas_profiling生成数据报告</span>
<span class="kn">import</span> <span class="nn">pandas_profiling</span>
<span class="n">pfr</span> <span class="o">=</span> <span class="n">pandas_profiling</span><span class="o">.</span><span class="n">ProfileReport</span><span class="p">(</span><span class="n">Train_data</span><span class="p">)</span>
<span class="n">pfr</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Exploratory_Data_Analysis/example.html&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="0a4e8ce5-f2c4-4458-bddf-1e0e9acbcb8b"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#0a4e8ce5-f2c4-4458-bddf-1e0e9acbcb8b');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2058430a95174fd698ed6719a0dc4dec", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="048d7269-eaec-474d-8aec-a5605a0f3c14"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#048d7269-eaec-474d-8aec-a5605a0f3c14');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c9767270ac404f6d99a4c1465b69f36e", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="2d92fff3-9945-432f-a91b-1b4ee62aed4f"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#2d92fff3-9945-432f-a91b-1b4ee62aed4f');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "fe4b0d91c3454918a9e45b7c69dc7c62", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="ef1c6a10-e3b1-4441-b4f0-e6f70894aa0b"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#ef1c6a10-e3b1-4441-b4f0-e6f70894aa0b');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f8a653e1d4c54ee8bf86bd07c866bb65", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#29305;&#24449;&#24037;&#31243;&#65288;Task_3&#65289;">&#29305;&#24449;&#24037;&#31243;&#65288;Task_3&#65289;<a class="anchor-link" href="#&#29305;&#24449;&#24037;&#31243;&#65288;Task_3&#65289;">&#182;</a></h1><p>特征预处理、涉及Tsfresh的使用</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#36890;&#29992;&#27969;&#31243;">&#36890;&#29992;&#27969;&#31243;<a class="anchor-link" href="#&#36890;&#29992;&#27969;&#31243;">&#182;</a></h2><ol>
<li>数据预处理<ul>
<li>时间序列数据格式处理</li>
<li>加入时间步特征time</li>
</ul>
</li>
<li>特征工程<ul>
<li>时间序列特征构造</li>
<li>特征筛选</li>
<li>实用tsfresh进行实践序列特征处理</li>
</ul>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#20195;&#30721;&#23454;&#29616;">&#20195;&#30721;&#23454;&#29616;<a class="anchor-link" href="#&#20195;&#30721;&#23454;&#29616;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#25968;&#25454;&#39044;&#22788;&#29702;">&#25968;&#25454;&#39044;&#22788;&#29702;<a class="anchor-link" href="#&#25968;&#25454;&#39044;&#22788;&#29702;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install <span class="nv">tsfresh</span><span class="o">==</span><span class="m">0</span>.17.0 # 高版本的tsfresh对scipy有要求，Colab升级scipy有困难，所以安装指定低版本的tsfresh
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting tsfresh==0.17.0
  Downloading https://files.pythonhosted.org/packages/35/b7/cbbfb02d50a93dbb710a730f168711eb343829e1cdea9f0d001d91aeefd6/tsfresh-0.17.0-py2.py3-none-any.whl (91kB)
     |████████████████████████████████| 92kB 3.7MB/s 
Requirement already satisfied: patsy&gt;=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (0.5.1)
Requirement already satisfied: tqdm&gt;=4.10.0 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (4.41.1)
Requirement already satisfied: statsmodels&gt;=0.9.0 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (0.10.2)
Requirement already satisfied: dask[dataframe]&gt;=2.9.0 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (2.12.0)
Requirement already satisfied: requests&gt;=2.9.1 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (2.23.0)
Requirement already satisfied: numpy&gt;=1.15.1 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (1.19.5)
Requirement already satisfied: pandas&gt;=0.25.0 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (1.1.5)
Requirement already satisfied: scipy&gt;=1.2.0 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (1.4.1)
Requirement already satisfied: scikit-learn&gt;=0.19.2 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (0.22.2.post1)
Requirement already satisfied: distributed&gt;=2.11.0 in /usr/local/lib/python3.7/dist-packages (from tsfresh==0.17.0) (2021.4.0)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from patsy&gt;=0.4.1-&gt;tsfresh==0.17.0) (1.15.0)
Requirement already satisfied: fsspec&gt;=0.6.0; extra == &#34;dataframe&#34; in /usr/local/lib/python3.7/dist-packages (from dask[dataframe]&gt;=2.9.0-&gt;tsfresh==0.17.0) (2021.4.0)
Requirement already satisfied: partd&gt;=0.3.10; extra == &#34;dataframe&#34; in /usr/local/lib/python3.7/dist-packages (from dask[dataframe]&gt;=2.9.0-&gt;tsfresh==0.17.0) (1.2.0)
Requirement already satisfied: toolz&gt;=0.7.3; extra == &#34;dataframe&#34; in /usr/local/lib/python3.7/dist-packages (from dask[dataframe]&gt;=2.9.0-&gt;tsfresh==0.17.0) (0.11.1)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.9.1-&gt;tsfresh==0.17.0) (1.24.3)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.9.1-&gt;tsfresh==0.17.0) (2.10)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.9.1-&gt;tsfresh==0.17.0) (3.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.9.1-&gt;tsfresh==0.17.0) (2020.12.5)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.25.0-&gt;tsfresh==0.17.0) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.25.0-&gt;tsfresh==0.17.0) (2.8.1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.19.2-&gt;tsfresh==0.17.0) (1.0.1)
Requirement already satisfied: psutil&gt;=5.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (5.4.8)
Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (54.2.0)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (3.13)
Requirement already satisfied: sortedcontainers!=2.0.0,!=2.0.1 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (2.3.0)
Requirement already satisfied: tblib&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (1.7.0)
Requirement already satisfied: tornado&gt;=5; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (5.1.1)
Requirement already satisfied: click&gt;=6.6 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (7.1.2)
Requirement already satisfied: zict&gt;=0.1.3 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (2.0.0)
Requirement already satisfied: msgpack&gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (1.0.2)
Requirement already satisfied: cloudpickle&gt;=1.5.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (1.6.0)
Requirement already satisfied: locket in /usr/local/lib/python3.7/dist-packages (from partd&gt;=0.3.10; extra == &#34;dataframe&#34;-&gt;dask[dataframe]&gt;=2.9.0-&gt;tsfresh==0.17.0) (0.2.1)
Requirement already satisfied: heapdict in /usr/local/lib/python3.7/dist-packages (from zict&gt;=0.1.3-&gt;distributed&gt;=2.11.0-&gt;tsfresh==0.17.0) (1.0.1)
Installing collected packages: tsfresh
  Found existing installation: tsfresh 0.18.0
    Uninstalling tsfresh-0.18.0:
      Successfully uninstalled tsfresh-0.18.0
Successfully installed tsfresh-0.17.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入必要的包</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tsfresh</span> <span class="k">as</span> <span class="nn">tsf</span>
<span class="kn">from</span> <span class="nn">tsfresh</span> <span class="k">import</span> <span class="n">extract_features</span><span class="p">,</span> <span class="n">select_features</span>
<span class="kn">from</span> <span class="nn">tsfresh.utilities.dataframe_functions</span> <span class="k">import</span> <span class="n">impute</span>

<span class="c1"># 读取数据</span>
<span class="n">Train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train.csv&#39;</span><span class="p">)</span>
<span class="n">Test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 数据预处理</span>

<span class="c1"># 对心电特征进行转列处理，同时为每个心电信号加入时间步特征time</span>
<span class="n">train_heartbeat_df</span> <span class="o">=</span> <span class="n">Train_data</span><span class="p">[</span><span class="s1">&#39;heartbeat_signals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="c1"># print(train_heartbeat_df.shape)</span>
<span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="n">train_heartbeat_df</span> <span class="o">=</span> <span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">train_heartbeat_df</span> <span class="o">=</span> <span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;level_0&#39;</span><span class="p">)</span>
<span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;level_1&#39;</span><span class="p">:</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="s1">&#39;heartbeat_signals&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train_heartbeat_df</span><span class="p">[</span><span class="s1">&#39;heartbeat_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_heartbeat_df</span><span class="p">[</span><span class="s1">&#39;heartbeat_signals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_heartbeat_df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>

<span class="c1"># 将处理后的心电特征加到训练数据中，同时将训练数据label列单独存储</span>
<span class="n">train_label</span> <span class="o">=</span> <span class="n">Train_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="c1"># 重构Train_data,并保存为train_data</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">Train_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;heartbeat_signals&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">train_heartbeat_df</span><span class="p">)</span>

<span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Train_data</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>

<span class="c1"># 查看数据的层级关系</span>
<span class="n">train_data</span><span class="p">[</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>time</th>
      <th>heartbeat_signals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.971482</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>0.928969</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>0.572933</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>0.178457</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4</td>
      <td>0.122962</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>200</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>201</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>202</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>203</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>204</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>205 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#29305;&#24449;&#24037;&#31243;">&#29305;&#24449;&#24037;&#31243;<a class="anchor-link" href="#&#29305;&#24449;&#24037;&#31243;">&#182;</a></h3><p>时序分析，大多需要建立时间序列上的特征</p>
<p>其他的则需要频域或者其他物理特征</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#### 特征抽取（By tsfresh)</span>
<span class="kn">from</span> <span class="nn">tsfresh</span> <span class="k">import</span> <span class="n">extract_features</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">因为extract_features提供了几个特征提取的方式default_fc_parameters：</span>
<span class="sd">①None、②ComprehensiveFCParameters()、③EfficientFCParameters()、④MinimalFCParameters()</span>
<span class="sd">③④虽然是基于②计算得来，但计算要快很多，因为④指定了特征计算类型，③去除了耗时的特征计算类型</span>
<span class="sd">采用④完成特征抽取，以获取小规模的特征集合 --&gt; result: time_cost:02:16, scale:[100000 rows x 9 columns]</span>
<span class="sd">采用③完成特征抽取，以获取规模不那么大的特征集合 --&gt; result: time_cost: over 12 minutes Storage_cost: over 8GB scale: No result.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">tsfresh.feature_extraction</span> <span class="k">import</span> <span class="n">ComprehensiveFCParameters</span><span class="p">,</span> <span class="n">EfficientFCParameters</span><span class="p">,</span> <span class="n">MinimalFCParameters</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">ComprehensiveFCParameters</span><span class="p">()</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">column_id</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> \
                  <span class="n">column_sort</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">default_fc_parameters</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_features</span><span class="p">)</span>

<span class="n">train_features</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Features_Extract/extract_features_ComprehensiveFCParameters.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 特征选择（By impute &amp; select_features)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">select_features 检查特征矩阵X的所有特征(列)的重要性，并返回一个可能简化的只包含相关特征的特征矩阵。</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">tsfresh.utilities.dataframe_functions</span> <span class="k">import</span> <span class="n">impute</span>
<span class="n">impute</span><span class="p">(</span><span class="n">train_features</span><span class="p">)</span>  <span class="c1"># 去除Nan值</span>

<span class="n">train_features_filtered</span> <span class="o">=</span> <span class="n">select_features</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_label</span><span class="p">)</span>  <span class="c1"># </span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_features_filtered</span><span class="p">)</span>

<span class="n">train_features_filtered</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Features_Extract/train_features_filtered_MinimalFCParameters.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>       heartbeat_signals__sum_values  ...  heartbeat_signals__minimum
0                          38.927945  ...                         0.0
1                          19.445634  ...                         0.0
2                          21.192974  ...                         0.0
3                          42.113066  ...                         0.0
4                          69.756786  ...                         0.0
...                              ...  ...                         ...
99995                      63.323449  ...                         0.0
99996                      69.657534  ...                         0.0
99997                      40.897057  ...                         0.0
99998                      42.333303  ...                         0.0
99999                      53.290117  ...                         0.0

[100000 rows x 8 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 学习和测试extract_features用法</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="mf">0.01</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="n">x_</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span><span class="o">*</span><span class="mi">16</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">8</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
<span class="nb">id</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">id</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

<span class="n">ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="c1"># print(ts)</span>

<span class="c1"># plt.plot(ts)</span>
<span class="kn">from</span> <span class="nn">tsfresh</span> <span class="k">import</span> <span class="n">extract_features</span>
<span class="n">df_sin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">df_sin</span><span class="p">[</span><span class="s1">&#39;time_xcc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_</span>
<span class="n">df_sin</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">id</span>
<span class="n">df_sin</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;value&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_sin</span> <span class="o">=</span> <span class="n">df_sin</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_sin</span> <span class="o">=</span> <span class="n">df_sin</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_sin</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">tsfresh.feature_extraction</span> <span class="k">import</span> <span class="n">ComprehensiveFCParameters</span><span class="p">,</span> <span class="n">EfficientFCParameters</span><span class="p">,</span> <span class="n">MinimalFCParameters</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">ComprehensiveFCParameters</span><span class="p">()</span>

<span class="n">train_features</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">df_sin</span><span class="p">,</span> <span class="n">column_id</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="n">chunksize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> \
                  <span class="n">column_sort</span><span class="o">=</span><span class="s1">&#39;time_xcc&#39;</span><span class="p">,</span><span class="n">default_fc_parameters</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_features</span><span class="p">)</span>

<span class="c1"># 去除全NaN列和全0值列（从1576列特征缩减到58列特征）</span>
<span class="n">df_</span> <span class="o">=</span> <span class="n">train_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">df_</span> <span class="o">=</span> <span class="n">df_</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">df_</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#27169;&#22411;&#35843;&#21442;&#65288;Task_4)">&#27169;&#22411;&#35843;&#21442;&#65288;Task_4)<a class="anchor-link" href="#&#27169;&#22411;&#35843;&#21442;&#65288;Task_4)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#36890;&#29992;&#27969;&#31243;">&#36890;&#29992;&#27969;&#31243;<a class="anchor-link" href="#&#36890;&#29992;&#27969;&#31243;">&#182;</a></h2><ol>
<li>常用模型介绍：<ul>
<li>逻辑回归模型</li>
<li>树模型</li>
<li>集成模型</li>
</ul>
</li>
<li>模型建立与性能评估：<ul>
<li>模型建立</li>
<li>评估方法</li>
<li>评估结果</li>
</ul>
</li>
<li>模型调参：<ul>
<li>贪心调参</li>
<li>网格调参</li>
<li>贝叶斯调参</li>
</ul>
</li>
</ol>
<p>1.和2.中的理论知识参见<a href="https://tianchi.aliyun.com/forum/postDetail?spm=5176.12282027.0.0.7c2d379cVEtyfx&amp;postId=195837"> <em>零基础入门数据挖掘-心跳信号分类预测_Task4 模型调参</em></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#20195;&#30721;&#23454;&#29616;">&#20195;&#30721;&#23454;&#29616;<a class="anchor-link" href="#&#20195;&#30721;&#23454;&#29616;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#23548;&#20837;&#20381;&#36182;&#21253;&#21644;&#21644;&#35774;&#32622;">&#23548;&#20837;&#20381;&#36182;&#21253;&#21644;&#21644;&#35774;&#32622;<a class="anchor-link" href="#&#23548;&#20837;&#20381;&#36182;&#21253;&#21644;&#21644;&#35774;&#32622;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">make_scorer</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="k">import</span> <span class="n">LGBMRegressor</span><span class="p">,</span> <span class="n">LGBMClassifier</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># import warnings</span>
<span class="c1"># warnings.filterwarnings(&#39;ignore&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#25968;&#25454;&#39044;&#22788;&#29702;">&#25968;&#25454;&#39044;&#22788;&#29702;<a class="anchor-link" href="#&#25968;&#25454;&#39044;&#22788;&#29702;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># reduce_mem_usage 函数通过调整数据类型，帮助我们减少数据在内存中占用的空间</span>
<span class="k">def</span> <span class="nf">reduce_mem_usage</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">start_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage of dataframe is </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        
        <span class="k">if</span> <span class="n">col_type</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">c_min</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">c_max</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_type</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="n">end_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage after optimization is: </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_mem</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decreased by </span><span class="si">{:.1f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_mem</span> <span class="o">-</span> <span class="n">end_mem</span><span class="p">)</span> <span class="o">/</span> <span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 读取数据</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train.csv&#39;</span><span class="p">)</span>
<span class="n">data_features_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Features_Extract/train_features_filtered_MinimalFCParameters.csv&#39;</span><span class="p">)</span>

<span class="c1"># 数据预处理(得到用于建模的原始特征DataFrame)</span>
<span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_list</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;s_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;原始特征数据:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># 数据预处理（得到用于建模的时序特征DataFrame）</span>
<span class="n">data_features_filtered</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">data_features_filtered</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">:</span><span class="s1">&#39;id&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(data_features_filtered.shape, &#39;\n&#39;, data_features_filtered)</span>
<span class="n">data_features_filtered</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">data_features_filtered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;时序特征数据：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">data_features_filtered</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>    id       s_0       s_1       s_2  ...  s_202  s_203  s_204  label
0  0.0  0.991230  0.943533  0.764677  ...    0.0    0.0    0.0    0.0
1  1.0  0.971482  0.928969  0.572933  ...    0.0    0.0    0.0    0.0
2  2.0  1.000000  0.959149  0.701378  ...    0.0    0.0    0.0    2.0
3  3.0  0.975795  0.934088  0.659637  ...    0.0    0.0    0.0    0.0
4  4.0  0.000000  0.055816  0.261294  ...    0.0    0.0    0.0    2.0

[5 rows x 207 columns]
Memory usage of dataframe is 157.93 MB
Memory usage after optimization is: 39.67 MB
Decreased by 74.9%
原始特征数据:
             id       s_0       s_1       s_2  ...  s_202  s_203  s_204  label
0          0.0  0.991211  0.943359  0.764648  ...    0.0    0.0    0.0    0.0
1          1.0  0.971680  0.929199  0.572754  ...    0.0    0.0    0.0    0.0
2          2.0  1.000000  0.958984  0.701172  ...    0.0    0.0    0.0    2.0
3          3.0  0.975586  0.934082  0.659668  ...    0.0    0.0    0.0    0.0
4          4.0  0.000000  0.055817  0.261230  ...    0.0    0.0    0.0    2.0
...        ...       ...       ...       ...  ...    ...    ...    ...    ...
99995  99995.0  1.000000  0.677734  0.222412  ...    0.0    0.0    0.0    0.0
99996  99996.0  0.926758  0.906250  0.637207  ...    0.0    0.0    0.0    2.0
99997  99997.0  0.925781  0.587402  0.633301  ...    0.0    0.0    0.0    3.0
99998  99998.0  1.000000  0.994629  0.829590  ...    0.0    0.0    0.0    2.0
99999  99999.0  0.925781  0.916504  0.404297  ...    0.0    0.0    0.0    0.0

[100000 rows x 207 columns]
Memory usage of dataframe is 7.06 MB
Memory usage after optimization is: 2.10 MB
Decreased by 70.3%
时序特征数据：
           id  heartbeat_signals__sum_values  ...  heartbeat_signals__minimum  label
0          0                      38.937500  ...                         0.0    0.0
1          1                      19.453125  ...                         0.0    0.0
2          2                      21.187500  ...                         0.0    2.0
3          3                      42.125000  ...                         0.0    0.0
4          4                      69.750000  ...                         0.0    2.0
...      ...                            ...  ...                         ...    ...
99995  99995                      63.312500  ...                         0.0    0.0
99996  99996                      69.687500  ...                         0.0    2.0
99997  99997                      40.906250  ...                         0.0    3.0
99998  99998                      42.343750  ...                         0.0    2.0
99999  99999                      53.281250  ...                         0.0    0.0

[100000 rows x 10 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#25968;&#25454;&#24314;&#27169;">&#25968;&#25454;&#24314;&#27169;<a class="anchor-link" href="#&#25968;&#25454;&#24314;&#27169;">&#182;</a></h3><p>注：以下建模的据集并未构造任何特征，直接使用原特征。本次主要任务还是模建模调参。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#39044;&#25805;&#20316;">&#39044;&#25805;&#20316;<a class="anchor-link" href="#&#39044;&#25805;&#20316;">&#182;</a></h4><p>分离数据，交叉验证设置，自定义评价指标等</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 建模前的预操作</span>
<span class="c1"># 导入特征工程的结果</span>
<span class="sd">&#39;&#39;&#39;如果使用时序特征数据执行以下代码&#39;&#39;&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data_features_filtered</span>

<span class="c1"># 分离数据集，方便进行交叉验证</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="c1"># 5折交叉验证</span>
<span class="n">folds</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">2021</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="c1"># 自定义评价指标（必要的话） </span>
<span class="k">def</span> <span class="nf">f1_score_vali</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">data_vali</span><span class="p">):</span>
  <span class="n">labels</span> <span class="o">=</span> <span class="n">data_vali</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">score_vali</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
  <span class="k">return</span> <span class="s1">&#39;f1_score&#39;</span><span class="p">,</span> <span class="n">score_vali</span><span class="p">,</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#24314;&#27169;&#12289;&#35757;&#32451;&#12289;&#39564;&#35777;">&#24314;&#27169;&#12289;&#35757;&#32451;&#12289;&#39564;&#35777;<a class="anchor-link" href="#&#24314;&#27169;&#12289;&#35757;&#32451;&#12289;&#39564;&#35777;">&#182;</a></h4><p>（By lightgbm）</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 使用lightgbm建模</span>
<span class="sd">&#39;&#39;&#39;对训练集数据进行划分，分成训练集和验证集，并进行相应操作&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="sd">&#39;&#39;&#39;数据集划分&#39;&#39;&#39;</span>
<span class="n">X_train_split</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train_split</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">train_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_train_split</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_train_split</span><span class="p">)</span>
<span class="n">valid_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_val</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;boosting&#39;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lambda_l2&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_class&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;nthread&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">### 使用lightgbm训练</span>
<span class="sd">&#39;&#39;&#39;使用训练集数据进行模型训练&#39;&#39;&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="p">,</span>
          <span class="n">train_set</span><span class="o">=</span><span class="n">train_matrix</span><span class="p">,</span>
          <span class="n">valid_sets</span><span class="o">=</span><span class="n">valid_matrix</span><span class="p">,</span>
          <span class="n">num_boost_round</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>   <span class="c1"># 决策树提升循环次数</span>
          <span class="n">verbose_eval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
          <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
          <span class="n">feval</span><span class="o">=</span><span class="n">f1_score_vali</span><span class="p">)</span>

<span class="c1">### 对验证集进行预测</span>
<span class="sd">&#39;&#39;&#39;对验证集进行预测&#39;&#39;&#39;</span>
<span class="n">val_pre_lgb</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">num_iteration</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">best_iteration</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">val_pre_lgb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;未调参前lightgbm单模型在验证集上的f1：</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training until validation scores don&#39;t improve for 200 rounds.
[50]	valid_0&#39;s multi_logloss: 0.453616	valid_0&#39;s f1_score: 0.692875
[100]	valid_0&#39;s multi_logloss: 0.439067	valid_0&#39;s f1_score: 0.700909
[150]	valid_0&#39;s multi_logloss: 0.43467	valid_0&#39;s f1_score: 0.707905
[200]	valid_0&#39;s multi_logloss: 0.43447	valid_0&#39;s f1_score: 0.70845
[250]	valid_0&#39;s multi_logloss: 0.435708	valid_0&#39;s f1_score: 0.711004
[300]	valid_0&#39;s multi_logloss: 0.43692	valid_0&#39;s f1_score: 0.713863
[350]	valid_0&#39;s multi_logloss: 0.440179	valid_0&#39;s f1_score: 0.716117
Early stopping, best iteration is:
[171]	valid_0&#39;s multi_logloss: 0.433977	valid_0&#39;s f1_score: 0.708907
未调参前lightgbm单模型在验证集上的f1：0.7089068518692501
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20132;&#21449;&#39564;&#35777;&#12289;&#24615;&#33021;&#35780;&#20272;">&#20132;&#21449;&#39564;&#35777;&#12289;&#24615;&#33021;&#35780;&#20272;<a class="anchor-link" href="#&#20132;&#21449;&#39564;&#35777;&#12289;&#24615;&#33021;&#35780;&#20272;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 使用5折交叉验证进行模型性能评估</span>
<span class="sd">&#39;&#39;&#39;使用lightgbm 5折交叉验证进行建模预测&#39;&#39;&#39;</span>
<span class="n">cv_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">valid_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************* </span><span class="si">{}</span><span class="s1"> *********************************&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
  <span class="n">X_train_split</span><span class="p">,</span> <span class="n">y_train_split</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> \
  <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">valid_index</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">valid_index</span><span class="p">]</span>

  <span class="n">train_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_train_split</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_train_split</span><span class="p">)</span>
  <span class="n">valid_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_val</span><span class="p">)</span>

  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
      <span class="s2">&quot;boosting&quot;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>  
      <span class="s2">&quot;lambda_l2&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
      <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;num_leaves&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
      <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s2">&quot;feature_fraction&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s2">&quot;objective&quot;</span><span class="p">:</span> <span class="s2">&quot;multiclass&quot;</span><span class="p">,</span>
      <span class="s2">&quot;num_class&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;nthread&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="p">,</span>
            <span class="n">train_set</span> <span class="o">=</span> <span class="n">train_matrix</span><span class="p">,</span>
            <span class="n">valid_sets</span> <span class="o">=</span> <span class="n">valid_matrix</span><span class="p">,</span>
            <span class="n">num_boost_round</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
            <span class="n">verbose_eval</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">early_stopping_rounds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">feval</span> <span class="o">=</span> <span class="n">f1_score_vali</span><span class="p">)</span>
  
  <span class="n">val_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">num_iteration</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">best_iteration</span><span class="p">)</span>
  <span class="n">val_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">val_pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">cv_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">val_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lgb_scotrainre_list:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lgb_score_mean:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lgb_score_std:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>

<span class="c1"># time_cost: 14分54秒</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>********************************* 1 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.435704	valid_0&#39;s f1_score: 0.698814
[200]	valid_0&#39;s multi_logloss: 0.429774	valid_0&#39;s f1_score: 0.707801
[300]	valid_0&#39;s multi_logloss: 0.433872	valid_0&#39;s f1_score: 0.712207
Early stopping, best iteration is:
[197]	valid_0&#39;s multi_logloss: 0.429767	valid_0&#39;s f1_score: 0.707954
[0.7079535642548609]
********************************* 2 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.451238	valid_0&#39;s f1_score: 0.702416
[200]	valid_0&#39;s multi_logloss: 0.447452	valid_0&#39;s f1_score: 0.714068
[300]	valid_0&#39;s multi_logloss: 0.452516	valid_0&#39;s f1_score: 0.717368
Early stopping, best iteration is:
[171]	valid_0&#39;s multi_logloss: 0.44672	valid_0&#39;s f1_score: 0.710834
[0.7079535642548609, 0.7108343665821681]
********************************* 3 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.428793	valid_0&#39;s f1_score: 0.713201
[200]	valid_0&#39;s multi_logloss: 0.421646	valid_0&#39;s f1_score: 0.720607
[300]	valid_0&#39;s multi_logloss: 0.422911	valid_0&#39;s f1_score: 0.724583
[400]	valid_0&#39;s multi_logloss: 0.426857	valid_0&#39;s f1_score: 0.728771
Early stopping, best iteration is:
[224]	valid_0&#39;s multi_logloss: 0.421637	valid_0&#39;s f1_score: 0.720771
[0.7079535642548609, 0.7108343665821681, 0.7207711024968233]
********************************* 4 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.441161	valid_0&#39;s f1_score: 0.707731
[200]	valid_0&#39;s multi_logloss: 0.435942	valid_0&#39;s f1_score: 0.711188
[300]	valid_0&#39;s multi_logloss: 0.438845	valid_0&#39;s f1_score: 0.715265
Early stopping, best iteration is:
[179]	valid_0&#39;s multi_logloss: 0.435719	valid_0&#39;s f1_score: 0.710751
[0.7079535642548609, 0.7108343665821681, 0.7207711024968233, 0.7107508072067897]
********************************* 5 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.43392	valid_0&#39;s f1_score: 0.705836
[200]	valid_0&#39;s multi_logloss: 0.428758	valid_0&#39;s f1_score: 0.71475
[300]	valid_0&#39;s multi_logloss: 0.430772	valid_0&#39;s f1_score: 0.716584
Early stopping, best iteration is:
[175]	valid_0&#39;s multi_logloss: 0.428581	valid_0&#39;s f1_score: 0.714072
[0.7079535642548609, 0.7108343665821681, 0.7207711024968233, 0.7107508072067897, 0.7140722970996672]
lgb_scotrainre_list:[0.7079535642548609, 0.7108343665821681, 0.7207711024968233, 0.7107508072067897, 0.7140722970996672]
lgb_score_mean:0.7128764275280619
lgb_score_std:0.004397245827975971
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#27169;&#22411;&#35843;&#21442;">&#27169;&#22411;&#35843;&#21442;<a class="anchor-link" href="#&#27169;&#22411;&#35843;&#21442;">&#182;</a></h3><p>常见调参参数及调参（for树模型）顺序为：</p>
<p>①：max_depth、num_leaves</p>
<p>②：min_data_in_leaf、min_child_weight</p>
<p>③：bagging_fraction、 feature_fraction、bagging_freq</p>
<p>④：reg_lambda、reg_alpha</p>
<p>⑤：min_split_gain</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#36138;&#24515;&#35843;&#21442;">&#36138;&#24515;&#35843;&#21442;<a class="anchor-link" href="#&#36138;&#24515;&#35843;&#21442;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>
<span class="c1"># 调整参数 objective</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Default: &#39;regression&#39; for LGBMRegressor, </span>
<span class="sd">binary&#39; or &#39;multiclass&#39; for LGBMClassifier, </span>
<span class="sd">&#39;lambdarank&#39; for LGBMRanker.</span>
<span class="sd">&#39;&#39;&#39;</span> 
<span class="n">best_obj</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">objective</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;multiclass&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objective</span><span class="p">:</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>
  <span class="sd">&#39;&#39;&#39;预测并计算roc的相关指标&#39;&#39;&#39;</span> 
  <span class="n">score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">best_obj</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>


<span class="c1"># 调整参数 num_leaves </span>
<span class="n">best_leaves</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">num_leaves</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">]</span>  <span class="c1">#一般默认num_leaves = 2^max_path，所以图快的话（依据前人经验），可以不再对max_depth调参</span>
<span class="k">for</span> <span class="n">leaves</span> <span class="ow">in</span> <span class="n">num_leaves</span><span class="p">:</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">best_obj</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_leaves</span><span class="o">=</span><span class="n">leaves</span><span class="p">)</span>
  <span class="c1"># 预测并计算roc的相关指标</span>
  <span class="n">score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">best_leaves</span><span class="p">[</span><span class="n">leaves</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
<span class="c1"># &gt;&gt;&gt; 耗时: 8分32秒 运行结果：{8: 0.95691, 16: 0.97081, 32: 0.9797600000000001}</span>

<span class="c1"># 调整参数 max_path  暂不调参</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">best_path = dict()</span>
<span class="sd">for depth in max_depth:</span>
<span class="sd">  model = LGBMRegressor(objective = min(best_obj,items(),key=lambda x:x[1])[0],\</span>
<span class="sd">              num_leaves = min(best_leaves.items(), key=lambda x:x[1])[0],\</span>
<span class="sd">              max_depth = degpth             </span>
<span class="sd">              )</span>
<span class="sd">  # 预测并计算roc的相关指标</span>
<span class="sd">  score = cross_val_score(model, X_train, y_train, cv=5, scoring=&#39;f1&#39;).mean()</span>
<span class="sd">  best_depth[depth] = score</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">按照调参参数和顺序依次调整优化，并通过可视化观察每个最优参数下模型的得分情况</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#32593;&#26684;&#25628;&#32034;">&#32593;&#26684;&#25628;&#32034;<a class="anchor-link" href="#&#32593;&#26684;&#25628;&#32034;">&#182;</a></h4><p>sklearn 提供GridSearchCV用于进行网格搜索</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 通过网格搜索确定最优参数</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">GridSearchCV</span>

<span class="k">def</span> <span class="nf">get_best_cv_params</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">581</span><span class="p">,</span>
            <span class="n">num_leaves</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
            <span class="n">max_depth</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">bagging_fraction</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="n">feature_fraction</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="n">bagging_freq</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">min_data_in_leaf</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
            <span class="n">min_child_weight</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
            <span class="n">min_split_gain</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">reg_lambda</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">reg_alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">param_grid</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">):</span>
  <span class="c1"># 设置5折交叉验证</span>
  <span class="n">cv_fold</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>

  <span class="n">model_lgb</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span> <span class="n">learning_rate</span><span class="p">,</span>
                  <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
                  <span class="n">num_leaves</span><span class="o">=</span><span class="n">num_leaves</span><span class="p">,</span>
                  <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
                  <span class="n">bagging_fraction</span><span class="o">=</span><span class="n">bagging_fraction</span><span class="p">,</span>
                  <span class="n">feature_fraction</span><span class="o">=</span><span class="n">feature_fraction</span><span class="p">,</span>
                  <span class="n">bagging_freq</span><span class="o">=</span><span class="n">bagging_freq</span><span class="p">,</span>
                  <span class="n">min_data_in_leaf</span><span class="o">=</span><span class="n">min_data_in_leaf</span><span class="p">,</span>
                  <span class="n">min_child_weight</span><span class="o">=</span><span class="n">min_child_weight</span><span class="p">,</span>
                  <span class="n">min_split_gain</span><span class="o">=</span><span class="n">min_split_gain</span><span class="p">,</span>
                  <span class="n">reg_lambda</span><span class="o">=</span><span class="n">reg_lambda</span><span class="p">,</span>
                  <span class="n">reg_alpha</span><span class="o">=</span><span class="n">reg_alpha</span><span class="p">,</span>
                  <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">2</span>
                  <span class="p">)</span>
  
  <span class="n">f1</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
  <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">model_lgb</span><span class="p">,</span>
                <span class="n">cv</span> <span class="o">=</span> <span class="n">cv_fold</span><span class="p">,</span>
                <span class="n">param_grid</span> <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                <span class="n">scoring</span> <span class="o">=</span> <span class="n">f1</span>
                <span class="p">)</span>
  
  <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;模型当前最优参数为：</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;模型当前最优得分为：</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&#39;&#39;&#39; </span>
<span class="sd">  基于函数get_best_cv_params()依次调整参数</span>
<span class="sd">  调参顺序：</span>
<span class="sd">  第一阶段：num_leaves和max_depth</span>
<span class="sd">  第二阶段：bagging_fraction、feature_fraction和bagging_freq</span>
<span class="sd">  第三阶段：reg_lambda、reg_alpha</span>
<span class="sd">  第四阶段：min_split_gain</span>
<span class="sd">  第五阶段：num_boost_round</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1">#——————第一阶段——————</span>
<span class="c1"># 1.1）预设n_estimators=581,调整num_leaves和max_depth</span>
<span class="n">lgb_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>  <span class="c1"># 粗调</span>
<span class="n">get_best_cv_params</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
          <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">581</span><span class="p">,</span>
          <span class="n">num_leaves</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>   <span class="c1"># 被调整的参数</span>
          <span class="n">max_depth</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1"># 被调整的参数</span>
          <span class="n">bagging_fraction</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
          <span class="n">feature_fraction</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
          <span class="n">bagging_freq</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">min_data_in_leaf</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
          <span class="n">min_child_weight</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
          <span class="n">min_split_gain</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">reg_lambda</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">reg_alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">param_grid</span> <span class="o">=</span> <span class="n">lgb_params</span>  <span class="c1"># 集成待调整参数</span>
          <span class="p">)</span>
<span class="c1"># &gt;&gt;&gt; 耗时比较长:15分46秒，执行结果：执行失败（可能是Colab的原因），基于得到粗调的最优配置参数：num_leaves=30，max_depth=7， 基于前人经验（num_leaves≈2^max_depth),只搜索num_leaves的最优值也可实现粗调的目的</span>
<span class="c1"># &gt;&gt;&gt; 调整范围：lgb_params = {&#39;num_leaves&#39;:[16,32], &#39;max_depth&#39;:[4,5]}，计算耗时</span>

<span class="c1"># 1.2)确定有限区间内的最优配置参数，进一步细调</span>
<span class="n">lgb_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span>  <span class="c1"># 粗调</span>
<span class="n">get_best_cv_params</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
          <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">581</span><span class="p">,</span>
          <span class="n">num_leaves</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>   <span class="c1"># 依然作为被调整的参数</span>
          <span class="n">max_depth</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>   <span class="c1"># 依然作为被调整的参数</span>
          <span class="n">bagging_fraction</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
          <span class="n">feature_fraction</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
          <span class="n">bagging_freq</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">min_data_in_leaf</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
          <span class="n">min_child_weight</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
          <span class="n">min_split_gain</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">reg_lambda</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">reg_alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">param_grid</span> <span class="o">=</span> <span class="n">lgb_params</span>  <span class="c1"># 集成待调整参数</span>
          <span class="p">)</span>
<span class="c1"># --&gt; 得到细调的最优配置参数：num_leaves=29，max_depth=7</span>
<span class="c1"># 确定后作为预设值输入函数get_best_cv_params，不再修改。</span>

<span class="c1">#——————第二阶段——————</span>
<span class="c1"># 2）预设min_data_in_leaf=45，min_child_weight=0.001，调整bagging_fraction、feature_fraction和bagging_freq</span>
<span class="n">lgb_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> 
        <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
        <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
        <span class="p">}</span>
<span class="n">get_best_cv_params</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
          <span class="n">n_estimators</span><span class="o">=</span><span class="mi">85</span><span class="p">,</span> 
          <span class="n">num_leaves</span><span class="o">=</span><span class="mi">29</span><span class="p">,</span> 
          <span class="n">max_depth</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> 
          <span class="n">min_data_in_leaf</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> 
          <span class="n">min_child_weight</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
          <span class="n">bagging_fraction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># 被调整参数</span>
          <span class="n">feature_fraction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># 被调整参数</span>
          <span class="n">bagging_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># 被调整参数</span>
          <span class="n">min_split_gain</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">reg_lambda</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">reg_alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">param_grid</span><span class="o">=</span><span class="n">lgb_params</span>
          <span class="p">)</span>

<span class="c1">#——————第三阶段——————</span>
<span class="c1"># 3）预设bagging_fraction=0.4、feature_fraction=0.6、bagging_freq=40,</span>
<span class="c1">#   调整reg_lambda, reg_alpha</span>
<span class="c1"># 代码参考第二阶段的结果进行调整</span>


<span class="c1">#——————第四阶段——————</span>
<span class="c1"># 3）基于已经确定的参数，调整min_split_gain</span>
<span class="c1"># 代码参考第三阶段的结果进行调整</span>


<span class="c1">#——————第五阶段——————</span>
<span class="c1"># 3）预设一个较小的learning_rate=0.005，调整num_boost_round</span>
<span class="n">cv_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">final_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;boosting_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
         <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
         <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
         <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
         <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
         <span class="s1">&#39;num_class&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
         <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span>
         <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span><span class="mf">0.001</span><span class="p">,</span>
         <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
         <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
         <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
         <span class="s1">&#39;min_split_gain&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
         <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
         <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
         <span class="s1">&#39;nthread&#39;</span><span class="p">:</span> <span class="mi">6</span>
         <span class="p">}</span>
<span class="n">cv_result</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">cv</span><span class="p">(</span><span class="n">train_set</span> <span class="o">=</span> <span class="n">lgb_train</span><span class="p">,</span>
           <span class="n">early_stopping_rounds</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
           <span class="n">num_boost_round</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
           <span class="n">nfold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
           <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">params</span><span class="o">=</span><span class="n">final_params</span><span class="p">,</span>
           <span class="n">feval</span><span class="o">=</span><span class="n">f1_score_vali</span><span class="p">,</span>
           <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
           <span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">实际调整过程中参照如下经验：</span>
<span class="sd">先设置较大的学习率，用cv函数确定出树的个数（？？），利用上面的代码调整优化，</span>
<span class="sd">再设置较小的学习率，用cv函数确定出树的个数（？？）。确定最终参数。</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#36125;&#21494;&#26031;&#35843;&#21442;">&#36125;&#21494;&#26031;&#35843;&#21442;<a class="anchor-link" href="#&#36125;&#21494;&#26031;&#35843;&#21442;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>依赖包：bayesian-optimization</p>
<p>贝叶斯调参的步骤如下：</p>
<ul>
<li>定义优化函数(rf_cv）</li>
<li>建立模型</li>
<li>定义待优化的参数</li>
<li>得到优化结果，并返回要优化的分数指标</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install bayesian-optimization
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple/
Collecting bayesian-optimization
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/bb/7a/fd8059a3881d3ab37ac8f72f56b73937a14e8bb14a9733e68cc8b17dbe3c/bayesian-optimization-1.2.0.tar.gz
Requirement already satisfied: numpy&gt;=1.9.0 in d:\users\xixi\anaconda3\lib\site-packages (from bayesian-optimization) (1.16.4)
Requirement already satisfied: scipy&gt;=0.14.0 in d:\users\xixi\anaconda3\lib\site-packages (from bayesian-optimization) (1.2.1)
Requirement already satisfied: scikit-learn&gt;=0.18.0 in d:\users\xixi\anaconda3\lib\site-packages (from bayesian-optimization) (0.21.2)
Requirement already satisfied: joblib&gt;=0.11 in d:\users\xixi\anaconda3\lib\site-packages (from scikit-learn&gt;=0.18.0-&gt;bayesian-optimization) (0.13.2)
Building wheels for collected packages: bayesian-optimization
  Building wheel for bayesian-optimization (setup.py): started
  Building wheel for bayesian-optimization (setup.py): finished with status &#39;done&#39;
  Stored in directory: C:\Users\XIXI\AppData\Local\pip\Cache\wheels\16\80\a5\4c2356930fa0a8f25745839daf357842d72265b68e75c8c20f
Successfully built bayesian-optimization
Installing collected packages: bayesian-optimization
Successfully installed bayesian-optimization-1.2.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 定义优化函数</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>
<span class="k">def</span> <span class="nf">rf_cv_lgb</span><span class="p">(</span><span class="n">num_leaves</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">bagging_fraction</span><span class="p">,</span> <span class="n">feature_fraction</span><span class="p">,</span> 
        <span class="n">bagging_freq</span><span class="p">,</span> <span class="n">min_data_in_leaf</span><span class="p">,</span> <span class="n">min_child_weight</span><span class="p">,</span> <span class="n">min_split_gain</span><span class="p">,</span>
        <span class="n">reg_lambda</span><span class="p">,</span> <span class="n">reg_alpha</span><span class="p">):</span>
  <span class="n">model_lgb</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">boosting_type</span><span class="o">=</span><span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
         <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
         <span class="n">num_class</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
         <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
         <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
         <span class="n">num_leaves</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num_leaves</span><span class="p">),</span>
         <span class="n">max_depth</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">max_depth</span><span class="p">),</span>
         <span class="n">bagging_fraction</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">bagging_fraction</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> 
         <span class="n">feature_fraction</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">feature_fraction</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
         <span class="n">bagging_freq</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">bagging_freq</span><span class="p">),</span> 
         <span class="n">min_data_in_leaf</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">min_data_in_leaf</span><span class="p">),</span>
         <span class="n">min_child_weight</span><span class="o">=</span><span class="n">min_child_weight</span><span class="p">,</span> 
         <span class="n">min_split_gain</span><span class="o">=</span><span class="n">min_split_gain</span><span class="p">,</span>
         <span class="n">reg_lambda</span><span class="o">=</span><span class="n">reg_lambda</span><span class="p">,</span> 
         <span class="n">reg_alpha</span><span class="o">=</span><span class="n">reg_alpha</span><span class="p">,</span>
         <span class="n">n_jobs</span><span class="o">=</span> <span class="mi">2</span> 
         <span class="p">)</span>
  
  <span class="n">f1</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
  <span class="n">val</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model_lgb</span><span class="p">,</span> <span class="n">X_train_split</span><span class="p">,</span> <span class="n">y_train_split</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  
  <span class="c1">#↑原代码有scoring=&#39;f1&#39;，执行出错，修改为scoring=f1，执行依然出错，遂去除，此处疑惑待解决</span>

  <span class="k">return</span> <span class="n">val</span>

<span class="c1"># 定义优化参数</span>
<span class="kn">from</span> <span class="nn">bayes_opt</span> <span class="k">import</span> <span class="n">BayesianOptimization</span>
<span class="n">bayes_lgb</span> <span class="o">=</span> <span class="n">BayesianOptimization</span><span class="p">(</span><span class="n">rf_cv_lgb</span><span class="p">,</span> 
                  <span class="p">{</span>
                  <span class="s1">&#39;num_leaves&#39;</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
                  <span class="s1">&#39;max_depth&#39;</span><span class="p">:(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                  <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                  <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                  <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span>
                  <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                  <span class="s1">&#39;min_split_gain&#39;</span><span class="p">:(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                  <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                  <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>    
                  <span class="p">}</span>                
                  <span class="p">)</span>

<span class="c1"># 开始优化</span>
<span class="n">bayes_lgb</span><span class="o">.</span><span class="n">maximize</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># &gt;&gt;&gt; 计算耗时较长，取n_iter=3，耗时13分26秒，执行失败，取n_iter=1,耗时1分24秒，执行失败</span>

<span class="c1"># 显示优化结果</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bayes_lgb</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 基于BayesianOptimization优化的结果建立新模型并降低学习率寻找最优模型迭代次数</span>
<span class="n">base_params_lgb</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;boosting_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_class&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
            <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">138</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
            <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span>
            <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span><span class="mf">6.5</span><span class="p">,</span>
            <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.64</span><span class="p">,</span>
            <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.93</span><span class="p">,</span>
            <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">49</span><span class="p">,</span>
            <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="mf">0.21</span><span class="p">,</span>
            <span class="s1">&#39;min_split_gain&#39;</span><span class="p">:</span> <span class="mf">0.288</span><span class="p">,</span>
            <span class="s1">&#39;nthread&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
          <span class="p">}</span>

<span class="n">cv_result_lgb</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">cv</span><span class="p">(</span><span class="n">train_set</span><span class="o">=</span><span class="n">train_matrix</span><span class="p">,</span>
             <span class="n">early_stopping_rounds</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
             <span class="n">num_boost_round</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">,</span>
             <span class="n">nfold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
             <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">params</span><span class="o">=</span><span class="n">base_params_lgb</span><span class="p">,</span>
             <span class="n">fval</span><span class="o">=</span><span class="n">f1_score_vali</span><span class="p">,</span>
             <span class="n">seed</span><span class="o">=</span><span class="mi">0</span>
             <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;迭代次数</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cv_result_lgb</span><span class="p">[</span><span class="s1">&#39;f1_score-mean&#39;</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;最终模型的f1为</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">cv_result_lgb</span><span class="p">[</span><span class="s1">&#39;f1_scor-mean&#39;</span><span class="p">])))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="hyperopt&#33258;&#21160;&#35843;&#21442;">hyperopt&#33258;&#21160;&#35843;&#21442;<a class="anchor-link" href="#hyperopt&#33258;&#21160;&#35843;&#21442;">&#182;</a></h4><p>利用集成了贪心、网格和贝叶斯调参方法的Hypropt工具实现自动调参，使用方法和原生cv函数差不多，还可以自动寻找最优调参方法</p>
<p>参考资料：<a href="https://blog.csdn.net/qq_34139222/article/details/60322995">Hyperopt入门</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 定义一个需要优化的目标函数，这里直接复用Bayes-opt中定义的被优化目标函数</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>
<span class="k">def</span> <span class="nf">hyperopt_cv_lgb</span><span class="p">(</span><span class="n">space_params</span><span class="p">):</span>
  <span class="n">num_leaves</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;num_leaves&quot;</span><span class="p">]</span>
  <span class="n">max_depth</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;max_depth&quot;</span><span class="p">]</span>
  <span class="n">bagging_fraction</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;bagging_fraction&quot;</span><span class="p">]</span>
  <span class="n">feature_fraction</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;feature_fraction&quot;</span><span class="p">]</span>
  <span class="n">bagging_freq</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;bagging_freq&quot;</span><span class="p">]</span>
  <span class="n">min_data_in_leaf</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;min_data_in_leaf&quot;</span><span class="p">]</span>
  <span class="n">min_child_weight</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;min_child_weight&quot;</span><span class="p">]</span>
  <span class="n">min_split_gain</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;min_split_gain&quot;</span><span class="p">]</span>
  <span class="n">reg_lambda</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;reg_lambda&quot;</span><span class="p">]</span>
  <span class="n">reg_alpha</span> <span class="o">=</span> <span class="n">space_params</span><span class="p">[</span><span class="s2">&quot;reg_alpha&quot;</span><span class="p">]</span>

  <span class="n">model_lgb</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span>
                  <span class="n">boosting_type</span><span class="o">=</span><span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
                  <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
                  <span class="n">num_class</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                  <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                  <span class="n">num_leaves</span><span class="o">=</span><span class="n">num_leaves</span><span class="p">,</span>
                  <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
                  <span class="n">bagging_fraction</span><span class="o">=</span><span class="n">bagging_fraction</span><span class="p">,</span> 
                  <span class="n">feature_fraction</span><span class="o">=</span><span class="n">feature_fraction</span><span class="p">,</span>
                  <span class="n">bagging_freq</span><span class="o">=</span><span class="n">bagging_freq</span><span class="p">,</span> 
                  <span class="n">min_data_in_leaf</span><span class="o">=</span><span class="n">min_data_in_leaf</span><span class="p">,</span>
                  <span class="n">min_child_weight</span><span class="o">=</span><span class="n">min_child_weight</span><span class="p">,</span> 
                  <span class="n">min_split_gain</span><span class="o">=</span><span class="n">min_split_gain</span><span class="p">,</span>
                  <span class="n">reg_lambda</span><span class="o">=</span><span class="n">reg_lambda</span><span class="p">,</span> 
                  <span class="n">reg_alpha</span><span class="o">=</span><span class="n">reg_alpha</span><span class="p">,</span>
                  <span class="n">n_jobs</span><span class="o">=</span> <span class="mi">2</span>  <span class="c1">#根据计算机配置定  </span>
                  <span class="p">)</span>
                    
  <span class="c1"># f1 = make_scorer(f1_score, average=&#39;micro&#39;)</span>
  <span class="n">val</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model_lgb</span><span class="p">,</span> <span class="n">X_train_split</span><span class="p">,</span> <span class="n">y_train_split</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  

  <span class="k">return</span> <span class="o">-</span><span class="n">val</span>  <span class="c1"># hyperopt默认将“目标函数”的输出值降到最小，因此这里设为负值</span>

<span class="c1"># 定义搜索空间，依然参考Bayes-opt的搜索空间，只不过表达形式需要调整</span>
<span class="kn">from</span> <span class="nn">hyperopt</span> <span class="k">import</span> <span class="n">hp</span>
<span class="n">space_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;num_leaves&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="mi">145</span><span class="p">)),</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_depth&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span>
    <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;bagging_fraction&#39;</span><span class="p">,[</span><span class="mf">0.01</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]),</span>
    <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;feature_fraction&#39;</span><span class="p">,[</span><span class="mf">0.01</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]),</span>
    <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;bagging_freq&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
    <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
    <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;min_child_weight&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
    <span class="s1">&#39;min_split_gain&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;min_split_gain&#39;</span><span class="p">,[</span><span class="n">i</span><span class="o">*</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]),</span>
    <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;reg_alpha&#39;</span><span class="p">,[</span><span class="n">i</span><span class="o">*</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]),</span>
    <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;reg_lambda&#39;</span><span class="p">,[</span><span class="n">i</span><span class="o">*</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span>
    <span class="p">}</span>  

<span class="c1"># 在搜索空间内进行搜索（algo用于定义搜索方法），去最小化目标函数（也可以最大化，见官方文档）</span>
<span class="kn">from</span> <span class="nn">hyperopt</span> <span class="k">import</span> <span class="n">fmin</span><span class="p">,</span><span class="n">tpe</span><span class="p">,</span><span class="n">hp</span><span class="p">,</span><span class="n">space_eval</span><span class="p">,</span><span class="n">rand</span><span class="p">,</span><span class="n">Trials</span><span class="p">,</span><span class="n">partial</span><span class="p">,</span><span class="n">STATUS_OK</span>
<span class="c1"># algo = partial(tpe.suggest,n_startup_jobs=1)</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">hyperopt_cv_lgb</span><span class="p">,</span> <span class="n">space_params</span><span class="p">,</span> <span class="n">algo</span><span class="o">=</span><span class="n">rand</span><span class="o">.</span><span class="n">suggest</span><span class="p">,</span> <span class="n">max_evals</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># 累计计算多少个模型，先算10个</span>

<span class="nb">print</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="c1"># -&gt; 执行结果：</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hyperopt_cv_lgb</span><span class="p">(</span><span class="n">best</span><span class="p">))</span>
<span class="c1"># -&gt; 执行结果：</span>

<span class="c1"># 取max_evals=1, 搜索空间为：{&#39;num_leaves&#39;:range(135, 145)，&#39;max_depth&#39;:range(7, 10)}，耗时为40分38秒，执行手动中止。</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#27169;&#22411;&#34701;&#21512;&#65288;Task_5&#65289;">&#27169;&#22411;&#34701;&#21512;&#65288;Task_5&#65289;<a class="anchor-link" href="#&#27169;&#22411;&#34701;&#21512;&#65288;Task_5&#65289;">&#182;</a></h1><p>基于融合策略提升方案指标</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#36890;&#29992;&#26041;&#27861;">&#36890;&#29992;&#26041;&#27861;<a class="anchor-link" href="#&#36890;&#29992;&#26041;&#27861;">&#182;</a></h2><ol>
<li><p>简单加权融合：</p>
<ul>
<li>回归（分类概率）：算数平均融合，集合平均融合</li>
<li>分类：投票</li>
<li>综合：排序融合，log融合</li>
</ul>
</li>
<li><p>Stacking/blending：</p>
<ul>
<li>构建多层模型，利用预测结果再拟合预测模型</li>
</ul>
</li>
<li><p>boosting/bagging（在xgboost, Adaboost, GBDT已经用到）：</p>
<ul>
<li>多树的提升方法</li>
</ul>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#20195;&#30721;&#23454;&#29616;">&#20195;&#30721;&#23454;&#29616;<a class="anchor-link" href="#&#20195;&#30721;&#23454;&#29616;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#22238;&#24402;/&#20998;&#31867;-&#34701;&#21512;&#8212;&#8212;&#32451;&#20064;">&#22238;&#24402;/&#20998;&#31867;-&#34701;&#21512;&#8212;&#8212;&#32451;&#20064;<a class="anchor-link" href="#&#22238;&#24402;/&#20998;&#31867;-&#34701;&#21512;&#8212;&#8212;&#32451;&#20064;">&#182;</a></h3><p>1） 加权平均融合（回归）</p>
<p>2） Stacking融合（回归）</p>
<p>3） 投票机制融合（分类）</p>
<p>4） Stacking融合（分类）</p>
<p>5） Blending融合（分类）</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1&#65289;&#21152;&#26435;&#24179;&#22343;&#34701;&#21512;&#65288;&#22238;&#24402;/&#20998;&#31867;&#27010;&#29575;&#65289;">1&#65289;&#21152;&#26435;&#24179;&#22343;&#34701;&#21512;&#65288;&#22238;&#24402;/&#20998;&#31867;&#27010;&#29575;&#65289;<a class="anchor-link" href="#1&#65289;&#21152;&#26435;&#24179;&#22343;&#34701;&#21512;&#65288;&#22238;&#24402;/&#20998;&#31867;&#27010;&#29575;&#65289;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 1）加权平均融合（回归/分类概率） --&gt; 能对预测结果进行数值计算，说明结果是连续性的，适用于回归问题的预测数值和分类问题的类别预测概率</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">metrics</span>

<span class="c1"># 生成一些样本，test_pre1表示第一个模型的预测值</span>
<span class="n">test_pre1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">6.2</span><span class="p">]</span>
<span class="n">test_pre2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">]</span>
<span class="n">test_pre3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]</span>

<span class="c1"># y_test_true 代表模型的真实值</span>
<span class="n">y_test_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="c1"># 定义结果的加权函数</span>
<span class="k">def</span> <span class="nf">Weighted_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">]):</span>
  <span class="n">Weighted_result</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre2</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre3</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">Weighted_result</span>

<span class="c1"># 计算各个模型的MAE（也可是MSE等吧）</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred1 MAE;&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">test_pre1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred1 MAE;&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pred1 MAE;&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">))</span>

<span class="c1"># 根据加权计算MAE</span>
<span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">Weighted_pre</span> <span class="o">=</span> <span class="n">Weighted_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span><span class="n">test_pre2</span><span class="p">,</span><span class="n">test_pre3</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weighted_pre MAE:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">Weighted_pre</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pred1 MAE; 0.1750000000000001
Pred1 MAE; 0.07499999999999993
Pred1 MAE; 0.10000000000000009
Weighted_pre MAE: 0.05750000000000027
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 定义结果的加权平均函数</span>
<span class="k">def</span> <span class="nf">Mean_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">):</span>
  <span class="n">Mean_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre2</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">Mean_result</span>

<span class="n">Mean_pre</span> <span class="o">=</span> <span class="n">Mean_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean_pre MAE:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">Mean_pre</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Mean_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">):</span>
  <span class="n">Mean_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre2</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">Mean_result</span>

<span class="n">Mean_pre</span> <span class="o">=</span> <span class="n">Mean_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean_pre MAE:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">Mean_pre</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean_pre MAE: 0.06666666666666693
Mean_pre MAE: 0.07500000000000007
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2&#65289;Stacking&#34701;&#21512;&#65288;&#22238;&#24402;/&#20998;&#31867;&#27010;&#29575;&#65289;">2&#65289;Stacking&#34701;&#21512;&#65288;&#22238;&#24402;/&#20998;&#31867;&#27010;&#29575;&#65289;<a class="anchor-link" href="#2&#65289;Stacking&#34701;&#21512;&#65288;&#22238;&#24402;/&#20998;&#31867;&#27010;&#29575;&#65289;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 2）Stacking融合（回归/分类概率）  --&gt; 能对预测结果进行数值计算，说明结果是连续性的，适用于回归问题的预测数值和分类问题的类别预测概率</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">linear_model</span>

<span class="k">def</span> <span class="nf">Stacking_method</span><span class="p">(</span><span class="n">train_reg1</span><span class="p">,</span> <span class="n">train_reg2</span><span class="p">,</span> <span class="n">train_reg3</span><span class="p">,</span> <span class="n">y_train_true</span><span class="p">,</span> 
          <span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">,</span> 
          <span class="n">model_L2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()):</span>
  <span class="n">model_L2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">train_reg1</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">train_reg2</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">train_reg3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_train_true</span><span class="p">)</span>
  <span class="n">Stacking_result</span> <span class="o">=</span> <span class="n">model_L2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre2</span><span class="p">),</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre3</span><span class="p">)],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">Stacking_result</span>

<span class="c1"># 定义一批数据进行Stacking融合（only for regression problem）</span>
<span class="n">train_reg1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">8.2</span><span class="p">,</span> <span class="mf">9.1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">]</span>
<span class="n">train_reg2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.9</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">4.9</span><span class="p">]</span>
<span class="n">train_reg3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">7.9</span><span class="p">,</span> <span class="mf">9.2</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="c1"># y_test_true 代表第模型的真实值</span>
<span class="n">y_train_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> 

<span class="n">test_pre1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">6.2</span><span class="p">]</span>
<span class="n">test_pre2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">]</span>
<span class="n">test_pre3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]</span>

<span class="c1"># y_test_true 代表第模型的真实值</span>
<span class="n">y_test_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> 

<span class="c1"># 开始融合</span>
<span class="n">model_L2</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">Stacking_pre</span> <span class="o">=</span> <span class="n">Stacking_method</span><span class="p">(</span><span class="n">train_reg1</span><span class="p">,</span> <span class="n">train_reg2</span><span class="p">,</span> <span class="n">train_reg3</span><span class="p">,</span> <span class="n">y_train_true</span><span class="p">,</span>
                <span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">,</span> <span class="n">model_L2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Stacking_pre MAE:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">Stacking_pre</span><span class="p">)</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Stacking_pre MAE: 0.042134831460675204
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3&#65289;&#25237;&#31080;&#26426;&#21046;&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;">3&#65289;&#25237;&#31080;&#26426;&#21046;&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;<a class="anchor-link" href="#3&#65289;&#25237;&#31080;&#26426;&#21046;&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;">&#182;</a></h4><p>少数服从多数，包括软投票和硬投票</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 加载依赖包</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">make_blobs</span><span class="p">,</span> <span class="n">make_moons</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 3）投票机制融合（分类）</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">硬投票：对多个模型直接进行投票，不区分模型结果的相对重要度，最终投票最多的类即为被预测的类</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># 以鸢尾花数据集为例实践</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">clf1</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
              <span class="n">n_estimators</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
              <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
              <span class="n">min_child_weight</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
              <span class="n">subsample</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
              <span class="n">colsample_bytree</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
              <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;binary:logistic&#39;</span><span class="p">)</span>

<span class="n">clf2</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> 
                <span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span> 
                <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

<span class="n">clf3</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># 硬投票</span>
<span class="n">eclf</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;lgb&#39;</span><span class="p">,</span><span class="n">clf1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span><span class="n">clf2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;svc&#39;</span><span class="p">,</span><span class="n">clf3</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s1">&#39;hard&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">clf1</span><span class="p">,</span><span class="n">clf2</span><span class="p">,</span><span class="n">clf3</span><span class="p">,</span><span class="n">eclf</span><span class="p">],[</span><span class="s1">&#39;LGB&#39;</span><span class="p">,</span><span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span> <span class="s1">&#39;SVM&#39;</span><span class="p">,</span> <span class="s1">&#39;Ensemble&#39;</span><span class="p">]):</span>
  <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s2"> (+/- </span><span class="si">%0.2f</span><span class="s2">) [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy: 0.95 (+/- 0.03) [LGB]
Accuracy: 0.33 (+/- 0.00) [Random Forest]
Accuracy: 0.92 (+/- 0.03) [SVM]
Accuracy: 0.92 (+/- 0.03) [Ensemble]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="4&#65289;Stacking&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;">4&#65289;Stacking&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;<a class="anchor-link" href="#4&#65289;Stacking&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 加载依赖包</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">make_blobs</span><span class="p">,</span> <span class="n">make_moons</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### 4）Stacking融合（分类）</span>
<span class="sd">&#39;&#39;&#39; 5-Fold Stacking &#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">ExtraTreesClassifier</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="c1"># 以鸢尾花数据为例</span>
<span class="n">data_0</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data_0</span><span class="p">[:</span><span class="mi">100</span><span class="p">,:]</span>   <span class="c1"># 前100个数据只包含了2种类别,因此该单元格的代码解决的是二分类问题</span>

<span class="n">target_0</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>   <span class="c1"># 前100个数据只包含了2种类别</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target_0</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>

<span class="c1"># 融合单模</span>
<span class="n">clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">),</span> 
     <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">),</span>
     <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">),</span>
     <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;entropy&#39;</span><span class="p">),</span>
     <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="p">]</span>

<span class="c1"># 切分部分数据作为测试集（测试集不参与模型调参，只参与模型选择）</span>
<span class="n">X</span><span class="p">,</span> <span class="n">X_predict</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_predict</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2022</span><span class="p">)</span>

<span class="n">dataset_blend_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">clfs</span><span class="p">)))</span>
<span class="n">dataset_blend_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_predict</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">clfs</span><span class="p">)))</span>

<span class="c1"># 5折Stacking</span>
<span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="p">)</span>
<span class="n">skf</span> <span class="o">=</span> <span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clfs</span><span class="p">):</span> 
  <span class="c1"># 依次训练单模 </span>
  <span class="n">dataset_blend_test_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_predict</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">))</span> 
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skf</span><span class="p">):</span> 
    <span class="c1"># 5-Fold交叉训练，使用第i个部分作为预测，剩余部分来训练模型，获得其预测的输出作为第i部分的新特征 </span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">test</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test</span><span class="p">]</span>  
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> 
    <span class="n">y_submission</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">dataset_blend_train</span><span class="p">[</span><span class="n">test</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_submission</span>  
    <span class="n">dataset_blend_test_j</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span> 
  <span class="c1"># 对于测试集（y_predict)，与5折计算结果（分类概率）的均值进行比较得到ROC相关的评估指标 </span>
  <span class="n">dataset_blend_test</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_blend_test_j</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;val auc score: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_predict</span><span class="p">,</span> <span class="n">dataset_blend_test</span><span class="p">[:,</span><span class="n">j</span><span class="p">]))</span>  
  <span class="c1"># break </span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span> 
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset_blend_train</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
<span class="n">y_submission</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">dataset_blend_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Val auc Score of Stacking: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_predict</span><span class="p">,</span><span class="n">y_submission</span><span class="p">)))</span>                                                    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>val auc score: 1.000000
val auc score: 0.500000
val auc score: 0.500000
val auc score: 0.500000
val auc score: 0.500000
Val auc Score of Stacking: 1.000000
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="5&#65289;Blending&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;">5&#65289;Blending&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;<a class="anchor-link" href="#5&#65289;Blending&#34701;&#21512;&#65288;&#20998;&#31867;&#65289;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Blending融合</span>
<span class="c1"># 创建训练的数据集</span>
<span class="n">data_0</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data_0</span><span class="p">[:</span><span class="mi">100</span><span class="p">,:]</span>
<span class="n">target_0</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target_0</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>

<span class="c1"># 引入单模</span>
<span class="n">clfs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">),</span> 
      <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">),</span>
      <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;entropy&#39;</span><span class="p">),</span>
      <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">),</span>
      <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;entropy&#39;</span><span class="p">),</span>
      <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="p">]</span>
<span class="c1"># 划分一部分数据作为测试集</span>
<span class="n">X</span><span class="p">,</span> <span class="n">X_predict</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_predict</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>

<span class="c1"># 切分训练数据集为d1,d2两部分</span>
<span class="n">X_d1</span><span class="p">,</span> <span class="n">X_d2</span><span class="p">,</span> <span class="n">y_d1</span><span class="p">,</span> <span class="n">y_d2</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2022</span><span class="p">)</span>
<span class="n">dataset_d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_d1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">clfs</span><span class="p">)))</span>
<span class="n">dataset_d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_predict</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">clfs</span><span class="p">)))</span>

<span class="c1"># 依次训练单模</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clfs</span><span class="p">):</span>
  <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_d1</span><span class="p">,</span><span class="n">y_d1</span><span class="p">)</span>
  <span class="n">y_submission</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_d2</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">dataset_d1</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_submission</span>
  <span class="c1"># 对于测试集，直接用这k个模型的预测值作为新的特征</span>
  <span class="n">dataset_d2</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Val auc Score:</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_predict</span><span class="p">,</span> <span class="n">dataset_d2</span><span class="p">[:,</span><span class="n">j</span><span class="p">]))</span>

<span class="c1"># 融合使用的模型</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset_d1</span><span class="p">,</span> <span class="n">y_d2</span><span class="p">)</span>
<span class="n">y_submission</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">dataset_d2</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Val auc Score of Blending: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_predict</span><span class="p">,</span> <span class="n">y_submission</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Val auc Score:1.000000
Val auc Score:1.000000
Val auc Score:1.000000
Val auc Score:1.000000
Val auc Score:1.000000
Val auc Score:1.000000
Val auc Score of Blending: 1.000000
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20998;&#31867;-&#27169;&#22411;&#34701;&#21512;&#8212;&#8212;&#24515;&#30005;&#20449;&#21495;&#20998;&#31867;&#23454;&#25112;">&#20998;&#31867;-&#27169;&#22411;&#34701;&#21512;&#8212;&#8212;&#24515;&#30005;&#20449;&#21495;&#20998;&#31867;&#23454;&#25112;<a class="anchor-link" href="#&#20998;&#31867;-&#27169;&#22411;&#34701;&#21512;&#8212;&#8212;&#24515;&#30005;&#20449;&#21495;&#20998;&#31867;&#23454;&#25112;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#20934;&#22791;&#24037;&#20316;">&#20934;&#22791;&#24037;&#20316;<a class="anchor-link" href="#&#20934;&#22791;&#24037;&#20316;">&#182;</a></h4><p>流程：</p>
<ol>
<li>导入数据，预处理</li>
<li>划分train和test集</li>
<li>构建单模：RF，LGB，NN</li>
<li>读取并演示如何利用融合模型生成可提交预测数据</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 加载依赖包</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="k">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span><span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span>

<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="k">import</span> <span class="n">MLPClassifier</span><span class="p">,</span><span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 引入降内存的函数</span>
<span class="k">def</span> <span class="nf">reduce_mem_usage</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">start_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage of dataframe is </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        
        <span class="k">if</span> <span class="n">col_type</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">c_min</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">c_max</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_type</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="n">end_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage after optimization is: </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_mem</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decreased by </span><span class="si">{:.1f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_mem</span> <span class="o">-</span> <span class="n">end_mem</span><span class="p">)</span> <span class="o">/</span> <span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 读取数据</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train.csv&#39;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span>
<span class="c1"># 简单预处理</span>
<span class="n">train_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">train</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">train_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">test_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">test_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_list</span><span class="p">))</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_list</span><span class="p">))</span>

<span class="c1"># rename_columns</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">features</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># 划分特征集和标签集</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="c1"># 测试集</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 第一次运行可以先用一个subdata</span>
<span class="c1"># X_train = X_train.iloc[:500, :20]</span>
<span class="c1"># y_train = y_train.iloc[:500]</span>
<span class="c1"># X_test = X_test.iloc[:500, :20]</span>

<span class="c1"># 划分训练集train和验证集val</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Memory usage of dataframe is 157.93 MB
Memory usage after optimization is: 39.67 MB
Decreased by 74.9%
Memory usage of dataframe is 31.43 MB
Memory usage after optimization is: 7.90 MB
Decreased by 74.9%
predict rf...
predict lgb...
predict NN...
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/neural_network/_multilayer_perceptron.py:470: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  self.n_iter_ = _check_optimize_result(&#34;lbfgs&#34;, opt_res, self.max_iter)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#26500;&#24314;&#21333;&#27169;">&#26500;&#24314;&#21333;&#27169;<a class="anchor-link" href="#&#26500;&#24314;&#21333;&#27169;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 单模函数</span>
<span class="k">def</span> <span class="nf">build_model_rf</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span>

<span class="k">def</span> <span class="nf">build_model_lgb</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">num_leaves</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span>

<span class="k">def</span> <span class="nf">build_model_nn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="c1"># 赛制评分标准</span>
<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  
  <span class="c1"># preds = np.argmax(preds.reshape(4,-1),axis=0)</span>
  <span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">labels_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">preds_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">labels_</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">preds_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">labels_</span> <span class="o">-</span> <span class="n">preds_</span><span class="p">)))</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="c1"># 单模/弱分类器训练（不含调参）</span>
<span class="c1"># print(&#39;predict rf...&#39;)</span>
<span class="c1"># model_rf = build_model_rf(X_train, y_train)</span>
<span class="c1"># val_rf = model_rf.predict(X_val)   # 准确来说，该处为验证环节</span>
<span class="c1"># subA_rf = model_rf.predict(X_test)  # 针对testA.csv文件，是测试环节</span>
<span class="c1"># score_for_Competition = feval_abs_sum(val_rf, y_val)  # 注意区分y_true和y_val</span>
<span class="c1"># print(&#39;score_for_Competition of RF:&#39;,score_for_Competition)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">predict rf...</span>
<span class="sd">(30000, 4) </span>
<span class="sd"> (30000, 4)</span>
<span class="sd">score_for_Competition of RF: 1162.0</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># print(&#39;predict lgb...&#39;)</span>
<span class="c1"># model_lgb = build_model_lgb(X_train, y_train)</span>
<span class="c1"># val_lgb = model_lgb.predict(X_val)</span>
<span class="c1"># subA_lgb = model_lgb.predict(X_test)</span>
<span class="c1"># score_for_Competition = feval_abs_sum(val_lgb, y_val)  # 注意区分y_true和y_val</span>
<span class="c1"># print(&#39;score_for_Competition of lightGBM:&#39;,score_for_Competition)</span>
<span class="sd">&#39;&#39;&#39;报错:</span>
<span class="sd">operands could not be broadcast together with shapes (30000,4) (30000,28678) </span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predict NN...&#39;</span><span class="p">)</span>
<span class="n">model_nn</span> <span class="o">=</span> <span class="n">build_model_nn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">val_nn</span> <span class="o">=</span> <span class="n">model_nn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">subA_nn</span> <span class="o">=</span> <span class="n">model_nn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">val_nn</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>  <span class="c1"># 注意区分y_true和y_val</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition of NN:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">operands could not be broadcast together with shapes (30000,4) (30000,29999) </span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="&#21152;&#26435;&#34701;&#21512;">&#21152;&#26435;&#34701;&#21512;<a class="anchor-link" href="#&#21152;&#26435;&#34701;&#21512;">&#182;</a></h4><p>加权矩阵可自定义，如果没有给，则默认均值加权融合</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 均值融合 --&gt; w = [1/3, 1/3, 1/3] 或者自定义：w=[0.2,0.3,0.5]</span>
<span class="k">def</span> <span class="nf">Weighted_method</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">,</span> <span class="n">test_pre2</span><span class="p">,</span> <span class="n">test_pre3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">]):</span>
  <span class="n">Weighted_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre1</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre2</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_pre3</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">Weighted_result</span>

<span class="c1"># 自定义w进行融合</span>
<span class="n">w</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">val_pre</span> <span class="o">=</span> <span class="n">Weighted_method</span><span class="p">(</span><span class="n">val_rf</span><span class="p">,</span> <span class="n">val_lgb</span><span class="p">,</span> <span class="n">val_nn</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="n">MAE_Weighted</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">val_pre</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MAE of Weighted of val：&#39;</span><span class="p">,</span> <span class="n">MAE_Weighted</span><span class="p">)</span>

<span class="c1"># 测试与提交</span>
<span class="n">subA</span> <span class="o">=</span> <span class="n">Weighted_method</span><span class="p">(</span><span class="n">subA_rf</span><span class="p">,</span> <span class="n">subA_lgb</span><span class="p">,</span> <span class="n">subA_nn</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

<span class="n">sub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">sub</span><span class="p">[</span><span class="s1">&#39;SaleID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">index</span>
<span class="n">sub</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subA</span>
<span class="n">sub</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/sub_weighted.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>MAE of Weighted of val： 0.32152826961009273
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="STacking&#34701;&#21512;">STacking&#34701;&#21512;<a class="anchor-link" href="#STacking&#34701;&#21512;">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## 第一层</span>
<span class="n">train_rf_pred</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">train_lgb_pred</span> <span class="o">=</span> <span class="n">model_lgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">train_nn_pred</span> <span class="o">=</span> <span class="n">model_nn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">stacking_X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">stacking_X_train</span><span class="p">[</span><span class="s1">&#39;Method_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_rf_pred</span>
<span class="n">stacking_X_train</span><span class="p">[</span><span class="s1">&#39;Method_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_lgb_pred</span>
<span class="n">stacking_X_train</span><span class="p">[</span><span class="s1">&#39;Method_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_nn_pred</span>

<span class="n">stacking_X_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">stacking_X_val</span><span class="p">[</span><span class="s1">&#39;Method_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_rf</span>
<span class="n">stacking_X_val</span><span class="p">[</span><span class="s1">&#39;Method_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_lgb</span>
<span class="n">stacking_X_val</span><span class="p">[</span><span class="s1">&#39;Method_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_nn</span>

<span class="n">stacking_X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">stacking_X_test</span><span class="p">[</span><span class="s1">&#39;Method_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subA_rf</span> 
<span class="n">stacking_X_test</span><span class="p">[</span><span class="s1">&#39;Method_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subA_lgb</span>
<span class="n">stacking_X_test</span><span class="p">[</span><span class="s1">&#39;Method_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subA_nn</span>

<span class="c1">## 第二层用random forest</span>
<span class="n">model_lr_stacking</span> <span class="o">=</span> <span class="n">build_model_rf</span><span class="p">(</span><span class="n">stacking_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 训练集</span>
<span class="n">train_pre_Stacking</span> <span class="o">=</span> <span class="n">model_lr_stacking</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">stacking_X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MAE of stacking:&#39;</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pre_Stacking</span><span class="p">))</span>

<span class="c1"># 验证集</span>
<span class="n">val_pre_Stacking</span> <span class="o">=</span> <span class="n">model_lr_stacking</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">stacking_X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MAE of stacking:&#39;</span><span class="p">,</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span><span class="n">val_pre_Stacking</span><span class="p">))</span>

<span class="c1"># 测试集（for testA.csv)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predict stacking...&#39;</span><span class="p">)</span>
<span class="n">subA_Stacking</span> <span class="o">=</span> <span class="n">model_lr_stacking</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">stacking_X_test</span><span class="p">)</span>

<span class="c1"># 提交</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">sub</span><span class="p">[</span><span class="s1">&#39;SaleID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">index</span>
<span class="n">sub</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subA_Stacking</span>
<span class="n">sub</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/sub_Stacking.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>MAE of stacking: 0.0
MAE of stacking: 0.2067
Predict stacking...
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#8220;&#30701;&#24179;&#24555;&#23454;&#36341;-&#8221;&#33267;&#8220;AutoML&#8221;&#20026;&#23454;&#25805;&#20195;&#30721;"><em>&#8220;&#30701;&#24179;&#24555;&#23454;&#36341; &#8221;&#33267;&#8220;AutoML&#8221;&#20026;&#23454;&#25805;&#20195;&#30721;</em><a class="anchor-link" href="#&#8220;&#30701;&#24179;&#24555;&#23454;&#36341;-&#8221;&#33267;&#8220;AutoML&#8221;&#20026;&#23454;&#25805;&#20195;&#30721;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#30701;&#24179;&#24555;&#23454;&#36341;">&#30701;&#24179;&#24555;&#23454;&#36341;<a class="anchor-link" href="#&#30701;&#24179;&#24555;&#23454;&#36341;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#20934;&#22791;&#24037;&#20316;">&#20934;&#22791;&#24037;&#20316;<a class="anchor-link" href="#&#20934;&#22791;&#24037;&#20316;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入包</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">make_scorer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="k">import</span> <span class="n">LGBMRegressor</span><span class="p">,</span> <span class="n">LGBMClassifier</span>
 
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
 
 
<span class="c1"># 数据预处理</span>
<span class="k">def</span> <span class="nf">reduce_mem_usage</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">start_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage of dataframe is </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        
        <span class="k">if</span> <span class="n">col_type</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">c_min</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">c_max</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_type</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
 
    <span class="n">end_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage after optimization is: </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_mem</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decreased by </span><span class="si">{:.1f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_mem</span> <span class="o">-</span> <span class="n">end_mem</span><span class="p">)</span> <span class="o">/</span> <span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">df</span>
 
 
<span class="c1"># 读取数据</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train.csv&#39;</span><span class="p">)</span>
<span class="n">data_features_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Features_Extract/train_features_filtered_MinimalFCParameters.csv&#39;</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
 
<span class="c1"># 原始特征Dataframe</span>
<span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_list</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;s_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
 
<span class="n">data</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
 
<span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/features_labels.csv&#39;</span><span class="p">)</span>
 
<span class="c1"># 分离数据</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
 
<span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Memory usage of dataframe is 157.93 MB
Memory usage after optimization is: 39.67 MB
Decreased by 74.9%
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#26500;&#24314;&#21333;&#27169;">&#26500;&#24314;&#21333;&#27169;<a class="anchor-link" href="#&#26500;&#24314;&#21333;&#27169;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="lightGBM">lightGBM<a class="anchor-link" href="#lightGBM">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 自定义评价指标</span>
<span class="k">def</span> <span class="nf">f1_score_vali</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">data_vali</span><span class="p">):</span>
  <span class="n">labels</span> <span class="o">=</span> <span class="n">data_vali</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="c1"># print(&#39;labels type&amp;shape:&#39;,type(labels), len(labels), &#39;\n&#39;,&#39;preds type&amp;shape:&#39;,type(preds), preds.shape)</span>
  <span class="n">score_vali</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
  <span class="k">return</span> <span class="s1">&#39;f1_score&#39;</span><span class="p">,</span> <span class="n">score_vali</span><span class="p">,</span> <span class="kc">True</span>

<span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">data_vali</span><span class="p">):</span>
  <span class="n">labels</span> <span class="o">=</span> <span class="n">data_vali</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">labels_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">preds_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">labels_</span> <span class="o">-</span> <span class="n">preds_</span><span class="p">)))</span>
  <span class="c1"># score_vali = f1_score(y_true=labels, y_pred=preds, average=&#39;macro&#39;)</span>
  <span class="k">return</span> <span class="s1">&#39;score_for_Competition&#39;</span><span class="p">,</span> <span class="n">score_for_Competition</span><span class="p">,</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">feval_abs_sum_sparse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入概率分布的pred和稀疏标签的labels，用OneHot计算score_for_Competition</span>
  <span class="c1"># preds = np.argmax(preds,axis=1)</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
  <span class="c1"># print(preds)</span>
  <span class="c1"># print(labels)</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="s1">&#39;score_for_Competition&#39;</span><span class="p">,</span> <span class="n">score_for_Competition</span><span class="p">,</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 用lightGBM建立Dataset</span>
<span class="n">train_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">valid_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_val</span><span class="p">)</span>

<span class="c1"># 设置模型参数</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;boosting&#39;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lambda_l2&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;min_data_in_lea&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
    <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_split_gain&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;num_class&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;nthread&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>


<span class="c1"># 使用lightGBM进行训练</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">train_set</span> <span class="o">=</span> <span class="n">train_matrix</span><span class="p">,</span>
    <span class="n">valid_sets</span> <span class="o">=</span> <span class="n">valid_matrix</span><span class="p">,</span>
    <span class="n">num_boost_round</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">verbose_eval</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
    <span class="n">feval</span> <span class="o">=</span> <span class="n">f1_score_vali</span>
<span class="p">)</span>

<span class="c1"># 保存模型</span>
<span class="c1"># model.booster_.savemodel(&quot;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LightGBM_ECG.txt&quot;)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training until validation scores don&#39;t improve for 400 rounds.
[50]	valid_0&#39;s multi_logloss: 0.106386	valid_0&#39;s f1_score: 0.925387
[100]	valid_0&#39;s multi_logloss: 0.0735948	valid_0&#39;s f1_score: 0.941689
[150]	valid_0&#39;s multi_logloss: 0.0630055	valid_0&#39;s f1_score: 0.947696
[200]	valid_0&#39;s multi_logloss: 0.0560957	valid_0&#39;s f1_score: 0.952306
[250]	valid_0&#39;s multi_logloss: 0.0516787	valid_0&#39;s f1_score: 0.955923
[300]	valid_0&#39;s multi_logloss: 0.0499089	valid_0&#39;s f1_score: 0.957633
[350]	valid_0&#39;s multi_logloss: 0.0489718	valid_0&#39;s f1_score: 0.958154
[400]	valid_0&#39;s multi_logloss: 0.0486045	valid_0&#39;s f1_score: 0.959966
[450]	valid_0&#39;s multi_logloss: 0.0480774	valid_0&#39;s f1_score: 0.960603
[500]	valid_0&#39;s multi_logloss: 0.0472645	valid_0&#39;s f1_score: 0.961346
[550]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
[600]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
[650]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
[700]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
[750]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
[800]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
[850]	valid_0&#39;s multi_logloss: 0.0471555	valid_0&#39;s f1_score: 0.961156
Early stopping, best iteration is:
[496]	valid_0&#39;s multi_logloss: 0.0473315	valid_0&#39;s f1_score: 0.961662
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LightGBM_ECG.txt&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;lightgbm.basic.Booster at 0x7f11200bf450&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 加载已有模型</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Booster</span><span class="p">(</span><span class="n">model_file</span><span class="o">=</span><span class="s2">&quot;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LightGBM_ECG.txt&quot;</span><span class="p">)</span>

<span class="c1"># 对验证集进行验证</span>
<span class="n">val_pred_lgb</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">num_iteration</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">best_iteration</span><span class="p">)</span> 
<span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">val_pred_lgb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;未调参前lightGBM单模在验证集上的f1:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>

<span class="c1"># 按照比赛规定的计分方法计算评分</span>
<span class="c1"># from sklearn.preprocessing import OneHotEncoder</span>
<span class="c1"># onehot_encoder = OneHotEncoder(sparse=False)</span>
<span class="c1"># y_val_ = onehot_encoder.fit_transform(y_val.values.reshape(len(y_val), 1))</span>
<span class="c1"># preds_ = onehot_encoder.fit_transform(preds.reshape(len(preds), 1))</span>
<span class="c1"># def abs_sum(y_pred, y_true):</span>
<span class="c1">#   loss = sum(sum(abs(y_pred-y_true)))</span>
<span class="c1">#   return loss</span>
<span class="c1"># print(abs_sum(preds_, y_val_))</span>


<span class="k">def</span> <span class="nf">feval_abs_sum_sparse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入概率分布的pred和稀疏标签的labels，用OneHot计算score_for_Competition</span>
  <span class="c1"># preds = np.argmax(preds,axis=1)</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># print(preds)</span>
  <span class="c1"># print(labels)</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum_sparse</span><span class="p">(</span><span class="n">val_pred_lgb</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition&#39;</span><span class="p">,</span> <span class="n">score_for_Competition</span> <span class="p">)</span>


<span class="c1"># 以该lightGBM结构计算500步后得到score_for_Competition为531.2， 记录于2021/04/23/02:30，模型名称: LightGBM_ECG.txt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>未调参前lightGBM单模在验证集上的f1:0.19541168157118838
score_for_Competition (17922, True)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>

<span class="c1"># 使用5折交叉验证进行模型性能评估</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">cv_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">valid_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************* </span><span class="si">{}</span><span class="s1"> *********************************&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
  <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> \
  <span class="n">features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">valid_index</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">valid_index</span><span class="p">]</span>

  <span class="n">train_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
  <span class="n">valid_matrix</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_val</span><span class="p">)</span>

  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;boosting&#39;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lambda_l2&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;min_data_in_lea&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
    <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_split_gain&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;num_class&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;nthread&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="p">,</span>
            <span class="n">train_set</span> <span class="o">=</span> <span class="n">train_matrix</span><span class="p">,</span>
            <span class="n">valid_sets</span> <span class="o">=</span> <span class="n">valid_matrix</span><span class="p">,</span>
            <span class="n">num_boost_round</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
            <span class="n">verbose_eval</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">early_stopping_rounds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">feval</span> <span class="o">=</span> <span class="n">f1_score_vali</span><span class="p">)</span>
  <span class="c1"># model = lgb.Booster(model_file=&quot;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LightGBM_ECG.txt&quot;)</span>
  <span class="n">val_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">num_iteration</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">best_iteration</span><span class="p">)</span>
  <span class="n">val_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">val_pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">cv_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">val_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lgb_scotrainre_list:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lgb_score_mean:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lgb_score_std:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>********************************* 1 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.0680069	valid_0&#39;s f1_score: 0.943052
[200]	valid_0&#39;s multi_logloss: 0.051981	valid_0&#39;s f1_score: 0.952192
[300]	valid_0&#39;s multi_logloss: 0.0465615	valid_0&#39;s f1_score: 0.957848
[400]	valid_0&#39;s multi_logloss: 0.0438683	valid_0&#39;s f1_score: 0.961399
[500]	valid_0&#39;s multi_logloss: 0.0427846	valid_0&#39;s f1_score: 0.963495
[600]	valid_0&#39;s multi_logloss: 0.0428119	valid_0&#39;s f1_score: 0.963709
Early stopping, best iteration is:
[493]	valid_0&#39;s multi_logloss: 0.0427778	valid_0&#39;s f1_score: 0.963903
[0.9639028937105489]
********************************* 2 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.0702369	valid_0&#39;s f1_score: 0.94154
[200]	valid_0&#39;s multi_logloss: 0.0543702	valid_0&#39;s f1_score: 0.95352
[300]	valid_0&#39;s multi_logloss: 0.0478633	valid_0&#39;s f1_score: 0.957045
[400]	valid_0&#39;s multi_logloss: 0.0456973	valid_0&#39;s f1_score: 0.960362
[500]	valid_0&#39;s multi_logloss: 0.0443044	valid_0&#39;s f1_score: 0.962232
[600]	valid_0&#39;s multi_logloss: 0.0443265	valid_0&#39;s f1_score: 0.962122
Early stopping, best iteration is:
[491]	valid_0&#39;s multi_logloss: 0.0441585	valid_0&#39;s f1_score: 0.961866
[0.9639028937105489, 0.9618661070253979]
********************************* 3 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.0699167	valid_0&#39;s f1_score: 0.946372
[200]	valid_0&#39;s multi_logloss: 0.0560052	valid_0&#39;s f1_score: 0.954593
[300]	valid_0&#39;s multi_logloss: 0.0495382	valid_0&#39;s f1_score: 0.960488
[400]	valid_0&#39;s multi_logloss: 0.0476321	valid_0&#39;s f1_score: 0.961676
[500]	valid_0&#39;s multi_logloss: 0.0468683	valid_0&#39;s f1_score: 0.963242
[600]	valid_0&#39;s multi_logloss: 0.046883	valid_0&#39;s f1_score: 0.963849
Early stopping, best iteration is:
[444]	valid_0&#39;s multi_logloss: 0.0470997	valid_0&#39;s f1_score: 0.964088
[0.9639028937105489, 0.9618661070253979, 0.9640878355611643]
********************************* 4 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.0676124	valid_0&#39;s f1_score: 0.946275
[200]	valid_0&#39;s multi_logloss: 0.0493184	valid_0&#39;s f1_score: 0.958167
[300]	valid_0&#39;s multi_logloss: 0.0422166	valid_0&#39;s f1_score: 0.96465
[400]	valid_0&#39;s multi_logloss: 0.0407112	valid_0&#39;s f1_score: 0.965074
[500]	valid_0&#39;s multi_logloss: 0.039108	valid_0&#39;s f1_score: 0.967165
[600]	valid_0&#39;s multi_logloss: 0.039108	valid_0&#39;s f1_score: 0.967165
Early stopping, best iteration is:
[464]	valid_0&#39;s multi_logloss: 0.0391182	valid_0&#39;s f1_score: 0.967442
[0.9639028937105489, 0.9618661070253979, 0.9640878355611643, 0.9674416557062316]
********************************* 5 *********************************
Training until validation scores don&#39;t improve for 200 rounds.
[100]	valid_0&#39;s multi_logloss: 0.0693076	valid_0&#39;s f1_score: 0.940349
[200]	valid_0&#39;s multi_logloss: 0.0514287	valid_0&#39;s f1_score: 0.956156
[300]	valid_0&#39;s multi_logloss: 0.0441897	valid_0&#39;s f1_score: 0.960519
[400]	valid_0&#39;s multi_logloss: 0.0426504	valid_0&#39;s f1_score: 0.963557
[500]	valid_0&#39;s multi_logloss: 0.0419835	valid_0&#39;s f1_score: 0.964207
[600]	valid_0&#39;s multi_logloss: 0.0418446	valid_0&#39;s f1_score: 0.965018
[700]	valid_0&#39;s multi_logloss: 0.0418446	valid_0&#39;s f1_score: 0.965018
Early stopping, best iteration is:
[524]	valid_0&#39;s multi_logloss: 0.041905	valid_0&#39;s f1_score: 0.965619
[0.9639028937105489, 0.9618661070253979, 0.9640878355611643, 0.9674416557062316, 0.9653493466758218]
lgb_scotrainre_list:[0.9639028937105489, 0.9618661070253979, 0.9640878355611643, 0.9674416557062316, 0.9653493466758218]
lgb_score_mean:0.9645295677358329
lgb_score_std:0.0018348931555774335
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">####  lightGBM网格调参</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="LSTM">LSTM<a class="anchor-link" href="#LSTM">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># 导入模型前预处理</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_val</span> <span class="o">=</span> <span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_val</span><span class="p">),</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_val</span><span class="p">),</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;numpy.ndarray&#39;&gt; (75000, 205, 1)
&lt;class &#39;numpy.ndarray&#39;&gt; (25000, 205, 1)
&lt;class &#39;numpy.ndarray&#39;&gt; (75000, 1)
&lt;class &#39;numpy.ndarray&#39;&gt; (25000, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">BatchNormalization</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">tensorflow.compat.v1.keras.layers</span> <span class="k">import</span> <span class="n">CuDNNLSTM</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">keras</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CuDNNLSTM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">l2</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)))</span>  <span class="c1">#  return_sequences=True</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
<span class="c1"># model.add(CuDNNLSTM(64, return_sequences=True))</span>
<span class="c1"># model.add(BatchNormalization())</span>
<span class="c1"># model.add(CuDNNLSTM(32))</span>
<span class="c1"># model.add(BatchNormalization())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="n">validation_split</span> <span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># model.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LSTM_ECG_0423_2.h5&#39;)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
713/713 [==============================] - 27s 15ms/step - loss: 0.9863 - accuracy: 0.6631 - val_loss: 0.9080 - val_accuracy: 0.7360
Epoch 2/100
713/713 [==============================] - 10s 14ms/step - loss: 0.6132 - accuracy: 0.7991 - val_loss: 0.7451 - val_accuracy: 0.7691
Epoch 3/100
713/713 [==============================] - 10s 14ms/step - loss: 0.5047 - accuracy: 0.8400 - val_loss: 0.4540 - val_accuracy: 0.8520
Epoch 4/100
713/713 [==============================] - 10s 14ms/step - loss: 0.4517 - accuracy: 0.8624 - val_loss: 0.4142 - val_accuracy: 0.8789
Epoch 5/100
713/713 [==============================] - 10s 14ms/step - loss: 0.4239 - accuracy: 0.8716 - val_loss: 0.7186 - val_accuracy: 0.7851
Epoch 6/100
713/713 [==============================] - 10s 14ms/step - loss: 0.4114 - accuracy: 0.8751 - val_loss: 0.4597 - val_accuracy: 0.8496
Epoch 7/100
713/713 [==============================] - 10s 14ms/step - loss: 0.3745 - accuracy: 0.8853 - val_loss: 0.3121 - val_accuracy: 0.9136
Epoch 8/100
713/713 [==============================] - 10s 14ms/step - loss: 0.3473 - accuracy: 0.8951 - val_loss: 0.3598 - val_accuracy: 0.8909
Epoch 9/100
713/713 [==============================] - 10s 14ms/step - loss: 0.3335 - accuracy: 0.9003 - val_loss: 0.4646 - val_accuracy: 0.8363
Epoch 10/100
713/713 [==============================] - 10s 14ms/step - loss: 0.3129 - accuracy: 0.9055 - val_loss: 0.3171 - val_accuracy: 0.9061
Epoch 11/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2916 - accuracy: 0.9136 - val_loss: 0.2846 - val_accuracy: 0.9077
Epoch 12/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2715 - accuracy: 0.9217 - val_loss: 0.3975 - val_accuracy: 0.8704
Epoch 13/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2653 - accuracy: 0.9228 - val_loss: 0.2436 - val_accuracy: 0.9307
Epoch 14/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2484 - accuracy: 0.9287 - val_loss: 0.3006 - val_accuracy: 0.9093
Epoch 15/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2314 - accuracy: 0.9359 - val_loss: 0.3706 - val_accuracy: 0.8792
Epoch 16/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2219 - accuracy: 0.9381 - val_loss: 0.2151 - val_accuracy: 0.9459
Epoch 17/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2137 - accuracy: 0.9412 - val_loss: 0.2200 - val_accuracy: 0.9352
Epoch 18/100
713/713 [==============================] - 10s 14ms/step - loss: 0.2002 - accuracy: 0.9433 - val_loss: 0.1762 - val_accuracy: 0.9509
Epoch 19/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1974 - accuracy: 0.9473 - val_loss: 0.1930 - val_accuracy: 0.9456
Epoch 20/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1938 - accuracy: 0.9457 - val_loss: 0.1488 - val_accuracy: 0.9589
Epoch 21/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1767 - accuracy: 0.9515 - val_loss: 0.1463 - val_accuracy: 0.9619
Epoch 22/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1691 - accuracy: 0.9533 - val_loss: 0.1466 - val_accuracy: 0.9595
Epoch 23/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1640 - accuracy: 0.9554 - val_loss: 0.2902 - val_accuracy: 0.8973
Epoch 24/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1647 - accuracy: 0.9545 - val_loss: 0.1671 - val_accuracy: 0.9573
Epoch 25/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1566 - accuracy: 0.9571 - val_loss: 0.1423 - val_accuracy: 0.9621
Epoch 26/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1511 - accuracy: 0.9590 - val_loss: 0.1182 - val_accuracy: 0.9688
Epoch 27/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1462 - accuracy: 0.9602 - val_loss: 0.1385 - val_accuracy: 0.9624
Epoch 28/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1406 - accuracy: 0.9610 - val_loss: 0.1371 - val_accuracy: 0.9616
Epoch 29/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1396 - accuracy: 0.9623 - val_loss: 0.1418 - val_accuracy: 0.9627
Epoch 30/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1354 - accuracy: 0.9635 - val_loss: 0.1153 - val_accuracy: 0.9707
Epoch 31/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1303 - accuracy: 0.9639 - val_loss: 0.1189 - val_accuracy: 0.9675
Epoch 32/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1318 - accuracy: 0.9642 - val_loss: 0.1030 - val_accuracy: 0.9720
Epoch 33/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1240 - accuracy: 0.9659 - val_loss: 0.1839 - val_accuracy: 0.9475
Epoch 34/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1183 - accuracy: 0.9672 - val_loss: 0.1112 - val_accuracy: 0.9667
Epoch 35/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1126 - accuracy: 0.9704 - val_loss: 0.1616 - val_accuracy: 0.9579
Epoch 36/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1109 - accuracy: 0.9695 - val_loss: 0.1088 - val_accuracy: 0.9733
Epoch 37/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1109 - accuracy: 0.9697 - val_loss: 0.0952 - val_accuracy: 0.9736
Epoch 38/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1073 - accuracy: 0.9700 - val_loss: 0.0949 - val_accuracy: 0.9763
Epoch 39/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1023 - accuracy: 0.9721 - val_loss: 0.0877 - val_accuracy: 0.9771
Epoch 40/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0989 - accuracy: 0.9722 - val_loss: 0.1369 - val_accuracy: 0.9624
Epoch 41/100
713/713 [==============================] - 10s 14ms/step - loss: 0.1013 - accuracy: 0.9724 - val_loss: 0.0865 - val_accuracy: 0.9771
Epoch 42/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0949 - accuracy: 0.9738 - val_loss: 0.0808 - val_accuracy: 0.9789
Epoch 43/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0913 - accuracy: 0.9750 - val_loss: 0.1013 - val_accuracy: 0.9709
Epoch 44/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0909 - accuracy: 0.9742 - val_loss: 0.0862 - val_accuracy: 0.9768
Epoch 45/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0853 - accuracy: 0.9768 - val_loss: 0.0883 - val_accuracy: 0.9765
Epoch 46/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0866 - accuracy: 0.9770 - val_loss: 0.0847 - val_accuracy: 0.9792
Epoch 47/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0885 - accuracy: 0.9754 - val_loss: 0.1047 - val_accuracy: 0.9709
Epoch 48/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0849 - accuracy: 0.9758 - val_loss: 0.1258 - val_accuracy: 0.9661
Epoch 49/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0828 - accuracy: 0.9774 - val_loss: 0.0721 - val_accuracy: 0.9816
Epoch 50/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0787 - accuracy: 0.9776 - val_loss: 0.0768 - val_accuracy: 0.9811
Epoch 51/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0808 - accuracy: 0.9770 - val_loss: 0.0744 - val_accuracy: 0.9781
Epoch 52/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0779 - accuracy: 0.9782 - val_loss: 0.0777 - val_accuracy: 0.9787
Epoch 53/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0751 - accuracy: 0.9794 - val_loss: 0.0820 - val_accuracy: 0.9779
Epoch 54/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0724 - accuracy: 0.9796 - val_loss: 0.0831 - val_accuracy: 0.9755
Epoch 55/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0715 - accuracy: 0.9803 - val_loss: 0.0783 - val_accuracy: 0.9781
Epoch 56/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0728 - accuracy: 0.9802 - val_loss: 0.0750 - val_accuracy: 0.9800
Epoch 57/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0746 - accuracy: 0.9788 - val_loss: 0.0869 - val_accuracy: 0.9768
Epoch 58/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0681 - accuracy: 0.9804 - val_loss: 0.0789 - val_accuracy: 0.9792
Epoch 59/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0689 - accuracy: 0.9819 - val_loss: 0.0764 - val_accuracy: 0.9813
Epoch 60/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0703 - accuracy: 0.9802 - val_loss: 0.0649 - val_accuracy: 0.9819
Epoch 61/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0664 - accuracy: 0.9811 - val_loss: 0.0694 - val_accuracy: 0.9803
Epoch 62/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0640 - accuracy: 0.9823 - val_loss: 0.0661 - val_accuracy: 0.9824
Epoch 63/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0626 - accuracy: 0.9831 - val_loss: 0.0688 - val_accuracy: 0.9827
Epoch 64/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0624 - accuracy: 0.9830 - val_loss: 0.0685 - val_accuracy: 0.9787
Epoch 65/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0627 - accuracy: 0.9837 - val_loss: 0.0655 - val_accuracy: 0.9819
Epoch 66/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0608 - accuracy: 0.9825 - val_loss: 0.0688 - val_accuracy: 0.9808
Epoch 67/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0606 - accuracy: 0.9829 - val_loss: 0.0646 - val_accuracy: 0.9832
Epoch 68/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0555 - accuracy: 0.9852 - val_loss: 0.0726 - val_accuracy: 0.9813
Epoch 69/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0598 - accuracy: 0.9830 - val_loss: 0.0871 - val_accuracy: 0.9773
Epoch 70/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0576 - accuracy: 0.9839 - val_loss: 0.0746 - val_accuracy: 0.9800
Epoch 71/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0568 - accuracy: 0.9843 - val_loss: 0.0798 - val_accuracy: 0.9760
Epoch 72/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0569 - accuracy: 0.9837 - val_loss: 0.0630 - val_accuracy: 0.9827
Epoch 73/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0543 - accuracy: 0.9847 - val_loss: 0.0683 - val_accuracy: 0.9808
Epoch 74/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0526 - accuracy: 0.9857 - val_loss: 0.0686 - val_accuracy: 0.9797
Epoch 75/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0532 - accuracy: 0.9851 - val_loss: 0.0750 - val_accuracy: 0.9803
Epoch 76/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0507 - accuracy: 0.9865 - val_loss: 0.0514 - val_accuracy: 0.9843
Epoch 77/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0489 - accuracy: 0.9872 - val_loss: 0.0602 - val_accuracy: 0.9843
Epoch 78/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0518 - accuracy: 0.9864 - val_loss: 0.0702 - val_accuracy: 0.9805
Epoch 79/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0534 - accuracy: 0.9860 - val_loss: 0.0566 - val_accuracy: 0.9856
Epoch 80/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0485 - accuracy: 0.9870 - val_loss: 0.0678 - val_accuracy: 0.9827
Epoch 81/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0499 - accuracy: 0.9859 - val_loss: 0.0591 - val_accuracy: 0.9840
Epoch 82/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0456 - accuracy: 0.9869 - val_loss: 0.0609 - val_accuracy: 0.9824
Epoch 83/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0466 - accuracy: 0.9869 - val_loss: 0.0659 - val_accuracy: 0.9845
Epoch 84/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0487 - accuracy: 0.9865 - val_loss: 0.0636 - val_accuracy: 0.9845
Epoch 85/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0447 - accuracy: 0.9880 - val_loss: 0.0652 - val_accuracy: 0.9803
Epoch 86/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0446 - accuracy: 0.9880 - val_loss: 0.0612 - val_accuracy: 0.9837
Epoch 87/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0451 - accuracy: 0.9876 - val_loss: 0.0621 - val_accuracy: 0.9845
Epoch 88/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0467 - accuracy: 0.9873 - val_loss: 0.0713 - val_accuracy: 0.9816
Epoch 89/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0436 - accuracy: 0.9881 - val_loss: 0.0615 - val_accuracy: 0.9848
Epoch 90/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0440 - accuracy: 0.9878 - val_loss: 0.0553 - val_accuracy: 0.9851
Epoch 91/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0412 - accuracy: 0.9883 - val_loss: 0.0762 - val_accuracy: 0.9795
Epoch 92/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0441 - accuracy: 0.9877 - val_loss: 0.0621 - val_accuracy: 0.9845
Epoch 93/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0452 - accuracy: 0.9874 - val_loss: 0.0742 - val_accuracy: 0.9797
Epoch 94/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0411 - accuracy: 0.9883 - val_loss: 0.0763 - val_accuracy: 0.9827
Epoch 95/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0390 - accuracy: 0.9895 - val_loss: 0.0558 - val_accuracy: 0.9851
Epoch 96/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0407 - accuracy: 0.9888 - val_loss: 0.0592 - val_accuracy: 0.9861
Epoch 97/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0419 - accuracy: 0.9883 - val_loss: 0.0611 - val_accuracy: 0.9864
Epoch 98/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0393 - accuracy: 0.9893 - val_loss: 0.0596 - val_accuracy: 0.9848
Epoch 99/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0394 - accuracy: 0.9890 - val_loss: 0.0536 - val_accuracy: 0.9872
Epoch 100/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0389 - accuracy: 0.9892 - val_loss: 0.0703 - val_accuracy: 0.9859
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="n">validation_split</span> <span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># model.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LSTM_ECG_0430.h5&#39;)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
713/713 [==============================] - 11s 15ms/step - loss: 0.0269 - accuracy: 0.9934 - val_loss: 0.0648 - val_accuracy: 0.9877
Epoch 2/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0162 - accuracy: 0.9952 - val_loss: 0.0438 - val_accuracy: 0.9893
Epoch 3/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0174 - accuracy: 0.9947 - val_loss: 0.0418 - val_accuracy: 0.9901
Epoch 4/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0155 - accuracy: 0.9953 - val_loss: 0.0683 - val_accuracy: 0.9864
Epoch 5/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0150 - accuracy: 0.9952 - val_loss: 0.0445 - val_accuracy: 0.9904
Epoch 6/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0154 - accuracy: 0.9958 - val_loss: 0.0476 - val_accuracy: 0.9896
Epoch 7/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0149 - accuracy: 0.9961 - val_loss: 0.0515 - val_accuracy: 0.9872
Epoch 10/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0144 - accuracy: 0.9963 - val_loss: 0.0478 - val_accuracy: 0.9893
Epoch 11/100
713/713 [==============================] - 10s 14ms/step - loss: 0.0148 - accuracy: 0.9960 - val_loss: 0.0478 - val_accuracy: 0.9885
Epoch 12/100
149/713 [=====&gt;........................] - ETA: 7s - loss: 0.0107 - accuracy: 0.9973</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 加载已有模型进行验证</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">tensorflow.compat.v1.keras.layers</span> <span class="k">import</span> <span class="n">CuDNNLSTM</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">keras</span>

<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LSTM_ECG_0430.h5&#39;</span>

<span class="n">model_xcc</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="c1"># optimizer = keras.optimizers.Adam(lr=0.0001, beta_1=0.9, beta_2=0.99, epsilon=1e-08, decay=0.0)</span>
<span class="c1"># model_xcc.compile(loss=&#39;sparse_categorical_crossentropy&#39;, optimizer=optimizer, metrics=[&#39;accuracy&#39;])</span>
<span class="c1"># history = model_xcc.fit(X_train, y_train, epochs=50, batch_size=100,  validation_split =0.05)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_xcc</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>

<span class="c1"># # 输出预测结果</span>
<span class="c1"># X_test = pd.read_csv(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;)</span>

<span class="c1"># # X_test处理</span>
<span class="c1"># X_test_list = []</span>
<span class="c1"># for item in X_test.values:</span>
<span class="c1">#   X_test_list.append([item[0]] + [float(i) for i in item[1].split(&#39;,&#39;)])</span>
<span class="c1"># X_test = pd.DataFrame(np.array(X_test_list))</span>
<span class="c1"># X_test.columns = [&#39;id&#39;] + [&#39;s_&#39; + str(i) for i in range(len(data_list[0])-2)]</span>
<span class="c1"># X_test = reduce_mem_usage(X_test)</span>

<span class="c1"># X_test = X_test.values.reshape((X_test.shape[0],X_test.shape[1],1))</span>
<span class="c1"># # y_preds_subm = model_xcc.predict_proba(X_test)</span>
<span class="c1"># y_preds_subm = model_xcc.predict_classes(X_test)</span>
<span class="c1"># y_preds_subm = onehot_encoder.fit_transform(y_preds_subm.reshape(len(y_preds_subm), 1))</span>
<span class="c1"># result=pd.read_csv(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/sample_submit.csv&#39;)</span>
<span class="c1"># result[&#39;label_0&#39;]=y_preds_subm[:,0]</span>
<span class="c1"># result[&#39;label_1&#39;]=y_preds_subm[:,1]</span>
<span class="c1"># result[&#39;label_2&#39;]=y_preds_subm[:,2]</span>
<span class="c1"># result[&#39;label_3&#39;]=y_preds_subm[:,3]</span>
<span class="c1"># result.to_csv(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/submit.csv&#39;,index=False)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition: 540
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.000001</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">model_xcc</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model_xcc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="n">validation_split</span> <span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">model_xcc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/LSTM_ECG_0429-128.h5&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
713/713 [==============================] - 13s 16ms/step - loss: 1.9431e-04 - accuracy: 1.0000 - val_loss: 0.0910 - val_accuracy: 0.9944
Epoch 2/5
713/713 [==============================] - 11s 16ms/step - loss: 8.3819e-05 - accuracy: 1.0000 - val_loss: 0.0910 - val_accuracy: 0.9944
Epoch 3/5
713/713 [==============================] - 12s 16ms/step - loss: 1.9583e-04 - accuracy: 1.0000 - val_loss: 0.0910 - val_accuracy: 0.9944
Epoch 4/5
713/713 [==============================] - 11s 16ms/step - loss: 5.2772e-05 - accuracy: 1.0000 - val_loss: 0.0910 - val_accuracy: 0.9944
Epoch 5/5
713/713 [==============================] - 11s 16ms/step - loss: 3.2438e-05 - accuracy: 1.0000 - val_loss: 0.0910 - val_accuracy: 0.9944
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="nb">sum</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="o">/</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.9892
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>


<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_xcc</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>


<span class="c1"># y_pred = model_xcc.predict_proba(X_val)</span>
<span class="c1"># # 调整预测结果</span>
<span class="c1"># data = y_pred</span>
<span class="c1"># for i in range(y_pred.shape[0]):</span>
<span class="c1">#   zeros_i_row = np.array([0,0,0,0])</span>
<span class="c1">#   for j in range(y_pred.shape[1]):</span>
<span class="c1">#     if data[i][j] &gt; 0.9:</span>
<span class="c1">#       zeros_i_row[j] = 1</span>
<span class="c1">#       data[i,:] = zeros_i_row</span>
<span class="c1"># print(data)</span>
<span class="c1"># np.savetxt(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/data.csv&#39;, data, delimiter = &#39;,&#39;)</span>
<span class="c1"># score_for_Competition = feval_abs_sum_1(data, y_val)</span>
<span class="c1"># print(&#39;score_for_Competition:&#39;,score_for_Competition)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition: 540
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CNN_1D">CNN_1D<a class="anchor-link" href="#CNN_1D">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
 
<span class="c1"># 导入模型前预处理</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_val</span> <span class="o">=</span> <span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
 
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_val</span><span class="p">),</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_val</span><span class="p">),</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;numpy.ndarray&#39;&gt; (75000, 205, 1)
&lt;class &#39;numpy.ndarray&#39;&gt; (25000, 205, 1)
&lt;class &#39;numpy.ndarray&#39;&gt; (75000, 1)
&lt;class &#39;numpy.ndarray&#39;&gt; (25000, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#%tensorflow_version 1.x   # 使用1.x版本的TF</span>
 
<span class="c1"># 用CNN做序列特征提取</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="k">import</span> <span class="n">loadmat</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.objectives</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
 
 
<span class="sd">&quot;&quot;&quot;GPU设置为按需增长&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tensorflow.compat.v1</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="c1"># from tensorflow.compat.v1 import ConfigProto</span>
<span class="kn">from</span> <span class="nn">tensorflow.compat.v1.keras.backend</span> <span class="k">import</span> <span class="n">set_session</span>
 
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="c1">#有多个GPU时可以指定只使用第几号GPU</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ConfigProto</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">allow_soft_placement</span><span class="o">=</span><span class="kc">True</span> <span class="c1">#允许动态放置张量和操作符</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">per_process_gpu_memory_fraction</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1">#最多使用40%GPU内存</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">allow_growth</span><span class="o">=</span><span class="kc">True</span>   <span class="c1">#初始化时不全部占满GPU显存, 按需分配 </span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">)</span>
<span class="n">set_session</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>
 
<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">K</span>
 
<span class="n">TIME_PERIODS</span> <span class="o">=</span> <span class="mi">205</span>
<span class="n">num_sensors</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">TIME_PERIODS</span><span class="p">,</span><span class="n">num_sensors</span><span class="p">),</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="c1"># model.add(Reshape((TIME_PERIODS, num_sensors), input_shape=input_shape))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">))</span> <span class="c1"># （batch_size，205，1）》》（batch_size, 200, 16)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">))</span>     <span class="c1"># （batch_size，200,16）》》（batch_size, 200, 16)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>                            <span class="c1"># （batch_size，200,16）》》（batch_size, 100, 16)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">))</span>      <span class="c1"># （batch_size，100,64）》》（batch_size, 100, 64)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">))</span>      <span class="c1"># （batch_size，100,64）》》（batch_size, 100, 64)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>                            <span class="c1"># （batch_size，100,64）》》（batch_size, 50, 64)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">))</span>      <span class="c1"># （batch_size，100,64）》》（batch_size, 100, 64)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">))</span>      <span class="c1"># （batch_size，100,64）》》（batch_size, 100, 64)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> 
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">GlobalAveragePooling1D</span><span class="p">())</span>                        <span class="c1"># （batch_size, 50, 64) 》》 （batch_size, 64)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>               <span class="c1"># （batch_size, 64) 》》 （batch_size, num_classes)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
 
<span class="n">K</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
<span class="n">model_CNN</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">TIME_PERIODS</span><span class="p">,</span><span class="n">num_sensors</span><span class="p">),</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">model_CNN</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model_CNN</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>  <span class="n">validation_split</span> <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 
<span class="c1"># model_CNN.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/CNN_ECG_0422_1.h5&#39;)</span>
 
<span class="c1"># 30步就可以达到0.98的f1值</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="c1"># path_model = &#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/CNN_ECG_0429_BN.h5&#39;</span>
<span class="c1"># model_CNN = load_model(path_model)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">model_CNN</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model_CNN</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>  <span class="n">validation_split</span> <span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>
<span class="c1"># 200 + -------</span>
<span class="c1"># model_CNN.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/CNN_ECG_0429_BN.h5&#39;)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/50
1875/1875 [==============================] - 19s 9ms/step - loss: 0.0312 - accuracy: 0.9904 - val_loss: 0.0422 - val_accuracy: 0.9885
Epoch 2/50
1875/1875 [==============================] - 17s 9ms/step - loss: 0.0308 - accuracy: 0.9911 - val_loss: 0.0422 - val_accuracy: 0.9881
Epoch 3/50
1875/1875 [==============================] - 17s 9ms/step - loss: 0.0295 - accuracy: 0.9913 - val_loss: 0.0423 - val_accuracy: 0.9888
Epoch 4/50
1875/1875 [==============================] - 17s 9ms/step - loss: 0.0311 - accuracy: 0.9908 - val_loss: 0.0422 - val_accuracy: 0.9883
Epoch 5/50
1875/1875 [==============================] - 17s 9ms/step - loss: 0.0311 - accuracy: 0.9912 - val_loss: 0.0423 - val_accuracy: 0.9887
Epoch 6/50
1875/1875 [==============================] - 17s 9ms/step - loss: 0.0286 - accuracy: 0.9922 - val_loss: 0.0422 - val_accuracy: 0.9887
Epoch 7/50
1875/1875 [==============================] - 17s 9ms/step - loss: 0.0307 - accuracy: 0.9912 - val_loss: 0.0422 - val_accuracy: 0.9887
Epoch 8/50
1399/1875 [=====================&gt;........] - ETA: 4s - loss: 0.0290 - accuracy: 0.9920</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-20-d92059d37264&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> optimizer <span class="ansi-blue-fg">=</span> keras<span class="ansi-blue-fg">.</span>optimizers<span class="ansi-blue-fg">.</span>Adam<span class="ansi-blue-fg">(</span>lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1e-9</span><span class="ansi-blue-fg">,</span> beta_1<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.9</span><span class="ansi-blue-fg">,</span> beta_2<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.99</span><span class="ansi-blue-fg">,</span> epsilon<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1e-08</span><span class="ansi-blue-fg">,</span> decay<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.0</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> model_CNN<span class="ansi-blue-fg">.</span>compile<span class="ansi-blue-fg">(</span>loss<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;sparse_categorical_crossentropy&#39;</span><span class="ansi-blue-fg">,</span> optimizer<span class="ansi-blue-fg">=</span>optimizer<span class="ansi-blue-fg">,</span> metrics<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;accuracy&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 7</span><span class="ansi-red-fg"> </span>history <span class="ansi-blue-fg">=</span> model_CNN<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>X_train<span class="ansi-blue-fg">,</span> y_train<span class="ansi-blue-fg">,</span> epochs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">,</span> batch_size<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">36</span><span class="ansi-blue-fg">,</span>  validation_split <span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.10</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> <span class="ansi-red-fg"># 200 + -------</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> <span class="ansi-red-fg"># model_CNN.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/CNN_ECG_0429_BN.h5&#39;)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/training.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)</span>
<span class="ansi-green-intense-fg ansi-bold">   1098</span>                 _r=1):
<span class="ansi-green-intense-fg ansi-bold">   1099</span>               callbacks<span class="ansi-blue-fg">.</span>on_train_batch_begin<span class="ansi-blue-fg">(</span>step<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1100</span><span class="ansi-red-fg">               </span>tmp_logs <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>train_function<span class="ansi-blue-fg">(</span>iterator<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1101</span>               <span class="ansi-green-fg">if</span> data_handler<span class="ansi-blue-fg">.</span>should_sync<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1102</span>                 context<span class="ansi-blue-fg">.</span>async_wait<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    826</span>     tracing_count <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>experimental_get_tracing_count<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    827</span>     <span class="ansi-green-fg">with</span> trace<span class="ansi-blue-fg">.</span>Trace<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> tm<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 828</span><span class="ansi-red-fg">       </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    829</span>       compiler <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#34;xla&#34;</span> <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_experimental_compile <span class="ansi-green-fg">else</span> <span class="ansi-blue-fg">&#34;nonXla&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    830</span>       new_tracing_count <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>experimental_get_tracing_count<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py</span> in <span class="ansi-cyan-fg">_call</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    853</span>       <span class="ansi-red-fg"># In this case we have created variables on the first call, so we run the</span>
<span class="ansi-green-intense-fg ansi-bold">    854</span>       <span class="ansi-red-fg"># defunned version which is guaranteed to never create variables.</span>
<span class="ansi-green-fg">--&gt; 855</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_stateless_fn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># pylint: disable=not-callable</span>
<span class="ansi-green-intense-fg ansi-bold">    856</span>     <span class="ansi-green-fg">elif</span> self<span class="ansi-blue-fg">.</span>_stateful_fn <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    857</span>       <span class="ansi-red-fg"># Release the lock early so that multiple threads can perform the call</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2941</span>        filtered_flat_args) = self._maybe_define_function(args, kwargs)
<span class="ansi-green-intense-fg ansi-bold">   2942</span>     return graph_function._call_flat(
<span class="ansi-green-fg">-&gt; 2943</span><span class="ansi-red-fg">         filtered_flat_args, captured_inputs=graph_function.captured_inputs)  # pylint: disable=protected-access
</span><span class="ansi-green-intense-fg ansi-bold">   2944</span> 
<span class="ansi-green-intense-fg ansi-bold">   2945</span>   <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py</span> in <span class="ansi-cyan-fg">_call_flat</span><span class="ansi-blue-fg">(self, args, captured_inputs, cancellation_manager)</span>
<span class="ansi-green-intense-fg ansi-bold">   1917</span>       <span class="ansi-red-fg"># No tape is watching; skip to running the function.</span>
<span class="ansi-green-intense-fg ansi-bold">   1918</span>       return self._build_call_outputs(self._inference_function.call(
<span class="ansi-green-fg">-&gt; 1919</span><span class="ansi-red-fg">           ctx, args, cancellation_manager=cancellation_manager))
</span><span class="ansi-green-intense-fg ansi-bold">   1920</span>     forward_backward = self._select_forward_and_backward_functions(
<span class="ansi-green-intense-fg ansi-bold">   1921</span>         args<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, ctx, args, cancellation_manager)</span>
<span class="ansi-green-intense-fg ansi-bold">    558</span>               inputs<span class="ansi-blue-fg">=</span>args<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    559</span>               attrs<span class="ansi-blue-fg">=</span>attrs<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 560</span><span class="ansi-red-fg">               ctx=ctx)
</span><span class="ansi-green-intense-fg ansi-bold">    561</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    562</span>           outputs = execute.execute_with_cancellation(

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/execute.py</span> in <span class="ansi-cyan-fg">quick_execute</span><span class="ansi-blue-fg">(op_name, num_outputs, inputs, attrs, ctx, name)</span>
<span class="ansi-green-intense-fg ansi-bold">     58</span>     ctx<span class="ansi-blue-fg">.</span>ensure_initialized<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     59</span>     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
<span class="ansi-green-fg">---&gt; 60</span><span class="ansi-red-fg">                                         inputs, attrs, num_outputs)
</span><span class="ansi-green-intense-fg ansi-bold">     61</span>   <span class="ansi-green-fg">except</span> core<span class="ansi-blue-fg">.</span>_NotOkStatusException <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     62</span>     <span class="ansi-green-fg">if</span> name <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>
<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="c1"># model_CNN = load_model(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/CNN_ECG_0429.h5&#39;)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_CNN</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>  <span class="c1"># 亦可用predict_proba函数得到各类别的预测概率（PS：不需要转换为OneHot code)</span>
<span class="c1"># print(y_pred)</span>
<span class="c1"># print(y_val)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>


<span class="c1"># 以该CNN_1D结构计算30步后得到score_for_Competition为904，明显次于lightGBM的531.2， 记录于2021/04/22/01:03，模型名称: CNN_ECG_0422.h5</span>
<span class="c1"># 以该CNN_1D结构计算30步后得到score_for_Competition为634，次于lightGBM的531.2， 记录于2021/04/22/03:47，模型名称: CNN_ECG_0422_1.h5</span>
<span class="c1"># 以该CNN_1D结构计算200步后得到score_for_Competition为576，次于lightGBM的531.2， 记录于2021/04/27/23:47，模型名称: CNN_ECG_0427.h5</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition: 486
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conv-LSTM">Conv-LSTM<a class="anchor-link" href="#Conv-LSTM">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入模型前预处理</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_val</span> <span class="o">=</span> <span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
 
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_val</span><span class="p">),</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_val</span><span class="p">),</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-5-f57fa7dfd208&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># 导入模型前预处理</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>X_train <span class="ansi-blue-fg">=</span> X_train<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>X_train<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>X_train<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> X_val <span class="ansi-blue-fg">=</span> X_val<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>X_val<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>X_val<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> y_train <span class="ansi-blue-fg">=</span> y_train<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>y_train<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> y_val <span class="ansi-blue-fg">=</span> y_val<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>y_val<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: &#39;numpy.ndarray&#39; object has no attribute &#39;values&#39;</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 用Conv-LSTM建模预测</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="k">import</span> <span class="n">loadmat</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.objectives</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="k">import</span> <span class="n">ConvLSTM2D</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
 
<span class="sd">&quot;&quot;&quot;GPU设置为按需增长&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tensorflow.compat.v1</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="c1"># from tensorflow.compat.v1 import ConfigProto</span>
<span class="kn">from</span> <span class="nn">tensorflow.compat.v1.keras.backend</span> <span class="k">import</span> <span class="n">set_session</span>
 
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="c1">#有多个GPU时可以指定只使用第几号GPU</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ConfigProto</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">allow_soft_placement</span><span class="o">=</span><span class="kc">True</span> <span class="c1">#允许动态放置张量和操作符</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">per_process_gpu_memory_fraction</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1">#最多使用40%GPU内存</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">allow_growth</span><span class="o">=</span><span class="kc">True</span>   <span class="c1">#初始化时不全部占满GPU显存, 按需分配 </span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">)</span>
<span class="n">set_session</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>
 
 
 
<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>
 
<span class="c1"># reshape input from 3dims to 5dims</span>
<span class="n">n_timesteps</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># 因为y_train的元素是数值型（稀疏标签），不是OneHotCode型</span>
<span class="n">n_steps</span><span class="p">,</span> <span class="n">n_length</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">41</span>  <span class="c1"># 设置子序列个数和长度</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
 
 
<span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_outputs</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ConvLSTM2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="c1"># model.add(ConvLSTM2D(filters=32, kernel_size=(1,3), activation=&#39;relu&#39;, input_shape=(n_steps, 1, n_length, n_features)))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_outputs</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">model</span>
 
<span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_outputs</span><span class="p">)</span>
 
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># model.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/Conv-LSTM_ECG_0422.h5&#39;)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>  <span class="c1"># 亦可用predict_proba函数得到各类别的预测概率（PS：不需要转换为OneHot code)</span>
 
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
 
<span class="c1"># 以该Conv-LSTM结构计算50步后得到score_for_Competition为600，略次于lightGBM的531.2， 记录于2021/04/22/21:37，模型名称: Conv-LSTM_ECG_0422.h5</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
713/713 - 25s - loss: 0.2056 - accuracy: 0.9372 - val_loss: 0.3221 - val_accuracy: 0.9096
Epoch 2/100
713/713 - 23s - loss: 0.0976 - accuracy: 0.9706 - val_loss: 0.0866 - val_accuracy: 0.9723
Epoch 3/100
713/713 - 23s - loss: 0.0763 - accuracy: 0.9766 - val_loss: 0.1051 - val_accuracy: 0.9619
Epoch 4/100
713/713 - 23s - loss: 0.0614 - accuracy: 0.9806 - val_loss: 0.0910 - val_accuracy: 0.9731
Epoch 5/100
713/713 - 23s - loss: 0.0501 - accuracy: 0.9841 - val_loss: 0.0645 - val_accuracy: 0.9792
Epoch 6/100
713/713 - 23s - loss: 0.0449 - accuracy: 0.9859 - val_loss: 0.0696 - val_accuracy: 0.9789
Epoch 7/100
713/713 - 23s - loss: 0.0392 - accuracy: 0.9874 - val_loss: 0.0746 - val_accuracy: 0.9765
Epoch 8/100
713/713 - 23s - loss: 0.0348 - accuracy: 0.9885 - val_loss: 0.0641 - val_accuracy: 0.9827
Epoch 9/100
713/713 - 23s - loss: 0.0323 - accuracy: 0.9892 - val_loss: 0.0878 - val_accuracy: 0.9723
Epoch 10/100
713/713 - 23s - loss: 0.0272 - accuracy: 0.9911 - val_loss: 0.1645 - val_accuracy: 0.9536
Epoch 11/100
713/713 - 23s - loss: 0.0242 - accuracy: 0.9920 - val_loss: 0.0771 - val_accuracy: 0.9795
Epoch 12/100
713/713 - 23s - loss: 0.0230 - accuracy: 0.9924 - val_loss: 0.1305 - val_accuracy: 0.9597
Epoch 13/100
713/713 - 23s - loss: 0.0219 - accuracy: 0.9926 - val_loss: 0.0610 - val_accuracy: 0.9832
Epoch 14/100
713/713 - 23s - loss: 0.0197 - accuracy: 0.9932 - val_loss: 0.0705 - val_accuracy: 0.9824
Epoch 15/100
713/713 - 23s - loss: 0.0177 - accuracy: 0.9937 - val_loss: 0.0733 - val_accuracy: 0.9808
Epoch 16/100
713/713 - 23s - loss: 0.0153 - accuracy: 0.9947 - val_loss: 0.0797 - val_accuracy: 0.9819
Epoch 17/100
713/713 - 23s - loss: 0.0167 - accuracy: 0.9947 - val_loss: 0.0682 - val_accuracy: 0.9864
Epoch 18/100
713/713 - 23s - loss: 0.0144 - accuracy: 0.9951 - val_loss: 0.0723 - val_accuracy: 0.9821
Epoch 19/100
713/713 - 23s - loss: 0.0158 - accuracy: 0.9946 - val_loss: 0.0583 - val_accuracy: 0.9867
Epoch 20/100
713/713 - 23s - loss: 0.0137 - accuracy: 0.9955 - val_loss: 0.0532 - val_accuracy: 0.9877
Epoch 21/100
713/713 - 23s - loss: 0.0099 - accuracy: 0.9966 - val_loss: 0.0834 - val_accuracy: 0.9803
Epoch 22/100
713/713 - 23s - loss: 0.0131 - accuracy: 0.9953 - val_loss: 0.0781 - val_accuracy: 0.9819
Epoch 23/100
713/713 - 23s - loss: 0.0105 - accuracy: 0.9962 - val_loss: 0.0620 - val_accuracy: 0.9864
Epoch 24/100
713/713 - 23s - loss: 0.0115 - accuracy: 0.9962 - val_loss: 0.0623 - val_accuracy: 0.9859
Epoch 25/100
713/713 - 23s - loss: 0.0101 - accuracy: 0.9968 - val_loss: 0.0982 - val_accuracy: 0.9821
Epoch 26/100
713/713 - 23s - loss: 0.0086 - accuracy: 0.9970 - val_loss: 0.0691 - val_accuracy: 0.9877
Epoch 27/100
713/713 - 23s - loss: 0.0074 - accuracy: 0.9976 - val_loss: 0.0735 - val_accuracy: 0.9835
Epoch 28/100
713/713 - 23s - loss: 0.0106 - accuracy: 0.9964 - val_loss: 0.0603 - val_accuracy: 0.9877
Epoch 29/100
713/713 - 23s - loss: 0.0086 - accuracy: 0.9973 - val_loss: 0.0712 - val_accuracy: 0.9883
Epoch 30/100
713/713 - 23s - loss: 0.0073 - accuracy: 0.9974 - val_loss: 0.0653 - val_accuracy: 0.9891
Epoch 31/100
713/713 - 23s - loss: 0.0088 - accuracy: 0.9972 - val_loss: 0.0822 - val_accuracy: 0.9861
Epoch 32/100
713/713 - 23s - loss: 0.0079 - accuracy: 0.9976 - val_loss: 0.0832 - val_accuracy: 0.9851
Epoch 33/100
713/713 - 23s - loss: 0.0076 - accuracy: 0.9976 - val_loss: 0.0682 - val_accuracy: 0.9893
Epoch 34/100
713/713 - 23s - loss: 0.0065 - accuracy: 0.9979 - val_loss: 0.0627 - val_accuracy: 0.9880
Epoch 35/100
713/713 - 23s - loss: 0.0069 - accuracy: 0.9978 - val_loss: 0.0800 - val_accuracy: 0.9883
Epoch 36/100
713/713 - 23s - loss: 0.0063 - accuracy: 0.9978 - val_loss: 0.0883 - val_accuracy: 0.9869
Epoch 37/100
713/713 - 23s - loss: 0.0072 - accuracy: 0.9977 - val_loss: 0.0816 - val_accuracy: 0.9896
Epoch 38/100
713/713 - 23s - loss: 0.0080 - accuracy: 0.9976 - val_loss: 0.0832 - val_accuracy: 0.9875
Epoch 39/100
713/713 - 23s - loss: 0.0084 - accuracy: 0.9971 - val_loss: 0.0877 - val_accuracy: 0.9867
Epoch 40/100
713/713 - 23s - loss: 0.0056 - accuracy: 0.9982 - val_loss: 0.0694 - val_accuracy: 0.9875
Epoch 41/100
713/713 - 23s - loss: 0.0049 - accuracy: 0.9983 - val_loss: 0.0843 - val_accuracy: 0.9877
Epoch 42/100
713/713 - 23s - loss: 0.0079 - accuracy: 0.9976 - val_loss: 0.0738 - val_accuracy: 0.9891
Epoch 43/100
713/713 - 23s - loss: 0.0060 - accuracy: 0.9980 - val_loss: 0.0682 - val_accuracy: 0.9885
Epoch 44/100
713/713 - 23s - loss: 0.0049 - accuracy: 0.9987 - val_loss: 0.0859 - val_accuracy: 0.9853
Epoch 45/100
713/713 - 23s - loss: 0.0078 - accuracy: 0.9976 - val_loss: 0.0737 - val_accuracy: 0.9869
Epoch 46/100
713/713 - 23s - loss: 0.0042 - accuracy: 0.9987 - val_loss: 0.0838 - val_accuracy: 0.9859
Epoch 47/100
713/713 - 23s - loss: 0.0048 - accuracy: 0.9986 - val_loss: 0.0838 - val_accuracy: 0.9875
Epoch 48/100
713/713 - 23s - loss: 0.0055 - accuracy: 0.9983 - val_loss: 0.0803 - val_accuracy: 0.9888
Epoch 49/100
713/713 - 23s - loss: 0.0052 - accuracy: 0.9982 - val_loss: 0.0893 - val_accuracy: 0.9864
Epoch 50/100
713/713 - 23s - loss: 0.0053 - accuracy: 0.9987 - val_loss: 0.0871 - val_accuracy: 0.9880
Epoch 51/100
713/713 - 23s - loss: 0.0052 - accuracy: 0.9987 - val_loss: 0.0940 - val_accuracy: 0.9869
Epoch 52/100
713/713 - 23s - loss: 0.0042 - accuracy: 0.9988 - val_loss: 0.0869 - val_accuracy: 0.9888
Epoch 53/100
713/713 - 23s - loss: 0.0054 - accuracy: 0.9985 - val_loss: 0.0993 - val_accuracy: 0.9875
Epoch 54/100
713/713 - 23s - loss: 0.0048 - accuracy: 0.9985 - val_loss: 0.1028 - val_accuracy: 0.9877
Epoch 55/100
713/713 - 23s - loss: 0.0053 - accuracy: 0.9986 - val_loss: 0.0725 - val_accuracy: 0.9904
Epoch 56/100
713/713 - 23s - loss: 0.0055 - accuracy: 0.9985 - val_loss: 0.1018 - val_accuracy: 0.9891
Epoch 57/100
713/713 - 23s - loss: 0.0038 - accuracy: 0.9988 - val_loss: 0.0739 - val_accuracy: 0.9896
Epoch 58/100
713/713 - 23s - loss: 0.0051 - accuracy: 0.9987 - val_loss: 0.0901 - val_accuracy: 0.9885
Epoch 59/100
713/713 - 23s - loss: 0.0052 - accuracy: 0.9987 - val_loss: 0.0821 - val_accuracy: 0.9872
Epoch 60/100
713/713 - 23s - loss: 0.0041 - accuracy: 0.9986 - val_loss: 0.1114 - val_accuracy: 0.9869
Epoch 61/100
713/713 - 23s - loss: 0.0061 - accuracy: 0.9984 - val_loss: 0.0987 - val_accuracy: 0.9864
Epoch 62/100
713/713 - 23s - loss: 0.0033 - accuracy: 0.9989 - val_loss: 0.0960 - val_accuracy: 0.9856
Epoch 63/100
713/713 - 23s - loss: 0.0053 - accuracy: 0.9986 - val_loss: 0.1030 - val_accuracy: 0.9883
Epoch 64/100
713/713 - 22s - loss: 0.0038 - accuracy: 0.9989 - val_loss: 0.1035 - val_accuracy: 0.9875
Epoch 65/100
713/713 - 23s - loss: 0.0030 - accuracy: 0.9991 - val_loss: 0.0990 - val_accuracy: 0.9872
Epoch 66/100
713/713 - 23s - loss: 0.0048 - accuracy: 0.9985 - val_loss: 0.0856 - val_accuracy: 0.9888
Epoch 67/100
713/713 - 23s - loss: 0.0029 - accuracy: 0.9991 - val_loss: 0.0856 - val_accuracy: 0.9880
Epoch 68/100
713/713 - 23s - loss: 0.0038 - accuracy: 0.9988 - val_loss: 0.0802 - val_accuracy: 0.9883
Epoch 69/100
713/713 - 23s - loss: 0.0031 - accuracy: 0.9991 - val_loss: 0.1133 - val_accuracy: 0.9856
Epoch 70/100
713/713 - 23s - loss: 0.0064 - accuracy: 0.9980 - val_loss: 0.0769 - val_accuracy: 0.9880
Epoch 71/100
713/713 - 23s - loss: 0.0023 - accuracy: 0.9994 - val_loss: 0.1170 - val_accuracy: 0.9891
Epoch 72/100
713/713 - 23s - loss: 0.0047 - accuracy: 0.9987 - val_loss: 0.0989 - val_accuracy: 0.9869
Epoch 73/100
713/713 - 23s - loss: 0.0058 - accuracy: 0.9983 - val_loss: 0.0869 - val_accuracy: 0.9880
Epoch 74/100
713/713 - 23s - loss: 0.0036 - accuracy: 0.9992 - val_loss: 0.0974 - val_accuracy: 0.9891
Epoch 75/100
713/713 - 23s - loss: 0.0021 - accuracy: 0.9994 - val_loss: 0.1108 - val_accuracy: 0.9891
Epoch 76/100
713/713 - 23s - loss: 0.0038 - accuracy: 0.9988 - val_loss: 0.1286 - val_accuracy: 0.9880
Epoch 77/100
713/713 - 23s - loss: 0.0044 - accuracy: 0.9988 - val_loss: 0.1235 - val_accuracy: 0.9864
Epoch 78/100
713/713 - 23s - loss: 0.0059 - accuracy: 0.9985 - val_loss: 0.1001 - val_accuracy: 0.9885
Epoch 79/100
713/713 - 23s - loss: 0.0034 - accuracy: 0.9990 - val_loss: 0.1096 - val_accuracy: 0.9880
Epoch 80/100
713/713 - 23s - loss: 0.0019 - accuracy: 0.9994 - val_loss: 0.0989 - val_accuracy: 0.9896
Epoch 81/100
713/713 - 23s - loss: 0.0050 - accuracy: 0.9985 - val_loss: 0.1207 - val_accuracy: 0.9867
Epoch 82/100
713/713 - 23s - loss: 0.0020 - accuracy: 0.9995 - val_loss: 0.0936 - val_accuracy: 0.9891
Epoch 83/100
713/713 - 23s - loss: 0.0045 - accuracy: 0.9988 - val_loss: 0.1361 - val_accuracy: 0.9875
Epoch 84/100
713/713 - 23s - loss: 0.0036 - accuracy: 0.9989 - val_loss: 0.0946 - val_accuracy: 0.9901
Epoch 85/100
713/713 - 23s - loss: 0.0028 - accuracy: 0.9991 - val_loss: 0.1103 - val_accuracy: 0.9875
Epoch 86/100
713/713 - 23s - loss: 0.0045 - accuracy: 0.9989 - val_loss: 0.1093 - val_accuracy: 0.9883
Epoch 87/100
713/713 - 23s - loss: 0.0043 - accuracy: 0.9989 - val_loss: 0.1285 - val_accuracy: 0.9877
Epoch 88/100
713/713 - 23s - loss: 0.0032 - accuracy: 0.9990 - val_loss: 0.1032 - val_accuracy: 0.9883
Epoch 89/100
713/713 - 23s - loss: 0.0034 - accuracy: 0.9991 - val_loss: 0.1167 - val_accuracy: 0.9885
Epoch 90/100
713/713 - 23s - loss: 0.0026 - accuracy: 0.9993 - val_loss: 0.0859 - val_accuracy: 0.9883
Epoch 91/100
713/713 - 23s - loss: 0.0032 - accuracy: 0.9992 - val_loss: 0.1111 - val_accuracy: 0.9877
Epoch 92/100
713/713 - 23s - loss: 0.0051 - accuracy: 0.9988 - val_loss: 0.1375 - val_accuracy: 0.9872
Epoch 93/100
713/713 - 23s - loss: 0.0030 - accuracy: 0.9992 - val_loss: 0.1013 - val_accuracy: 0.9893
Epoch 94/100
713/713 - 23s - loss: 0.0012 - accuracy: 0.9996 - val_loss: 0.0894 - val_accuracy: 0.9899
Epoch 95/100
713/713 - 23s - loss: 0.0043 - accuracy: 0.9989 - val_loss: 0.0902 - val_accuracy: 0.9877
Epoch 96/100
713/713 - 23s - loss: 0.0042 - accuracy: 0.9988 - val_loss: 0.0895 - val_accuracy: 0.9883
Epoch 97/100
713/713 - 23s - loss: 0.0028 - accuracy: 0.9993 - val_loss: 0.1249 - val_accuracy: 0.9877
Epoch 98/100
713/713 - 23s - loss: 0.0019 - accuracy: 0.9994 - val_loss: 0.1478 - val_accuracy: 0.9856
Epoch 99/100
713/713 - 23s - loss: 0.0044 - accuracy: 0.9989 - val_loss: 0.1097 - val_accuracy: 0.9880
Epoch 100/100
713/713 - 23s - loss: 0.0033 - accuracy: 0.9990 - val_loss: 0.1173 - val_accuracy: 0.9864
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition: 542
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&quot;&quot;&quot;GPU设置为按需增长&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tensorflow.compat.v1</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="c1"># from tensorflow.compat.v1 import ConfigProto</span>
<span class="kn">from</span> <span class="nn">tensorflow.compat.v1.keras.backend</span> <span class="k">import</span> <span class="n">set_session</span>
 
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="c1">#有多个GPU时可以指定只使用第几号GPU</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ConfigProto</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">allow_soft_placement</span><span class="o">=</span><span class="kc">True</span> <span class="c1">#允许动态放置张量和操作符</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">per_process_gpu_memory_fraction</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1">#最多使用40%GPU内存</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">allow_growth</span><span class="o">=</span><span class="kc">True</span>   <span class="c1">#初始化时不全部占满GPU显存, 按需分配 </span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">)</span>
<span class="n">set_session</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>
 
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="c1"># path_model = &#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/Conv-LSTM_ECG_0429.h5&#39;</span>
<span class="c1"># model_CNN = load_model(path_model)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">validation_split</span> <span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># 30 + 20 + 50 + 50 + 50</span>
<span class="c1"># model.save(&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/Conv-LSTM_ECG_0429.h5&#39;)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>  <span class="c1"># 亦可用predict_proba函数得到各类别的预测概率（PS：不需要转换为OneHot code)</span>
 
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1980/1980 - 59s - loss: 0.0029 - accuracy: 0.9990 - val_loss: 3.2717e-04 - val_accuracy: 1.0000
Epoch 2/5
1980/1980 - 57s - loss: 0.0012 - accuracy: 0.9996 - val_loss: 6.8307e-04 - val_accuracy: 0.9997
Epoch 3/5
1980/1980 - 56s - loss: 8.2553e-04 - accuracy: 0.9997 - val_loss: 3.1602e-04 - val_accuracy: 1.0000
Epoch 4/5
1980/1980 - 55s - loss: 4.3734e-04 - accuracy: 0.9999 - val_loss: 0.0012 - val_accuracy: 0.9997
Epoch 5/5
1980/1980 - 56s - loss: 4.9860e-04 - accuracy: 0.9998 - val_loss: 3.1975e-04 - val_accuracy: 0.9997
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition: 498
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="k">import</span> <span class="n">loadmat</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">keras.objectives</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="k">import</span> <span class="n">ConvLSTM2D</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>

<span class="c1"># reshape input from 3dims to 5dims</span>
<span class="n">n_timesteps</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_outputs</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_steps</span><span class="p">,</span> <span class="n">n_length</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">41</span>  <span class="c1"># 设置子序列个数和长度</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_length</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>

<span class="c1"># model_path = &#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/Conv-LSTM_ECG_0428.h5&#39;</span>

<span class="c1"># model_xcc = load_model(model_path)</span>

<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition: 590
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="RF">RF<a class="anchor-link" href="#RF">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span><span class="n">RandomForestRegressor</span>
<span class="k">def</span> <span class="nf">build_model_rf</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="c1"># 赛制评分标准</span>
<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  
  <span class="c1"># preds = np.argmax(preds.reshape(4,-1),axis=0)</span>
  <span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">labels_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">preds_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">labels_</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">preds_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">labels_</span> <span class="o">-</span> <span class="n">preds_</span><span class="p">)))</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="c1"># 单模/弱分类器训练（不含调参）</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predict rf...&#39;</span><span class="p">)</span>
<span class="n">model_rf</span> <span class="o">=</span> <span class="n">build_model_rf</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">val_rf</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>   <span class="c1"># 准确来说，该处为验证环节</span>
<span class="c1"># subA_rf = model_rf.predict(X_test)  # 针对testA.csv文件，是测试环节</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">val_rf</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>  <span class="c1"># 注意区分y_true和y_val</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition of RF:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>

<span class="c1"># 保存模型</span>
<span class="kn">from</span> <span class="nn">sklearn.externals</span> <span class="k">import</span> <span class="n">joblib</span>
<span class="c1"># joblib.dump(model_rf,&quot;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/RF_ECG_0424.pkl&quot;)</span>

<span class="c1">#2.加载模型</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;classification.pkl&#39;</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">predict rf...</span>
<span class="sd">(30000, 4) </span>
<span class="sd">(30000, 4)</span>
<span class="sd">score_for_Competition of RF: 1162.0</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  
  <span class="c1"># preds = np.argmax(preds.reshape(4,-1),axis=0)</span>
  <span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">labels_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">preds_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">labels_</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">preds_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">labels_</span> <span class="o">-</span> <span class="n">preds_</span><span class="p">)))</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>


<span class="c1"># 加载模型</span>
<span class="kn">from</span> <span class="nn">sklearn.externals</span> <span class="k">import</span> <span class="n">joblib</span>
<span class="n">model_rf</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/RF_ECG_0424.pkl&quot;</span><span class="p">)</span>

<span class="n">val_rf</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>   <span class="c1"># 准确来说，该处为验证环节</span>
<span class="c1"># subA_rf = model_rf.predict(X_test)  # 针对testA.csv文件，是测试环节</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">val_rf</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>  <span class="c1"># 注意区分y_true和y_val</span>
<span class="nb">print</span><span class="p">(</span><span class="n">score_for_Competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(25000, 4) 
 (25000, 4)
220.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#27169;&#22411;&#34701;&#21512;">&#27169;&#22411;&#34701;&#21512;<a class="anchor-link" href="#&#27169;&#22411;&#34701;&#21512;">&#182;</a></h2><p>首先，基于理论知识和经验，lightGBM和RF都是树模型，做模型融合似乎意义不大，且在各大机器学习赛事中lightGBM以超高的频次刷榜。考虑到Conv1D和LSTM均取得了显著效果，因此考虑lightGBM与这两种模型进行融合：（模型融合之前需要先将各个单模调至最优）</p>
<p>① lightGBM + Conv1D</p>
<p>② lightGBM + LSTM</p>
<p>③ lightGBM + Conv1D + LSTM</p>
<p><em>-------准备工作-------</em></p>
<p>① 评估模型得分与预测结果的差异，目的是挑选出得分相近结果分化的模型组合，方便施加“结果融合”。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Voting&#32467;&#26524;&#34701;&#21512;">Voting&#32467;&#26524;&#34701;&#21512;<a class="anchor-link" href="#Voting&#32467;&#26524;&#34701;&#21512;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="nn">sklearn.externals</span> <span class="k">import</span> <span class="n">joblib</span>

<span class="k">def</span> <span class="nf">Different_of_preds</span><span class="p">(</span><span class="n">model_1</span><span class="p">,</span> <span class="n">model_2</span><span class="p">,</span> <span class="n">model_3</span><span class="p">,</span> <span class="n">model_4</span><span class="p">,</span> <span class="n">model_5</span><span class="p">):</span>
  <span class="n">pred_1</span> <span class="o">=</span> <span class="n">model_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
  <span class="n">pred_2</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">pred_3</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">pred_4</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
  <span class="n">pred_5</span> <span class="o">=</span> <span class="n">model_5</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
  <span class="c1"># 两两对照比较差异</span>
  <span class="n">different_1_2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_1</span> <span class="o">-</span> <span class="n">pred_2</span><span class="p">)))</span>
  <span class="n">different_1_3</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_1</span> <span class="o">-</span> <span class="n">pred_3</span><span class="p">)))</span>
  <span class="n">different_1_4</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_1</span> <span class="o">-</span> <span class="n">pred_4</span><span class="p">)))</span>
  <span class="n">different_1_5</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_1</span> <span class="o">-</span> <span class="n">pred_5</span><span class="p">)))</span>
  <span class="n">different_2_3</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_2</span> <span class="o">-</span> <span class="n">pred_3</span><span class="p">)))</span>
  <span class="n">different_2_4</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_2</span> <span class="o">-</span> <span class="n">pred_4</span><span class="p">)))</span>
  <span class="n">different_2_5</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_2</span> <span class="o">-</span> <span class="n">pred_5</span><span class="p">)))</span>
  <span class="n">different_3_4</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_3</span> <span class="o">-</span> <span class="n">pred_4</span><span class="p">)))</span>
  <span class="n">different_3_5</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_3</span> <span class="o">-</span> <span class="n">pred_5</span><span class="p">)))</span>
  <span class="n">different_4_5</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_4</span> <span class="o">-</span> <span class="n">pred_5</span><span class="p">)))</span>
  
  <span class="n">Result_Different_of_preds</span> <span class="o">=</span> <span class="p">[</span><span class="n">different_1_2</span><span class="p">,</span> <span class="n">different_1_3</span><span class="p">,</span> <span class="n">different_1_4</span><span class="p">,</span> <span class="n">different_1_5</span><span class="p">,</span> \
                  <span class="n">different_2_3</span><span class="p">,</span> <span class="n">different_2_4</span><span class="p">,</span> <span class="n">different_2_5</span><span class="p">,</span> <span class="n">different_3_4</span><span class="p">,</span> \
                  <span class="n">different_3_5</span><span class="p">,</span> <span class="n">different_4_5</span><span class="p">]</span>
  <span class="n">Result_preds</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred_1</span><span class="p">,</span> <span class="n">pred_2</span><span class="p">,</span> <span class="n">pred_3</span><span class="p">,</span> <span class="n">pred_4</span><span class="p">,</span> <span class="n">pred_5</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">Result_Different_of_preds</span><span class="p">,</span> <span class="n">Result_preds</span>

<span class="n">root_path_model</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/&#39;</span>
<span class="n">path_model</span> <span class="o">=</span> <span class="p">[</span><span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;LightGBM_ECG.txt&#39;</span><span class="p">,</span>   <span class="c1"># 531.2</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;LSTM_ECG_0424-128.h5&#39;</span><span class="p">,</span>  <span class="c1"># 446</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;CNN_ECG_0427_1.h5&#39;</span><span class="p">,</span>   <span class="c1"># 634</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;Conv-LSTM_ECG_0422.h5&#39;</span><span class="p">,</span>  <span class="c1"># 600</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;RF_ECG_0424.pkl&#39;</span>     <span class="c1"># 994</span>
        <span class="p">]</span>
<span class="n">model_1</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Booster</span><span class="p">(</span><span class="n">model_file</span><span class="o">=</span><span class="n">path_model</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">model_2</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">model_3</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">model_4</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">model_5</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

<span class="n">Result_Different_of_preds</span><span class="p">,</span> <span class="n">Result_preds</span> <span class="o">=</span>  <span class="n">Different_of_preds</span><span class="p">(</span><span class="n">model_1</span><span class="p">,</span> <span class="n">model_2</span><span class="p">,</span> <span class="n">model_3</span><span class="p">,</span> <span class="n">model_4</span><span class="p">,</span> <span class="n">model_5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:425: UserWarning: `model.predict_proba()` is deprecated and will be removed after 2021-01-01. Please use `model.predict()` instead.
  warnings.warn(&#39;`model.predict_proba()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-71-bc47c00ed0d0&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span> model_5 <span class="ansi-blue-fg">=</span> joblib<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span>path_model<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     39</span> 
<span class="ansi-green-fg">---&gt; 40</span><span class="ansi-red-fg"> </span>Result_Different_of_preds<span class="ansi-blue-fg">,</span> Result_preds <span class="ansi-blue-fg">=</span>  Different_of_preds<span class="ansi-blue-fg">(</span>model_1<span class="ansi-blue-fg">,</span> model_2<span class="ansi-blue-fg">,</span> model_3<span class="ansi-blue-fg">,</span> model_4<span class="ansi-blue-fg">,</span> model_5<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-71-bc47c00ed0d0&gt;</span> in <span class="ansi-cyan-fg">Different_of_preds</span><span class="ansi-blue-fg">(model_1, model_2, model_3, model_4, model_5)</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span>   pred_5 <span class="ansi-blue-fg">=</span> model_5<span class="ansi-blue-fg">.</span>predict_proba<span class="ansi-blue-fg">(</span>X_val<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>   <span class="ansi-red-fg"># 两两对照比较差异</span>
<span class="ansi-green-fg">---&gt; 12</span><span class="ansi-red-fg">   </span>different_1_2 <span class="ansi-blue-fg">=</span> sum<span class="ansi-blue-fg">(</span>sum<span class="ansi-blue-fg">(</span>abs<span class="ansi-blue-fg">(</span>pred_1 <span class="ansi-blue-fg">-</span> pred_2<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>   different_1_3 <span class="ansi-blue-fg">=</span> sum<span class="ansi-blue-fg">(</span>sum<span class="ansi-blue-fg">(</span>abs<span class="ansi-blue-fg">(</span>pred_1 <span class="ansi-blue-fg">-</span> pred_3<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>   different_1_4 <span class="ansi-blue-fg">=</span> sum<span class="ansi-blue-fg">(</span>sum<span class="ansi-blue-fg">(</span>abs<span class="ansi-blue-fg">(</span>pred_1 <span class="ansi-blue-fg">-</span> pred_4<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: &#39;int&#39; object is not callable</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Result_Different_of_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[484.37289277862794, 617.7208580975662, 567.846786585735, 1327.0504731352892, 523.1990756988525, 420.26441383361816, 1480.5633889219894, 615.8993053436279, 1503.3095344112648, 1541.931601877929]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Result_preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[array([[9.99821361e-01, 4.11225380e-05, 1.34671616e-04, 2.84512583e-06],
        [9.99645571e-01, 1.28558224e-04, 2.17902417e-04, 7.96793342e-06],
        [9.99606834e-01, 2.91000079e-04, 1.75787175e-05, 8.45876689e-05],
        ...,
        [9.99907327e-01, 3.21730720e-05, 5.11588748e-05, 9.34077182e-06],
        [9.99761423e-01, 2.12355551e-04, 1.58495158e-05, 1.03720650e-05],
        [9.99957827e-01, 8.98652523e-06, 2.78226537e-05, 5.36374421e-06]]),
 array([[9.99918103e-01, 5.84226800e-05, 2.31177146e-05, 3.81509238e-07],
        [9.99843001e-01, 1.28381012e-04, 2.80892637e-05, 5.54846736e-07],
        [9.99998093e-01, 1.09249140e-06, 6.81527126e-07, 1.02731164e-07],
        ...,
        [9.99987841e-01, 1.07461237e-05, 1.42397175e-06, 1.05139764e-08],
        [9.99739587e-01, 2.59416323e-04, 8.40757707e-07, 8.17772730e-08],
        [9.99988675e-01, 8.29538021e-06, 2.37323707e-06, 5.76691662e-07]],
       dtype=float32),
 array([[9.9999964e-01, 3.3001587e-07, 4.2189119e-14, 4.3040348e-29],
        [9.9999976e-01, 1.8177232e-07, 4.0362446e-19, 1.4540193e-31],
        [9.9999976e-01, 2.0702981e-07, 2.7606345e-23, 1.0114862e-23],
        ...,
        [9.9934179e-01, 6.5814552e-04, 7.3079438e-11, 1.1492325e-20],
        [1.0000000e+00, 4.9264587e-10, 3.8581268e-22, 1.2543110e-28],
        [9.9994981e-01, 4.9960287e-05, 2.1286399e-07, 1.5941677e-19]],
       dtype=float32),
 array([[9.9997652e-01, 2.5103657e-06, 2.0925012e-05, 5.4484477e-23],
        [9.9999988e-01, 1.3565247e-07, 1.6134620e-11, 8.7275907e-21],
        [9.9971563e-01, 2.8440327e-04, 1.8894905e-10, 1.5229068e-09],
        ...,
        [1.0000000e+00, 1.4374668e-08, 6.5693033e-12, 1.3430193e-18],
        [1.0000000e+00, 6.5104216e-10, 1.9407737e-21, 7.4681762e-22],
        [9.9999857e-01, 1.4125510e-06, 1.1954149e-09, 6.6393771e-17]],
       dtype=float32),
 array([[1.   , 0.   , 0.   , 0.   ],
        [1.   , 0.   , 0.   , 0.   ],
        [0.975, 0.015, 0.005, 0.005],
        ...,
        [1.   , 0.   , 0.   , 0.   ],
        [1.   , 0.   , 0.   , 0.   ],
        [1.   , 0.   , 0.   , 0.   ]])]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Result_preds</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Result_preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">labels_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_val</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1"># score_for_Competition = sum(sum(abs(labels_ - Result_preds[0])))</span>
<span class="c1"># print(score_for_Competition)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">labels_</span> <span class="o">-</span> <span class="n">Result_preds</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">score_for_Competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-966a98b764f5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>print<span class="ansi-blue-fg">(</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>Result_preds<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> print<span class="ansi-blue-fg">(</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>Result_preds<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> 
<span class="ansi-green-intense-fg ansi-bold">      4</span> onehot_encoder <span class="ansi-blue-fg">=</span> OneHotEncoder<span class="ansi-blue-fg">(</span>sparse<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> labels_ <span class="ansi-blue-fg">=</span> onehot_encoder<span class="ansi-blue-fg">.</span>fit_transform<span class="ansi-blue-fg">(</span>y_val<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>y_val<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Result_preds&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
  <span class="c1"># preds = np.argmax(preds.reshape(4,-1),axis=0)</span>
  <span class="n">preds_</span> <span class="o">=</span> <span class="n">preds</span>
  <span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">labels_</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
  <span class="c1"># preds_ = onehot_encoder.fit_transform(preds.reshape(len(preds), 1))</span>
  <span class="c1"># print(labels_.shape, &#39;\n&#39;, preds_.shape)</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">labels_</span> <span class="o">-</span> <span class="n">preds_</span><span class="p">)))</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="n">Result_xcc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Result_preds</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Result_xcc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (25000, 4)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Result_xcc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">Result_xcc</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>  <span class="c1"># 注意区分y_true和y_val</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(25000, 4)
0.9999999888523176
score_for_Competition: 357.42971866257614
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stacking&#34701;&#21512;">Stacking&#34701;&#21512;<a class="anchor-link" href="#Stacking&#34701;&#21512;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># 输出预测结果</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span>

<span class="c1"># X_test处理</span>
<span class="n">X_test_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">X_test</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">X_test_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_list</span><span class="p">))</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;s_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="c1"># X_test = X_test.drop([&#39;id&#39;], axis=1)</span>
<span class="c1"># X_test = reduce_mem_usage(X_test)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">X_test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/features_X_test.csv&#39;</span><span class="p">)</span>

<span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>         id       s_0       s_1  ...     s_202     s_203     s_204
0  100000.0  0.991571  1.000000  ...  0.000000  0.000000  0.000000
1  100001.0  0.607553  0.541708  ...  0.350575  0.350565  0.363874
2  100002.0  0.975273  0.671097  ...  0.000000  0.000000  0.000000
3  100003.0  0.995635  0.917025  ...  0.000000  0.000000  0.000000
4  100004.0  1.000000  0.887949  ...  0.000000  0.000000  0.000000

[5 rows x 206 columns]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-4-97bfdb4b6327&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     20</span> <span class="ansi-red-fg"># 划分X_train, X_val, y_train, y_val</span>
<span class="ansi-green-intense-fg ansi-bold">     21</span> <span class="ansi-green-fg">from</span> sklearn<span class="ansi-blue-fg">.</span>model_selection <span class="ansi-green-fg">import</span> train_test_split
<span class="ansi-green-fg">---&gt; 22</span><span class="ansi-red-fg"> </span>X_train<span class="ansi-blue-fg">,</span> X_val<span class="ansi-blue-fg">,</span> y_train<span class="ansi-blue-fg">,</span> y_val <span class="ansi-blue-fg">=</span> train_test_split<span class="ansi-blue-fg">(</span>features<span class="ansi-blue-fg">,</span> labels<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;features&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="nn">sklearn.externals</span> <span class="k">import</span> <span class="n">joblib</span>

<span class="n">root_path_model</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/Model/&#39;</span>
<span class="n">path_model</span> <span class="o">=</span> <span class="p">[</span><span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;LightGBM_ECG.txt&#39;</span><span class="p">,</span>   <span class="c1"># 531.2</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;LSTM_ECG_0429-128.h5&#39;</span><span class="p">,</span>  <span class="c1"># 446</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;CNN_ECG_0429_1.h5&#39;</span><span class="p">,</span>   <span class="c1"># 634</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;Conv-LSTM_ECG_0428.h5&#39;</span><span class="p">,</span>  <span class="c1"># 600</span>
        <span class="n">root_path_model</span> <span class="o">+</span> <span class="s1">&#39;RF_ECG_0424.pkl&#39;</span>     <span class="c1"># 994</span>
        <span class="p">]</span>
<span class="n">model_1</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Booster</span><span class="p">(</span><span class="n">model_file</span><span class="o">=</span><span class="n">path_model</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">model_2</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">model_3</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">model_4</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">path_model</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">pred_1</span> <span class="o">=</span> <span class="n">model_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>  <span class="c1"># 结果是类别的概率分布，与其他模型输出类型一致，即稀疏标签类型</span>
<span class="n">pred_2</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pred_3</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pred_4</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pred_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pred_1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># pred_1 = onehot_encoder.fit_transform(pred_1.reshape(pred_1.shape[0], 1))</span>

<span class="n">Result_preds</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred_1</span><span class="p">,</span> <span class="n">pred_2</span><span class="p">,</span> <span class="n">pred_3</span><span class="p">,</span> <span class="n">pred_4</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">Result_preds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_val</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">score_for_Competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>170
74
28
168
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>

<span class="c1">#### 从Result_Different_of_preds选用得分相近的模型进行堆叠融合，毕竟学霸对出来的答案更靠谱</span>
<span class="c1">## 第一层</span>
<span class="c1"># train_model_1_pred = model_1.predict(X_train)</span>
<span class="n">train_model_2_pred</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">train_model_3_pred</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">train_model_4_pred</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">stacking_X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="c1"># stacking_X_train[&#39;mode_1&#39;] = np.argmax(train_model_1_pred,axis=1)</span>
<span class="n">stacking_X_train</span><span class="p">[</span><span class="s1">&#39;mode_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_model_2_pred</span>
<span class="n">stacking_X_train</span><span class="p">[</span><span class="s1">&#39;mode_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_model_3_pred</span>
<span class="n">stacking_X_train</span><span class="p">[</span><span class="s1">&#39;mode_4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_model_4_pred</span>

<span class="c1"># val_model_1_pred = model_1.predict(X_val)</span>
<span class="n">val_model_2_pred</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">val_model_3_pred</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">val_model_4_pred</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">stacking_X_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="c1"># stacking_X_val[&#39;model_1&#39;] = np.argmax(val_model_1_pred,axis=1)</span>
<span class="n">stacking_X_val</span><span class="p">[</span><span class="s1">&#39;model_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_model_2_pred</span>
<span class="n">stacking_X_val</span><span class="p">[</span><span class="s1">&#39;model_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_model_3_pred</span>
<span class="n">stacking_X_val</span><span class="p">[</span><span class="s1">&#39;model_4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_model_4_pred</span>

<span class="c1"># test_model_1_pred = model_1.predict(X_test)</span>
<span class="n">test_model_2_pred</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">test_model_3_pred</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="n">test_model_4_pred</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">stacking_X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="c1"># stacking_X_test[&#39;model_1&#39;] = np.argmax(test_model_1_pred,axis=1)</span>
<span class="n">stacking_X_test</span><span class="p">[</span><span class="s1">&#39;model_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_model_2_pred</span>
<span class="n">stacking_X_test</span><span class="p">[</span><span class="s1">&#39;model_3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_model_3_pred</span>
<span class="n">stacking_X_test</span><span class="p">[</span><span class="s1">&#39;model_4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_model_4_pred</span>

<span class="c1">## 第二层用lightGBM预测</span>
<span class="n">model_lgb_stacking</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">num_leaves</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">model_lgb_stacking</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">stacking_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>


<span class="c1"># 第二层用人工神经网络（因为融合模型的本质应该是一个非线性映射，对单模进行优势互补，用人工神经网络来做比较合适</span>
<span class="c1"># from sklearn.neural_network import MLPClassifier,MLPRegressor</span>
<span class="c1"># model_nn_stacking = MLPRegressor(alpha=1e-05, hidden_layer_sizes=(200,4), random_state=1, solver=&#39;lbfgs&#39;)</span>
<span class="c1"># model_nn_stacking.fit(X_train, y_train)</span>



<span class="c1"># 对单模LSTM、CNN_1D、Conv-LSTM三个单模进行stacking融合可能会比对4个单模进行融合要好</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py:450: UserWarning: `model.predict_classes()` is deprecated and will be removed after 2021-01-01. Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype(&#34;int32&#34;)`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).
  warnings.warn(&#39;`model.predict_classes()` is deprecated and &#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LGBMClassifier(boosting_type=&#39;gbdt&#39;, class_weight=None, colsample_bytree=1.0,
               importance_type=&#39;split&#39;, learning_rate=0.005, max_depth=-1,
               min_child_samples=20, min_child_weight=0.001, min_split_gain=0.0,
               n_estimators=200, n_jobs=-1, num_leaves=128, objective=None,
               random_state=None, reg_alpha=0.0, reg_lambda=0.0, silent=True,
               subsample=1.0, subsample_for_bin=200000, subsample_freq=0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="k">import</span> <span class="n">MLPClassifier</span><span class="p">,</span><span class="n">MLPRegressor</span>
<span class="n">model_nn_stacking</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="n">model_nn_stacking</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/neural_network/_multilayer_perceptron.py:470: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  self.n_iter_ = _check_optimize_result(&#34;lbfgs&#34;, opt_res, self.max_iter)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>MLPRegressor(activation=&#39;relu&#39;, alpha=1e-05, batch_size=&#39;auto&#39;, beta_1=0.9,
             beta_2=0.999, early_stopping=False, epsilon=1e-08,
             hidden_layer_sizes=(200, 4), learning_rate=&#39;constant&#39;,
             learning_rate_init=0.001, max_fun=15000, max_iter=200,
             momentum=0.9, n_iter_no_change=10, nesterovs_momentum=True,
             power_t=0.5, random_state=1, shuffle=True, solver=&#39;lbfgs&#39;,
             tol=0.0001, validation_fraction=0.1, verbose=False,
             warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="c1"># 训练集上预测</span>
<span class="n">train_pred_Stacking</span> <span class="o">=</span> <span class="n">model_lgb_stacking</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">stacking_X_train</span><span class="p">)</span>
<span class="c1"># train_pred_Stacking = np.argmax(train_pred_Stacking,axis=1)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">train_pred_Stacking</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>  <span class="c1"># 注意区分y_true和y_val</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition in Train_Dataset:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>

<span class="c1"># 验证集上预测</span>
<span class="n">val_pred_Stacking</span> <span class="o">=</span> <span class="n">model_lgb_stacking</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">stacking_X_val</span><span class="p">)</span>
<span class="c1"># val_pred_Stacking = np.argmax(val_pred_Stacking,axis=1)</span>
<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">val_pred_Stacking</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>  <span class="c1"># 注意区分y_true和y_val</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition in Train_Dataset:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
<span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="k">if</span> <span class="n">val_pred_Stacking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_val</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
    <span class="nb">sum</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;预测准确率：&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="o">/</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>


<span class="c1"># 测试集上预测</span>
<span class="n">test_pred_Stacking</span> <span class="o">=</span> <span class="n">model_lgb_stacking</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">stacking_X_test</span><span class="p">)</span>
<span class="c1"># test_pred_Stacking = np.argmax(test_pred_Stacking,axis=1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_pred_Stacking</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition in Train_Dataset: 60
score_for_Competition in Train_Dataset: 36
预测准确率： 0.99928
[0. 2. 3. ... 2. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># score_for_Competition = sum(sum(abs(labels_ - preds_)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>122
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_preds_subm</span> <span class="o">=</span> <span class="n">test_pred_Stacking</span>
<span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">y_preds_subm</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_preds_subm</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_pred_Stacking</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_preds_subm</span><span class="p">)</span>

<span class="n">result</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/sample_submit.csv&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_1&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/submit.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1. 0. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]
 ...
 [0. 0. 1. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
           id  label_0  label_1  label_2  label_3
0      100000      1.0      0.0      0.0      0.0
1      100001      0.0      0.0      1.0      0.0
2      100002      0.0      0.0      0.0      1.0
3      100003      1.0      0.0      0.0      0.0
4      100004      1.0      0.0      0.0      0.0
...       ...      ...      ...      ...      ...
19995  119995      1.0      0.0      0.0      0.0
19996  119996      1.0      0.0      0.0      0.0
19997  119997      0.0      0.0      1.0      0.0
19998  119998      1.0      0.0      0.0      0.0
19999  119999      1.0      0.0      0.0      0.0

[20000 rows x 5 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="k">if</span> <span class="n">val_pred_Stacking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_val</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
    <span class="nb">sum</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="o">/</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.99928
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#26131;&#26126;&#24314;&#27169;">&#26131;&#26126;&#24314;&#27169;<a class="anchor-link" href="#&#26131;&#26126;&#24314;&#27169;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入包</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">make_scorer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="k">import</span> <span class="n">LGBMRegressor</span><span class="p">,</span> <span class="n">LGBMClassifier</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>


<span class="c1"># 数据预处理</span>
<span class="k">def</span> <span class="nf">reduce_mem_usage</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">start_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage of dataframe is </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        
        <span class="k">if</span> <span class="n">col_type</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">c_min</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">c_max</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_type</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="n">end_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Memory usage after optimization is: </span><span class="si">{:.2f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_mem</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decreased by </span><span class="si">{:.1f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_mem</span> <span class="o">-</span> <span class="n">end_mem</span><span class="p">)</span> <span class="o">/</span> <span class="n">start_mem</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="c1"># 读取数据</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train.csv&#39;</span><span class="p">)</span>
<span class="n">data_features_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Features_Extract/train_features_filtered_MinimalFCParameters.csv&#39;</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># 原始特征Dataframe</span>
<span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_list</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;s_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/Data_features_labels.csv&#39;</span><span class="p">)</span>



<span class="c1"># 输出预测结果</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/testA.csv&#39;</span><span class="p">)</span>

<span class="c1"># X_test处理</span>
<span class="n">X_test_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">X_test</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
  <span class="n">X_test_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_list</span><span class="p">))</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;s_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">X_test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/X_test_features.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Memory usage of dataframe is 157.93 MB
Memory usage after optimization is: 39.67 MB
Decreased by 74.9%
Memory usage of dataframe is 31.28 MB
Memory usage after optimization is: 7.82 MB
Decreased by 75.0%
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#26131;&#26126;&#24314;&#27169;">&#26131;&#26126;&#24314;&#27169;<a class="anchor-link" href="#&#26131;&#26126;&#24314;&#27169;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#32467;&#26524;&#24418;&#24335;&#35843;&#25972;">&#32467;&#26524;&#24418;&#24335;&#35843;&#25972;<a class="anchor-link" href="#&#32467;&#26524;&#24418;&#24335;&#35843;&#25972;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 使用易明数据建模软件预测的结果提交</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">result_proba_ym</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/submit_ym.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_proba_ym</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">result_ym</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">result_proba_ym</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_ym</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">result_ym</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">result_ym</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result_ym</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_ym</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># 生成可提交的结果</span>
<span class="n">result</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/sample_submit.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">result_ym</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_1&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">result_ym</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">result_ym</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">result_ym</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/submit.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(20000, 4)
(20000,)
(20000, 4)
           id  label_0  label_1  label_2  label_3
0      100000        0        0        0        0
1      100001        0        0        0        0
2      100002        0        0        0        0
3      100003        0        0        0        0
4      100004        0        0        0        0
...       ...      ...      ...      ...      ...
19995  119995        0        0        0        0
19996  119996        0        0        0        0
19997  119997        0        0        0        0
19998  119998        0        0        0        0
19999  119999        0        0        0        0

[20000 rows x 5 columns]
           id  label_0  label_1  label_2  label_3
0      100000      1.0      0.0      0.0      0.0
1      100001      0.0      0.0      1.0      0.0
2      100002      0.0      0.0      0.0      1.0
3      100003      1.0      0.0      0.0      0.0
4      100004      1.0      0.0      0.0      0.0
...       ...      ...      ...      ...      ...
19995  119995      1.0      0.0      0.0      0.0
19996  119996      1.0      0.0      0.0      0.0
19997  119997      0.0      0.0      1.0      0.0
19998  119998      1.0      0.0      0.0      0.0
19999  119999      1.0      0.0      0.0      0.0

[20000 rows x 5 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="AutoML">AutoML<a class="anchor-link" href="#AutoML">&#182;</a></h1><p>auto-sklearn
autogluon</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Auto-sklearn">Auto-sklearn<a class="anchor-link" href="#Auto-sklearn">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>sudo pip3 install auto-sklearn
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting auto-sklearn
  Downloading https://files.pythonhosted.org/packages/a5/1b/9249f7d4498cbdb0130352a838e02ca7d7bebbcacde74d1f4f26a5d9202b/auto-sklearn-0.12.6.tar.gz (6.1MB)
     |████████████████████████████████| 6.1MB 11.0MB/s 
Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (56.1.0)
Requirement already satisfied: numpy&gt;=1.9.0 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.19.5)
Requirement already satisfied: scipy&gt;=0.14.1 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.4.1)
Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.0.1)
Collecting scikit-learn&lt;0.25.0,&gt;=0.24.0
  Downloading https://files.pythonhosted.org/packages/a8/eb/a48f25c967526b66d5f1fa7a984594f0bf0a5afafa94a8c4dbc317744620/scikit_learn-0.24.2-cp37-cp37m-manylinux2010_x86_64.whl (22.3MB)
     |████████████████████████████████| 22.3MB 31.3MB/s 
Requirement already satisfied: dask in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (2.12.0)
Collecting distributed&gt;=2.2.0
  Downloading https://files.pythonhosted.org/packages/63/f8/ac2c18adde6477bca3881c4d3cfa74c7f4da7ee82f3c83c201aa3b9ca5ee/distributed-2021.4.1-py3-none-any.whl (696kB)
     |████████████████████████████████| 706kB 43.7MB/s 
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (3.13)
Requirement already satisfied: pandas&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.1.5)
Collecting liac-arff
  Downloading https://files.pythonhosted.org/packages/6e/43/73944aa5ad2b3185c0f0ba0ee6f73277f2eb51782ca6ccf3e6793caf209a/liac-arff-2.5.0.tar.gz
Collecting ConfigSpace&lt;0.5,&gt;=0.4.14
  Downloading https://files.pythonhosted.org/packages/a5/c3/3c21e8d82a639fd821f538e6d7f830b654a6ce1fe52644be1a67f323f707/ConfigSpace-0.4.18.tar.gz (950kB)
     |████████████████████████████████| 952kB 38.4MB/s 
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
    Preparing wheel metadata ... done
Collecting pynisher&gt;=0.6.3
  Downloading https://files.pythonhosted.org/packages/8d/39/edac9acf3bd245ecf475151014cce3652c25ca3c2352eac725502cfce6ea/pynisher-0.6.4.tar.gz
Collecting pyrfr&lt;0.9,&gt;=0.8.1
  Downloading https://files.pythonhosted.org/packages/8b/1a/56b630c949e942d12f4ad5f4fd240c1cf2e1260e5126190b171ca2aa9199/pyrfr-0.8.2-cp37-cp37m-manylinux2014_x86_64.whl (4.0MB)
     |████████████████████████████████| 4.0MB 42.1MB/s 
Collecting smac&lt;0.14,&gt;=0.13.1
  Downloading https://files.pythonhosted.org/packages/ef/f2/8ea040eaa2253a3606472b08d9c2a23be1a177c0c19e236a2b3222c0fd78/smac-0.13.1.tar.gz (258kB)
     |████████████████████████████████| 266kB 48.1MB/s 
Collecting threadpoolctl&gt;=2.0.0
  Downloading https://files.pythonhosted.org/packages/f7/12/ec3f2e203afa394a149911729357aa48affc59c20e2c1c8297a60f33f133/threadpoolctl-2.1.0-py3-none-any.whl
Requirement already satisfied: tblib&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (1.7.0)
Requirement already satisfied: tornado&gt;=5; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (5.1.1)
Requirement already satisfied: toolz&gt;=0.8.2 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (0.11.1)
Requirement already satisfied: click&gt;=6.6 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (7.1.2)
Requirement already satisfied: sortedcontainers!=2.0.0,!=2.0.1 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (2.3.0)
Requirement already satisfied: psutil&gt;=5.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (5.4.8)
Collecting cloudpickle&gt;=1.5.0
  Downloading https://files.pythonhosted.org/packages/e7/e3/898487e5dbeb612054cf2e0c188463acb358167fef749c53c8bb8918cea1/cloudpickle-1.6.0-py3-none-any.whl
Requirement already satisfied: zict&gt;=0.1.3 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (2.0.0)
Requirement already satisfied: msgpack&gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (1.0.2)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0-&gt;auto-sklearn) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0-&gt;auto-sklearn) (2.8.1)
Requirement already satisfied: cython in /usr/local/lib/python3.7/dist-packages (from ConfigSpace&lt;0.5,&gt;=0.4.14-&gt;auto-sklearn) (0.29.23)
Requirement already satisfied: pyparsing in /usr/local/lib/python3.7/dist-packages (from ConfigSpace&lt;0.5,&gt;=0.4.14-&gt;auto-sklearn) (2.4.7)
Collecting lazy_import
  Downloading https://files.pythonhosted.org/packages/44/2e/5378f9b9cbc893826c2ecb022646c97ece9efbaad351adf89425fff33990/lazy_import-0.2.2.tar.gz
Requirement already satisfied: heapdict in /usr/local/lib/python3.7/dist-packages (from zict&gt;=0.1.3-&gt;distributed&gt;=2.2.0-&gt;auto-sklearn) (1.0.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas&gt;=1.0-&gt;auto-sklearn) (1.15.0)
Building wheels for collected packages: ConfigSpace
  Building wheel for ConfigSpace (PEP 517) ... done
  Created wheel for ConfigSpace: filename=ConfigSpace-0.4.18-cp37-cp37m-linux_x86_64.whl size=2879812 sha256=d7b4843dc0646f22b882efd9bf93d12f38cc45d0eead22517605f7a5f03674d5
  Stored in directory: /root/.cache/pip/wheels/39/ea/40/d93931850f700427db0a84180829c709d30484c9475040c7bd
Successfully built ConfigSpace
Building wheels for collected packages: auto-sklearn, liac-arff, pynisher, smac, lazy-import
  Building wheel for auto-sklearn (setup.py) ... done
  Created wheel for auto-sklearn: filename=auto_sklearn-0.12.6-cp37-none-any.whl size=6370105 sha256=57df4cc3397307c3d2cda0012b7502ea0d043d666e469ef8fd9d39a00ad8bafa
  Stored in directory: /root/.cache/pip/wheels/5f/c8/1f/3a6d11c1e156bf431e7cc4c4ff27e71059acc9638caa11ab35
  Building wheel for liac-arff (setup.py) ... done
  Created wheel for liac-arff: filename=liac_arff-2.5.0-cp37-none-any.whl size=11732 sha256=78da8fbe3b4b0e969b50105fe6c7a84353d215059c9d892c80bfa01c6ca563dc
  Stored in directory: /root/.cache/pip/wheels/77/8d/b4/8bfce5beea9a3496cc15b24961876adb7b6e2912ff09164179
  Building wheel for pynisher (setup.py) ... done
  Created wheel for pynisher: filename=pynisher-0.6.4-cp37-none-any.whl size=7045 sha256=605c742e2506d7ba7be43141a441e1d4bc309873b5f13f42c7541fc309fa108c
  Stored in directory: /root/.cache/pip/wheels/70/07/6b/c0e6d547d91cd50a30207421c3c3a63d71f195255c66401209
  Building wheel for smac (setup.py) ... done
  Created wheel for smac: filename=smac-0.13.1-cp37-none-any.whl size=252183 sha256=4382e149ec078b275195bc2c332e4123e2816715273e006b8ec356ae63b08cbd
  Stored in directory: /root/.cache/pip/wheels/29/a6/af/9ec3c1ff517759ad1aad6babcbcf047dd5078c8b08fa4e63cc
  Building wheel for lazy-import (setup.py) ... done
  Created wheel for lazy-import: filename=lazy_import-0.2.2-py2.py3-none-any.whl size=16486 sha256=f039c51d2431a3c306caa2027799887a99b7381ff74882ff268c0e449da06573
  Stored in directory: /root/.cache/pip/wheels/a9/b0/b5/8c7e6810aee14bc4ed4a542ce56e744126263bf4f4825a9094
Successfully built auto-sklearn liac-arff pynisher smac lazy-import
<span class="ansi-red-fg">ERROR: distributed 2021.4.1 has requirement dask&gt;=2021.03.0, but you&#39;ll have dask 2.12.0 which is incompatible.</span>
Installing collected packages: threadpoolctl, scikit-learn, cloudpickle, distributed, liac-arff, ConfigSpace, pynisher, pyrfr, lazy-import, smac, auto-sklearn
  Found existing installation: scikit-learn 0.22.2.post1
    Uninstalling scikit-learn-0.22.2.post1:
      Successfully uninstalled scikit-learn-0.22.2.post1
  Found existing installation: cloudpickle 1.3.0
    Uninstalling cloudpickle-1.3.0:
      Successfully uninstalled cloudpickle-1.3.0
  Found existing installation: distributed 1.25.3
    Uninstalling distributed-1.25.3:
      Successfully uninstalled distributed-1.25.3
Successfully installed ConfigSpace-0.4.18 auto-sklearn-0.12.6 cloudpickle-1.6.0 distributed-2021.4.1 lazy-import-0.2.2 liac-arff-2.5.0 pynisher-0.6.4 pyrfr-0.8.2 scikit-learn-0.24.2 smac-0.13.1 threadpoolctl-2.1.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>sudo pip3 install auto-sklearn
<span class="c1"># import auto-sklearn</span>
<span class="c1"># %cd &quot;/content/drive/Shareddrives/xucc1993.HK(CRN.NGO)/CLF_of_ECG_signals/AutoML-AutoDL/asModels-predictClass&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting auto-sklearn
  Downloading https://files.pythonhosted.org/packages/a5/1b/9249f7d4498cbdb0130352a838e02ca7d7bebbcacde74d1f4f26a5d9202b/auto-sklearn-0.12.6.tar.gz (6.1MB)
     |████████████████████████████████| 6.1MB 8.8MB/s 
Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (56.1.0)
Requirement already satisfied: numpy&gt;=1.9.0 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.19.5)
Requirement already satisfied: scipy&gt;=0.14.1 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.4.1)
Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.0.1)
Requirement already satisfied: scikit-learn&lt;0.25.0,&gt;=0.24.0 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (0.24.2)
Requirement already satisfied: dask in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (2021.4.1)
Collecting distributed&gt;=2.2.0
  Downloading https://files.pythonhosted.org/packages/63/f8/ac2c18adde6477bca3881c4d3cfa74c7f4da7ee82f3c83c201aa3b9ca5ee/distributed-2021.4.1-py3-none-any.whl (696kB)
     |████████████████████████████████| 706kB 55.1MB/s 
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (3.13)
Requirement already satisfied: pandas&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from auto-sklearn) (1.1.5)
Collecting liac-arff
  Downloading https://files.pythonhosted.org/packages/6e/43/73944aa5ad2b3185c0f0ba0ee6f73277f2eb51782ca6ccf3e6793caf209a/liac-arff-2.5.0.tar.gz
Collecting ConfigSpace&lt;0.5,&gt;=0.4.14
  Downloading https://files.pythonhosted.org/packages/a5/c3/3c21e8d82a639fd821f538e6d7f830b654a6ce1fe52644be1a67f323f707/ConfigSpace-0.4.18.tar.gz (950kB)
     |████████████████████████████████| 952kB 51.5MB/s 
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
    Preparing wheel metadata ... done
Collecting pynisher&gt;=0.6.3
  Downloading https://files.pythonhosted.org/packages/8d/39/edac9acf3bd245ecf475151014cce3652c25ca3c2352eac725502cfce6ea/pynisher-0.6.4.tar.gz
Collecting pyrfr&lt;0.9,&gt;=0.8.1
  Downloading https://files.pythonhosted.org/packages/8b/1a/56b630c949e942d12f4ad5f4fd240c1cf2e1260e5126190b171ca2aa9199/pyrfr-0.8.2-cp37-cp37m-manylinux2014_x86_64.whl (4.0MB)
     |████████████████████████████████| 4.0MB 46.1MB/s 
Collecting smac&lt;0.14,&gt;=0.13.1
  Downloading https://files.pythonhosted.org/packages/ef/f2/8ea040eaa2253a3606472b08d9c2a23be1a177c0c19e236a2b3222c0fd78/smac-0.13.1.tar.gz (258kB)
     |████████████████████████████████| 266kB 25.9MB/s 
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&lt;0.25.0,&gt;=0.24.0-&gt;auto-sklearn) (2.1.0)
Requirement already satisfied: cloudpickle&gt;=1.1.1 in /usr/local/lib/python3.7/dist-packages (from dask-&gt;auto-sklearn) (1.3.0)
Requirement already satisfied: toolz&gt;=0.8.2 in /usr/local/lib/python3.7/dist-packages (from dask-&gt;auto-sklearn) (0.11.1)
Requirement already satisfied: fsspec&gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from dask-&gt;auto-sklearn) (2021.4.0)
Requirement already satisfied: partd&gt;=0.3.10 in /usr/local/lib/python3.7/dist-packages (from dask-&gt;auto-sklearn) (1.2.0)
Requirement already satisfied: click&gt;=6.6 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (7.1.2)
Requirement already satisfied: tornado&gt;=5; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (5.1.1)
Requirement already satisfied: msgpack&gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (1.0.2)
Requirement already satisfied: zict&gt;=0.1.3 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (2.0.0)
Requirement already satisfied: tblib&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (1.7.0)
Requirement already satisfied: psutil&gt;=5.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (5.4.8)
Requirement already satisfied: sortedcontainers!=2.0.0,!=2.0.1 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.2.0-&gt;auto-sklearn) (2.3.0)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0-&gt;auto-sklearn) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0-&gt;auto-sklearn) (2.8.1)
Requirement already satisfied: pyparsing in /usr/local/lib/python3.7/dist-packages (from ConfigSpace&lt;0.5,&gt;=0.4.14-&gt;auto-sklearn) (2.4.7)
Requirement already satisfied: cython in /usr/local/lib/python3.7/dist-packages (from ConfigSpace&lt;0.5,&gt;=0.4.14-&gt;auto-sklearn) (0.29.23)
Collecting lazy_import
  Downloading https://files.pythonhosted.org/packages/44/2e/5378f9b9cbc893826c2ecb022646c97ece9efbaad351adf89425fff33990/lazy_import-0.2.2.tar.gz
Requirement already satisfied: locket in /usr/local/lib/python3.7/dist-packages (from partd&gt;=0.3.10-&gt;dask-&gt;auto-sklearn) (0.2.1)
Requirement already satisfied: heapdict in /usr/local/lib/python3.7/dist-packages (from zict&gt;=0.1.3-&gt;distributed&gt;=2.2.0-&gt;auto-sklearn) (1.0.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas&gt;=1.0-&gt;auto-sklearn) (1.15.0)
Building wheels for collected packages: ConfigSpace
  Building wheel for ConfigSpace (PEP 517) ... done
  Created wheel for ConfigSpace: filename=ConfigSpace-0.4.18-cp37-cp37m-linux_x86_64.whl size=2879758 sha256=fb09069a3fce75f291d325cb556995491394c34e0bd10c5460bc09b33878bc63
  Stored in directory: /root/.cache/pip/wheels/39/ea/40/d93931850f700427db0a84180829c709d30484c9475040c7bd
Successfully built ConfigSpace
Building wheels for collected packages: auto-sklearn, liac-arff, pynisher, smac, lazy-import
  Building wheel for auto-sklearn (setup.py) ... done
  Created wheel for auto-sklearn: filename=auto_sklearn-0.12.6-cp37-none-any.whl size=6370105 sha256=f8affbfc63c10bfb8946bcf8fd005a0588b888c95460abd820c5763717dfa51a
  Stored in directory: /root/.cache/pip/wheels/5f/c8/1f/3a6d11c1e156bf431e7cc4c4ff27e71059acc9638caa11ab35
  Building wheel for liac-arff (setup.py) ... done
  Created wheel for liac-arff: filename=liac_arff-2.5.0-cp37-none-any.whl size=11732 sha256=89a27efeaaa7a3ebc14a46601371f7403d331f23b45d33b86e4d9f53faf09808
  Stored in directory: /root/.cache/pip/wheels/77/8d/b4/8bfce5beea9a3496cc15b24961876adb7b6e2912ff09164179
  Building wheel for pynisher (setup.py) ... done
  Created wheel for pynisher: filename=pynisher-0.6.4-cp37-none-any.whl size=7045 sha256=93007e78a4dd8e878d64ddf579e7f63c3d47bd7bf384cd253c51064897c05ee2
  Stored in directory: /root/.cache/pip/wheels/70/07/6b/c0e6d547d91cd50a30207421c3c3a63d71f195255c66401209
  Building wheel for smac (setup.py) ... done
  Created wheel for smac: filename=smac-0.13.1-cp37-none-any.whl size=252182 sha256=f64d4d4c4250fea5926a83e4565dc8fe43bbd69adb8ab4f621ee2a9638011952
  Stored in directory: /root/.cache/pip/wheels/29/a6/af/9ec3c1ff517759ad1aad6babcbcf047dd5078c8b08fa4e63cc
  Building wheel for lazy-import (setup.py) ... done
  Created wheel for lazy-import: filename=lazy_import-0.2.2-py2.py3-none-any.whl size=16486 sha256=8fb774f147485d0edc8c893ab6715ff7b1dd2b285ee1adfb7cbbb60895f9c621
  Stored in directory: /root/.cache/pip/wheels/a9/b0/b5/8c7e6810aee14bc4ed4a542ce56e744126263bf4f4825a9094
Successfully built auto-sklearn liac-arff pynisher smac lazy-import
<span class="ansi-red-fg">ERROR: distributed 2021.4.1 has requirement cloudpickle&gt;=1.5.0, but you&#39;ll have cloudpickle 1.3.0 which is incompatible.</span>
Installing collected packages: distributed, liac-arff, ConfigSpace, pynisher, pyrfr, lazy-import, smac, auto-sklearn
  Found existing installation: distributed 1.25.3
    Uninstalling distributed-1.25.3:
      Successfully uninstalled distributed-1.25.3
Successfully installed ConfigSpace-0.4.18 auto-sklearn-0.12.6 distributed-2021.4.1 lazy-import-0.2.2 liac-arff-2.5.0 pynisher-0.6.4 pyrfr-0.8.2 smac-0.13.1
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>sudo pip3 install dask --upgrade
<span class="c1"># !sudo pip3 install scikit-learn --upgrade</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting dask
  Downloading https://files.pythonhosted.org/packages/c3/23/42159cdb5c9edac174296c9976e175742513883f0f7bc132cfc2a2480fab/dask-2021.4.1-py3-none-any.whl (952kB)
     |████████████████████████████████| 952kB 8.7MB/s 
Collecting fsspec&gt;=0.6.0
  Downloading https://files.pythonhosted.org/packages/e9/91/2ef649137816850fa4f4c97c6f2eabb1a79bf0aa2c8ed198e387e373455e/fsspec-2021.4.0-py3-none-any.whl (108kB)
     |████████████████████████████████| 112kB 27.1MB/s 
Requirement already satisfied, skipping upgrade: cloudpickle&gt;=1.1.1 in /usr/local/lib/python3.7/dist-packages (from dask) (1.3.0)
Collecting partd&gt;=0.3.10
  Downloading https://files.pythonhosted.org/packages/41/94/360258a68b55f47859d72b2d0b2b3cfe0ca4fbbcb81b78812bd00ae86b7c/partd-1.2.0-py3-none-any.whl
Requirement already satisfied, skipping upgrade: toolz&gt;=0.8.2 in /usr/local/lib/python3.7/dist-packages (from dask) (0.11.1)
Requirement already satisfied, skipping upgrade: pyyaml in /usr/local/lib/python3.7/dist-packages (from dask) (3.13)
Collecting locket
  Downloading https://files.pythonhosted.org/packages/50/b8/e789e45b9b9c2db75e9d9e6ceb022c8d1d7e49b2c085ce8c05600f90a96b/locket-0.2.1-py2.py3-none-any.whl
Installing collected packages: fsspec, locket, partd, dask
  Found existing installation: dask 2.12.0
    Uninstalling dask-2.12.0:
      Successfully uninstalled dask-2.12.0
Successfully installed dask-2021.4.1 fsspec-2021.4.0 locket-0.2.1 partd-1.2.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>bash
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CLF_of_ECG">CLF_of_ECG<a class="anchor-link" href="#CLF_of_ECG">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># X_train, X_val, y_train, y_val = train_test_split(features, labels)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/X_train.csv&#39;</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/X_val.csv&#39;</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/y_train.csv&#39;</span><span class="p">)</span>
<span class="n">y_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/y_val.csv&#39;</span><span class="p">)</span>


<span class="c1"># import autosklearn.classification</span>
<span class="kn">from</span> <span class="nn">autosklearn.classification</span> <span class="k">import</span> <span class="n">AutoSklearnClassifier</span>

<span class="bp">cls</span> <span class="o">=</span> <span class="n">AutoSklearnClassifier</span><span class="p">(</span><span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">max_models_on_disc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">initial_configurations_via_metalearning</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">smac_scenario_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;runcount_limit&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="bp">cls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/pyparsing.py:3190: FutureWarning: Possible set intersection at position 3
  self.re = re.compile(self.reString)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-449db6178d72&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> cls <span class="ansi-blue-fg">=</span> AutoSklearnClassifier<span class="ansi-blue-fg">(</span>time_left_for_this_task<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">60</span><span class="ansi-blue-fg">,</span>per_run_time_limit<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">30</span><span class="ansi-blue-fg">,</span>max_models_on_disc<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">,</span>initial_configurations_via_metalearning<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>smac_scenario_args<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">&#39;runcount_limit&#39;</span><span class="ansi-blue-fg">:</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> 
<span class="ansi-green-fg">---&gt; 17</span><span class="ansi-red-fg"> </span>cls<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>X_train<span class="ansi-blue-fg">,</span> y_train<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span> 
<span class="ansi-green-intense-fg ansi-bold">     19</span> print<span class="ansi-blue-fg">(</span>automl<span class="ansi-blue-fg">.</span>show_models<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/autosklearn/estimators.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, X, y, X_test, y_test, feat_type, dataset_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    660</span>                              &#34;&#34;.format(
<span class="ansi-green-intense-fg ansi-bold">    661</span>                                     target_type<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 662</span><span class="ansi-red-fg">                                     </span>supported_types
<span class="ansi-green-intense-fg ansi-bold">    663</span>                                 )
<span class="ansi-green-intense-fg ansi-bold">    664</span>                              )

<span class="ansi-red-fg">ValueError</span>: Classification with data of type multiclass-multioutput is not supported. Supported types are [&#39;binary&#39;, &#39;multiclass&#39;, &#39;multilabel-indicator&#39;]. You can find more information about scikit-learn data types in: https://scikit-learn.org/stable/modules/multiclass.html</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feval_abs_sum</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>  <span class="c1"># 导入的都是稀疏标签</span>
  <span class="n">score_for_Competition</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="n">i</span><span class="p">]:</span>
      <span class="n">score_for_Competition</span> <span class="o">+=</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">score_for_Competition</span>

<span class="n">score_for_Competition</span> <span class="o">=</span> <span class="n">feval_abs_sum</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="mi">34</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;score_for_Competition in Val_Dataset:&#39;</span><span class="p">,</span><span class="n">score_for_Competition</span><span class="p">)</span>
<span class="c1"># score_for_Competition in Val_Dataset: 1100,   Auto-sklearn不大行啊</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>score_for_Competition in Val_Dataset: 1100
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AutoGluon">AutoGluon<a class="anchor-link" href="#AutoGluon">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !sudo pip3 install setuptools wheel</span>
<span class="c1"># !sudo pip3 install -U &quot;mxnet&lt;2.0.0&quot;</span>
<span class="o">!</span>sudo pip3 install autogluon
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting autogluon
  Downloading https://files.pythonhosted.org/packages/89/38/1669479ce6a4760cd99d2ef7ffd450213bbce65c91202339cf716917bcf8/autogluon-0.2.0-py3-none-any.whl
Collecting autogluon.text==0.2.0
  Downloading https://files.pythonhosted.org/packages/fa/9b/b226cbb1574cb87149727b6b84baefd99e4b12210cecffdeb9c6a55d1e8b/autogluon.text-0.2.0-py3-none-any.whl (48kB)
     |████████████████████████████████| 51kB 7.3MB/s 
Collecting autogluon.tabular[all]==0.2.0
  Downloading https://files.pythonhosted.org/packages/10/9c/e879ef67abf232b8f582591d4ff774e60d41833332e49dc1a2d1b22e2d38/autogluon.tabular-0.2.0-py3-none-any.whl (250kB)
     |████████████████████████████████| 256kB 41.3MB/s 
Collecting autogluon.core==0.2.0
  Downloading https://files.pythonhosted.org/packages/be/4d/6e8e1eb195aa09c4f62dab87a4ff1d7cb5964369606e4fe91af0bf9c5ffa/autogluon.core-0.2.0-py3-none-any.whl (334kB)
     |████████████████████████████████| 337kB 50.6MB/s 
Collecting autogluon.features==0.2.0
  Downloading https://files.pythonhosted.org/packages/6b/a9/8277149a2517bba1e5e563e47ef1ebbf5fbe3da51342da67d6eef0580522/autogluon.features-0.2.0-py3-none-any.whl (48kB)
     |████████████████████████████████| 51kB 7.4MB/s 
Collecting autogluon.mxnet==0.2.0
  Downloading https://files.pythonhosted.org/packages/aa/ff/8f14f35051297c47a2383e51c1b8030b3a4dca1de94ca05c8f1b0611c28e/autogluon.mxnet-0.2.0-py3-none-any.whl
Collecting autogluon.extra==0.2.0
  Downloading https://files.pythonhosted.org/packages/ca/a4/1fd328c8187f15897e9b4cb7ef193bfe58aeca03a9621216291ff4f9a008/autogluon.extra-0.2.0-py3-none-any.whl
Collecting autogluon.vision==0.2.0
  Downloading https://files.pythonhosted.org/packages/32/5c/3fc553331d580ffb24a9003ab0edfa1ee83f87f6efc4345a0060b4a90f4c/autogluon.vision-0.2.0-py3-none-any.whl
Requirement already satisfied: pytest in /usr/local/lib/python3.7/dist-packages (from autogluon.text==0.2.0-&gt;autogluon) (3.6.4)
Requirement already satisfied: numpy==1.19.5 in /usr/local/lib/python3.7/dist-packages (from autogluon.text==0.2.0-&gt;autogluon) (1.19.5)
Requirement already satisfied: pandas&lt;2.0,&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from autogluon.text==0.2.0-&gt;autogluon) (1.1.5)
Collecting autogluon-contrib-nlp==0.0.1b20210201
  Downloading https://files.pythonhosted.org/packages/0a/22/29037f78a5b05b2749a89e19497d2498b7ba200921d482ee9bd99293f398/autogluon_contrib_nlp-0.0.1b20210201-py3-none-any.whl (157kB)
     |████████████████████████████████| 163kB 48.4MB/s 
Collecting scipy&lt;1.7,&gt;=1.5.4
  Downloading https://files.pythonhosted.org/packages/7d/e8/43ffca541d2f208d516296950b25fe1084b35c2881f4d444c1346ca75815/scipy-1.6.3-cp37-cp37m-manylinux1_x86_64.whl (27.4MB)
     |████████████████████████████████| 27.4MB 106kB/s 
Collecting scikit-learn&lt;0.25,&gt;=0.23.2
  Downloading https://files.pythonhosted.org/packages/a8/eb/a48f25c967526b66d5f1fa7a984594f0bf0a5afafa94a8c4dbc317744620/scikit_learn-0.24.2-cp37-cp37m-manylinux2010_x86_64.whl (22.3MB)
     |████████████████████████████████| 22.3MB 91kB/s 
Requirement already satisfied: pyarrow in /usr/local/lib/python3.7/dist-packages (from autogluon.text==0.2.0-&gt;autogluon) (3.0.0)
Requirement already satisfied: tqdm&gt;=4.38.0 in /usr/local/lib/python3.7/dist-packages (from autogluon.text==0.2.0-&gt;autogluon) (4.41.1)
Requirement already satisfied: networkx&lt;3.0,&gt;=2.3 in /usr/local/lib/python3.7/dist-packages (from autogluon.tabular[all]==0.2.0-&gt;autogluon) (2.5.1)
Collecting psutil&lt;5.9,&gt;=5.7.3
  Downloading https://files.pythonhosted.org/packages/84/da/f7efdcf012b51506938553dbe302aecc22f3f43abd5cffa8320e8e0588d5/psutil-5.8.0-cp37-cp37m-manylinux2010_x86_64.whl (296kB)
     |████████████████████████████████| 296kB 53.5MB/s 
Collecting fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;
  Downloading https://files.pythonhosted.org/packages/e8/79/e8a87e4c20238e114671314426227db8647d2b42744eab79e0917c59865e/fastai-2.3.1-py3-none-any.whl (194kB)
     |████████████████████████████████| 204kB 56.5MB/s 
Requirement already satisfied: torch&lt;2.0,&gt;=1.0; extra == &#34;all&#34; in /usr/local/lib/python3.7/dist-packages (from autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.8.1+cu101)
Collecting xgboost&lt;1.4,&gt;=1.3.2; extra == &#34;all&#34;
  Downloading https://files.pythonhosted.org/packages/2e/57/bf5026701c384decd2b995eb39d86587a103ba4eb26f8a9b1811db0896d3/xgboost-1.3.3-py3-none-manylinux2010_x86_64.whl (157.5MB)
     |████████████████████████████████| 157.5MB 87kB/s 
Collecting lightgbm&lt;4.0,&gt;=3.0; extra == &#34;all&#34;
  Downloading https://files.pythonhosted.org/packages/18/b2/fff8370f48549ce223f929fe8cab4ee6bf285a41f86037d91312b48ed95b/lightgbm-3.2.1-py3-none-manylinux1_x86_64.whl (2.0MB)
     |████████████████████████████████| 2.0MB 46.6MB/s 
Collecting catboost&lt;0.26,&gt;=0.24.0; extra == &#34;all&#34;
  Downloading https://files.pythonhosted.org/packages/47/80/8e9c57ec32dfed6ba2922bc5c96462cbf8596ce1a6f5de532ad1e43e53fe/catboost-0.25.1-cp37-none-manylinux1_x86_64.whl (67.3MB)
     |████████████████████████████████| 67.3MB 42kB/s 
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (3.2.2)
Collecting ConfigSpace==0.4.18
  Downloading https://files.pythonhosted.org/packages/a5/c3/3c21e8d82a639fd821f538e6d7f830b654a6ce1fe52644be1a67f323f707/ConfigSpace-0.4.18.tar.gz (950kB)
     |████████████████████████████████| 952kB 39.6MB/s 
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
    Preparing wheel metadata ... done
Requirement already satisfied: dask&gt;=2.6.0 in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (2.12.0)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (2.23.0)
Requirement already satisfied: autograd&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (1.3)
Collecting boto3
  Downloading https://files.pythonhosted.org/packages/52/2f/8cfc267a6bc33a50ea899462ca5d85bf583acb0880cb91e1e533a6271bd3/boto3-1.17.71-py2.py3-none-any.whl (131kB)
     |████████████████████████████████| 133kB 57.9MB/s 
Requirement already satisfied: cython in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (0.29.22)
Collecting graphviz&lt;0.9.0,&gt;=0.8.1
  Downloading https://files.pythonhosted.org/packages/53/39/4ab213673844e0c004bed8a0781a0721a3f6bb23eb8854ee75c236428892/graphviz-0.8.4-py2.py3-none-any.whl
Requirement already satisfied: dill==0.3.3 in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (0.3.3)
Collecting paramiko&gt;=2.4
  Downloading https://files.pythonhosted.org/packages/95/19/124e9287b43e6ff3ebb9cdea3e5e8e88475a873c05ccdf8b7e20d2c4201e/paramiko-2.7.2-py2.py3-none-any.whl (206kB)
     |████████████████████████████████| 215kB 59.4MB/s 
Collecting distributed&gt;=2.6.0
  Downloading https://files.pythonhosted.org/packages/63/f8/ac2c18adde6477bca3881c4d3cfa74c7f4da7ee82f3c83c201aa3b9ca5ee/distributed-2021.4.1-py3-none-any.whl (696kB)
     |████████████████████████████████| 706kB 53.1MB/s 
Requirement already satisfied: tornado&gt;=5.0.1 in /usr/local/lib/python3.7/dist-packages (from autogluon.core==0.2.0-&gt;autogluon) (5.1.1)
Collecting openml
  Downloading https://files.pythonhosted.org/packages/98/cf/17b76b80820fb1466c20ed1d25595744647db8956a43140fdfa614897489/openml-0.12.1.tar.gz (115kB)
     |████████████████████████████████| 122kB 54.8MB/s 
Requirement already satisfied: Pillow&lt;=8.1 in /usr/local/lib/python3.7/dist-packages (from autogluon.mxnet==0.2.0-&gt;autogluon) (7.1.2)
Collecting gluoncv&lt;0.11,&gt;=0.10.1.post0
  Downloading https://files.pythonhosted.org/packages/dd/2b/f1cc4e7a0a654c00dae9d870d0d1f653e5760ad85297306b63e6be527dcf/gluoncv-0.10.1.post0-py3-none-any.whl (1.1MB)
     |████████████████████████████████| 1.1MB 37.5MB/s 
Collecting d8&lt;1.0,&gt;=0.0.2
  Downloading https://files.pythonhosted.org/packages/5f/31/dbc20607856da42d84ba6a89e9146a100274a1e0ecd1814eb2c791d9d1d5/d8-0.0.2.post0-py3-none-any.whl
Requirement already satisfied: py&gt;=1.5.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (1.10.0)
Requirement already satisfied: six&gt;=1.10.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (1.15.0)
Requirement already satisfied: atomicwrites&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (1.4.0)
Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (56.1.0)
Requirement already satisfied: more-itertools&gt;=4.0.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (8.7.0)
Requirement already satisfied: pluggy&lt;0.8,&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (0.7.1)
Requirement already satisfied: attrs&gt;=17.4.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;autogluon.text==0.2.0-&gt;autogluon) (20.3.0)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&lt;2.0,&gt;=1.0.0-&gt;autogluon.text==0.2.0-&gt;autogluon) (2.8.1)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas&lt;2.0,&gt;=1.0.0-&gt;autogluon.text==0.2.0-&gt;autogluon) (2018.9)
Requirement already satisfied: regex in /usr/local/lib/python3.7/dist-packages (from autogluon-contrib-nlp==0.0.1b20210201-&gt;autogluon.text==0.2.0-&gt;autogluon) (2019.12.20)
Collecting sacrebleu
  Downloading https://files.pythonhosted.org/packages/7e/57/0c7ca4e31a126189dab99c19951910bd081dea5bbd25f24b77107750eae7/sacrebleu-1.5.1-py3-none-any.whl (54kB)
     |████████████████████████████████| 61kB 9.5MB/s 
Collecting sacremoses&gt;=0.0.38
  Downloading https://files.pythonhosted.org/packages/75/ee/67241dc87f266093c533a2d4d3d69438e57d7a90abb216fa076e7d475d4a/sacremoses-0.0.45-py3-none-any.whl (895kB)
     |████████████████████████████████| 901kB 48.1MB/s 
Collecting tokenizers==0.9.4
  Downloading https://files.pythonhosted.org/packages/fb/36/59e4a62254c5fcb43894c6b0e9403ec6f4238cc2422a003ed2e6279a1784/tokenizers-0.9.4-cp37-cp37m-manylinux2010_x86_64.whl (2.9MB)
     |████████████████████████████████| 2.9MB 41.6MB/s 
Collecting yacs&gt;=0.1.6
  Downloading https://files.pythonhosted.org/packages/38/4f/fe9a4d472aa867878ce3bb7efb16654c5d63672b86dc0e6e953a67018433/yacs-0.1.8-py3-none-any.whl
Collecting contextvars
  Downloading https://files.pythonhosted.org/packages/83/96/55b82d9f13763be9d672622e1b8106c85acb83edd7cc2fa5bc67cd9877e9/contextvars-2.4.tar.gz
Collecting flake8
  Downloading https://files.pythonhosted.org/packages/fc/80/35a0716e5d5101e643404dabd20f07f5528a21f3ef4032d31a49c913237b/flake8-3.9.2-py2.py3-none-any.whl (73kB)
     |████████████████████████████████| 81kB 12.0MB/s 
Collecting sentencepiece==0.1.95
  Downloading https://files.pythonhosted.org/packages/f5/99/e0808cb947ba10f575839c43e8fafc9cc44e4a7a2c8f79c60db48220a577/sentencepiece-0.1.95-cp37-cp37m-manylinux2014_x86_64.whl (1.2MB)
     |████████████████████████████████| 1.2MB 21.4MB/s 
Requirement already satisfied: protobuf in /usr/local/lib/python3.7/dist-packages (from autogluon-contrib-nlp==0.0.1b20210201-&gt;autogluon.text==0.2.0-&gt;autogluon) (3.12.4)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&lt;0.25,&gt;=0.23.2-&gt;autogluon.text==0.2.0-&gt;autogluon) (1.0.1)
Collecting threadpoolctl&gt;=2.0.0
  Downloading https://files.pythonhosted.org/packages/f7/12/ec3f2e203afa394a149911729357aa48affc59c20e2c1c8297a60f33f133/threadpoolctl-2.1.0-py3-none-any.whl
Requirement already satisfied: decorator&lt;5,&gt;=4.3 in /usr/local/lib/python3.7/dist-packages (from networkx&lt;3.0,&gt;=2.3-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (4.4.2)
Requirement already satisfied: torchvision&gt;=0.8.2 in /usr/local/lib/python3.7/dist-packages (from fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (0.9.1+cu101)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (20.9)
Requirement already satisfied: pip in /usr/local/lib/python3.7/dist-packages (from fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (19.3.1)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (3.13)
Requirement already satisfied: spacy&lt;4 in /usr/local/lib/python3.7/dist-packages (from fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (2.2.4)
Collecting fastcore&lt;1.4,&gt;=1.3.8
  Downloading https://files.pythonhosted.org/packages/d8/b0/f1fbf554e0bf3c76e1bdc3b82eedfe41fcf656479586be38c64421082b1b/fastcore-1.3.20-py3-none-any.whl (53kB)
     |████████████████████████████████| 61kB 9.6MB/s 
Requirement already satisfied: fastprogress&gt;=0.2.4 in /usr/local/lib/python3.7/dist-packages (from fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.0.0)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch&lt;2.0,&gt;=1.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (3.7.4.3)
Requirement already satisfied: wheel in /usr/local/lib/python3.7/dist-packages (from lightgbm&lt;4.0,&gt;=3.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (0.36.2)
Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from catboost&lt;0.26,&gt;=0.24.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (4.4.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;autogluon.core==0.2.0-&gt;autogluon) (1.3.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;autogluon.core==0.2.0-&gt;autogluon) (2.4.7)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;autogluon.core==0.2.0-&gt;autogluon) (0.10.0)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autogluon.core==0.2.0-&gt;autogluon) (2.10)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autogluon.core==0.2.0-&gt;autogluon) (1.24.3)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autogluon.core==0.2.0-&gt;autogluon) (3.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autogluon.core==0.2.0-&gt;autogluon) (2020.12.5)
Requirement already satisfied: future&gt;=0.15.2 in /usr/local/lib/python3.7/dist-packages (from autograd&gt;=1.3-&gt;autogluon.core==0.2.0-&gt;autogluon) (0.16.0)
Collecting botocore&lt;1.21.0,&gt;=1.20.71
  Downloading https://files.pythonhosted.org/packages/9d/7a/bcc46535f978318168fbc5d008c58141280939fea33dae12644b97ced403/botocore-1.20.71-py2.py3-none-any.whl (7.5MB)
     |████████████████████████████████| 7.5MB 45.8MB/s 
Collecting jmespath&lt;1.0.0,&gt;=0.7.1
  Downloading https://files.pythonhosted.org/packages/07/cb/5f001272b6faeb23c1c9e0acc04d48eaaf5c862c17709d20e3469c6e0139/jmespath-0.10.0-py2.py3-none-any.whl
Collecting s3transfer&lt;0.5.0,&gt;=0.4.0
  Downloading https://files.pythonhosted.org/packages/63/d0/693477c688348654ddc21dcdce0817653a294aa43f41771084c25e7ff9c7/s3transfer-0.4.2-py2.py3-none-any.whl (79kB)
     |████████████████████████████████| 81kB 12.9MB/s 
Collecting pynacl&gt;=1.0.1
  Downloading https://files.pythonhosted.org/packages/9d/57/2f5e6226a674b2bcb6db531e8b383079b678df5b10cdaa610d6cf20d77ba/PyNaCl-1.4.0-cp35-abi3-manylinux1_x86_64.whl (961kB)
     |████████████████████████████████| 962kB 44.4MB/s 
Collecting cryptography&gt;=2.5
  Downloading https://files.pythonhosted.org/packages/b2/26/7af637e6a7e87258b963f1731c5982fb31cd507f0d90d91836e446955d02/cryptography-3.4.7-cp36-abi3-manylinux2014_x86_64.whl (3.2MB)
     |████████████████████████████████| 3.2MB 46.1MB/s 
Collecting bcrypt&gt;=3.1.3
  Downloading https://files.pythonhosted.org/packages/26/70/6d218afbe4c73538053c1016dd631e8f25fffc10cd01f5c272d7acf3c03d/bcrypt-3.2.0-cp36-abi3-manylinux2010_x86_64.whl (63kB)
     |████████████████████████████████| 71kB 10.8MB/s 
Requirement already satisfied: click&gt;=6.6 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (7.1.2)
Requirement already satisfied: msgpack&gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (1.0.2)
Requirement already satisfied: tblib&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (1.7.0)
Requirement already satisfied: toolz&gt;=0.8.2 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (0.11.1)
Collecting cloudpickle&gt;=1.5.0
  Downloading https://files.pythonhosted.org/packages/e7/e3/898487e5dbeb612054cf2e0c188463acb358167fef749c53c8bb8918cea1/cloudpickle-1.6.0-py3-none-any.whl
Requirement already satisfied: sortedcontainers!=2.0.0,!=2.0.1 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (2.3.0)
Requirement already satisfied: zict&gt;=0.1.3 in /usr/local/lib/python3.7/dist-packages (from distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (2.0.0)
Collecting liac-arff&gt;=2.4.0
  Downloading https://files.pythonhosted.org/packages/6e/43/73944aa5ad2b3185c0f0ba0ee6f73277f2eb51782ca6ccf3e6793caf209a/liac-arff-2.5.0.tar.gz
Collecting xmltodict
  Downloading https://files.pythonhosted.org/packages/28/fd/30d5c1d3ac29ce229f6bdc40bbc20b28f716e8b363140c26eff19122d8a5/xmltodict-0.12.0-py2.py3-none-any.whl
Collecting minio
  Downloading https://files.pythonhosted.org/packages/5f/c9/09761948bb0c73e08e803dfc616e2f3829a790349ba18dcffdf6a4608f2d/minio-7.0.3-py3-none-any.whl (75kB)
     |████████████████████████████████| 81kB 12.3MB/s 
Collecting portalocker
  Downloading https://files.pythonhosted.org/packages/68/33/cb524f4de298509927b90aa5ee34767b9a2b93e663cf354b2a3efa2b4acd/portalocker-2.3.0-py2.py3-none-any.whl
Collecting tensorboardx
  Downloading https://files.pythonhosted.org/packages/07/84/46421bd3e0e89a92682b1a38b40efc22dafb6d8e3d947e4ceefd4a5fabc7/tensorboardX-2.2-py2.py3-none-any.whl (120kB)
     |████████████████████████████████| 122kB 59.6MB/s 
Collecting decord
  Downloading https://files.pythonhosted.org/packages/64/5e/e2be6a3a3a46275059574d9c6a1d422aa6c7c3cbf6614939b8a3c3f8f2d5/decord-0.5.2-py3-none-manylinux2010_x86_64.whl (14.1MB)
     |████████████████████████████████| 14.1MB 223kB/s 
Collecting autocfg
  Downloading https://files.pythonhosted.org/packages/95/f9/74e0a42cbc6d871c92288806e7812c7d2628c2a06557930dbab0a17438d2/autocfg-0.0.8-py3-none-any.whl
Requirement already satisfied: opencv-python in /usr/local/lib/python3.7/dist-packages (from gluoncv&lt;0.11,&gt;=0.10.1.post0-&gt;autogluon.extra==0.2.0-&gt;autogluon) (4.1.2.30)
Collecting xxhash
  Downloading https://files.pythonhosted.org/packages/7d/4f/0a862cad26aa2ed7a7cd87178cbbfa824fc1383e472d63596a0d018374e7/xxhash-2.0.2-cp37-cp37m-manylinux2010_x86_64.whl (243kB)
     |████████████████████████████████| 245kB 52.6MB/s 
Requirement already satisfied: kaggle in /usr/local/lib/python3.7/dist-packages (from d8&lt;1.0,&gt;=0.0.2-&gt;autogluon.vision==0.2.0-&gt;autogluon) (1.5.12)
Collecting immutables&gt;=0.9
  Downloading https://files.pythonhosted.org/packages/ab/46/d2feb89eb17c981208037cfeeadb854ce066a5a23d0aba616afd9dfa0c05/immutables-0.15-cp37-cp37m-manylinux1_x86_64.whl (101kB)
     |████████████████████████████████| 102kB 14.4MB/s 
Collecting pycodestyle&lt;2.8.0,&gt;=2.7.0
  Downloading https://files.pythonhosted.org/packages/de/cc/227251b1471f129bc35e966bb0fceb005969023926d744139642d847b7ae/pycodestyle-2.7.0-py2.py3-none-any.whl (41kB)
     |████████████████████████████████| 51kB 8.9MB/s 
Requirement already satisfied: importlib-metadata; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.7/dist-packages (from flake8-&gt;autogluon-contrib-nlp==0.0.1b20210201-&gt;autogluon.text==0.2.0-&gt;autogluon) (3.10.1)
Collecting mccabe&lt;0.7.0,&gt;=0.6.0
  Downloading https://files.pythonhosted.org/packages/87/89/479dc97e18549e21354893e4ee4ef36db1d237534982482c3681ee6e7b57/mccabe-0.6.1-py2.py3-none-any.whl
Collecting pyflakes&lt;2.4.0,&gt;=2.3.0
  Downloading https://files.pythonhosted.org/packages/6c/11/2a745612f1d3cbbd9c69ba14b1b43a35a2f5c3c81cd0124508c52c64307f/pyflakes-2.3.1-py2.py3-none-any.whl (68kB)
     |████████████████████████████████| 71kB 11.4MB/s 
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (2.0.5)
Requirement already satisfied: plac&lt;1.2.0,&gt;=0.9.6 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.1.3)
Requirement already satisfied: wasabi&lt;1.1.0,&gt;=0.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (0.8.2)
Requirement already satisfied: srsly&lt;1.1.0,&gt;=1.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.0.5)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.0.5)
Requirement already satisfied: catalogue&lt;1.1.0,&gt;=0.0.7 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.0.0)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (3.0.5)
Requirement already satisfied: thinc==7.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (7.4.0)
Requirement already satisfied: blis&lt;0.5.0,&gt;=0.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;4-&gt;fastai&lt;3.0,&gt;=2.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (0.4.1)
Requirement already satisfied: retrying&gt;=1.3.3 in /usr/local/lib/python3.7/dist-packages (from plotly-&gt;catboost&lt;0.26,&gt;=0.24.0; extra == &#34;all&#34;-&gt;autogluon.tabular[all]==0.2.0-&gt;autogluon) (1.3.3)
Requirement already satisfied: cffi&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from pynacl&gt;=1.0.1-&gt;paramiko&gt;=2.4-&gt;autogluon.core==0.2.0-&gt;autogluon) (1.14.5)
Requirement already satisfied: heapdict in /usr/local/lib/python3.7/dist-packages (from zict&gt;=0.1.3-&gt;distributed&gt;=2.6.0-&gt;autogluon.core==0.2.0-&gt;autogluon) (1.0.1)
Requirement already satisfied: python-slugify in /usr/local/lib/python3.7/dist-packages (from kaggle-&gt;d8&lt;1.0,&gt;=0.0.2-&gt;autogluon.vision==0.2.0-&gt;autogluon) (4.0.1)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version &lt; &#34;3.8&#34;-&gt;flake8-&gt;autogluon-contrib-nlp==0.0.1b20210201-&gt;autogluon.text==0.2.0-&gt;autogluon) (3.4.1)
Requirement already satisfied: pycparser in /usr/local/lib/python3.7/dist-packages (from cffi&gt;=1.4.1-&gt;pynacl&gt;=1.0.1-&gt;paramiko&gt;=2.4-&gt;autogluon.core==0.2.0-&gt;autogluon) (2.20)
Requirement already satisfied: text-unidecode&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from python-slugify-&gt;kaggle-&gt;d8&lt;1.0,&gt;=0.0.2-&gt;autogluon.vision==0.2.0-&gt;autogluon) (1.3)
Building wheels for collected packages: ConfigSpace
  Building wheel for ConfigSpace (PEP 517) ... done
  Created wheel for ConfigSpace: filename=ConfigSpace-0.4.18-cp37-cp37m-linux_x86_64.whl size=2879815 sha256=5c20681cf09c2a145b991a83ecdf81bf13c16acc1683aa9771f7be043213d36f
  Stored in directory: /root/.cache/pip/wheels/39/ea/40/d93931850f700427db0a84180829c709d30484c9475040c7bd
Successfully built ConfigSpace
Building wheels for collected packages: openml, contextvars, liac-arff
  Building wheel for openml (setup.py) ... done
  Created wheel for openml: filename=openml-0.12.1-cp37-none-any.whl size=132141 sha256=faf7923f20b6961129db10793c26b485bba6640c93399c076ad83c05f2805f84
  Stored in directory: /root/.cache/pip/wheels/bc/1d/f9/a92b9c9d0f73772df4b9c2cdd367b706e595f67816dbefd032
  Building wheel for contextvars (setup.py) ... done
  Created wheel for contextvars: filename=contextvars-2.4-cp37-none-any.whl size=7667 sha256=3c2ca9ed9ea9e6f7e6a977461db8e67a0ae775f6c550a75ab4bc06a3d4a44bb1
  Stored in directory: /root/.cache/pip/wheels/a5/7d/68/1ebae2668bda2228686e3c1cf16f2c2384cea6e9334ad5f6de
  Building wheel for liac-arff (setup.py) ... done
  Created wheel for liac-arff: filename=liac_arff-2.5.0-cp37-none-any.whl size=11732 sha256=b9421b521b9584adc605267d5de5a5d0c24656b71786dedbe8a6a0f8ef495072
  Stored in directory: /root/.cache/pip/wheels/77/8d/b4/8bfce5beea9a3496cc15b24961876adb7b6e2912ff09164179
Successfully built openml contextvars liac-arff
<span class="ansi-red-fg">ERROR: distributed 2021.4.1 has requirement dask&gt;=2021.03.0, but you&#39;ll have dask 2.12.0 which is incompatible.</span>
<span class="ansi-red-fg">ERROR: albumentations 0.1.12 has requirement imgaug&lt;0.2.7,&gt;=0.2.5, but you&#39;ll have imgaug 0.2.9 which is incompatible.</span>
<span class="ansi-red-fg">ERROR: sacrebleu 1.5.1 has requirement portalocker==2.0.0, but you&#39;ll have portalocker 2.3.0 which is incompatible.</span>
<span class="ansi-red-fg">ERROR: botocore 1.20.71 has requirement urllib3&lt;1.27,&gt;=1.25.4, but you&#39;ll have urllib3 1.24.3 which is incompatible.</span>
Installing collected packages: portalocker, sacrebleu, sacremoses, tokenizers, yacs, immutables, contextvars, pycodestyle, mccabe, pyflakes, flake8, sentencepiece, autogluon-contrib-nlp, scipy, ConfigSpace, jmespath, botocore, s3transfer, boto3, graphviz, threadpoolctl, scikit-learn, pynacl, cryptography, bcrypt, paramiko, psutil, cloudpickle, distributed, autogluon.core, liac-arff, xmltodict, minio, openml, autogluon.mxnet, autogluon.text, autogluon.features, fastcore, fastai, xgboost, lightgbm, catboost, autogluon.tabular, tensorboardx, decord, autocfg, gluoncv, autogluon.extra, xxhash, d8, autogluon.vision, autogluon
  Found existing installation: scipy 1.4.1
    Uninstalling scipy-1.4.1:
      Successfully uninstalled scipy-1.4.1
  Found existing installation: graphviz 0.10.1
    Uninstalling graphviz-0.10.1:
      Successfully uninstalled graphviz-0.10.1
  Found existing installation: scikit-learn 0.22.2.post1
    Uninstalling scikit-learn-0.22.2.post1:
      Successfully uninstalled scikit-learn-0.22.2.post1
  Found existing installation: psutil 5.4.8
    Uninstalling psutil-5.4.8:
      Successfully uninstalled psutil-5.4.8
  Found existing installation: cloudpickle 1.3.0
    Uninstalling cloudpickle-1.3.0:
      Successfully uninstalled cloudpickle-1.3.0
  Found existing installation: distributed 1.25.3
    Uninstalling distributed-1.25.3:
      Successfully uninstalled distributed-1.25.3
  Found existing installation: fastai 1.0.61
    Uninstalling fastai-1.0.61:
      Successfully uninstalled fastai-1.0.61
  Found existing installation: xgboost 0.90
    Uninstalling xgboost-0.90:
      Successfully uninstalled xgboost-0.90
  Found existing installation: lightgbm 2.2.3
    Uninstalling lightgbm-2.2.3:
      Successfully uninstalled lightgbm-2.2.3
Successfully installed ConfigSpace-0.4.18 autocfg-0.0.8 autogluon-0.2.0 autogluon-contrib-nlp-0.0.1b20210201 autogluon.core-0.2.0 autogluon.extra-0.2.0 autogluon.features-0.2.0 autogluon.mxnet-0.2.0 autogluon.tabular-0.2.0 autogluon.text-0.2.0 autogluon.vision-0.2.0 bcrypt-3.2.0 boto3-1.17.71 botocore-1.20.71 catboost-0.25.1 cloudpickle-1.6.0 contextvars-2.4 cryptography-3.4.7 d8-0.0.2.post0 decord-0.5.2 distributed-2021.4.1 fastai-2.3.1 fastcore-1.3.20 flake8-3.9.2 gluoncv-0.10.1.post0 graphviz-0.8.4 immutables-0.15 jmespath-0.10.0 liac-arff-2.5.0 lightgbm-3.2.1 mccabe-0.6.1 minio-7.0.3 openml-0.12.1 paramiko-2.7.2 portalocker-2.3.0 psutil-5.8.0 pycodestyle-2.7.0 pyflakes-2.3.1 pynacl-1.4.0 s3transfer-0.4.2 sacrebleu-1.5.1 sacremoses-0.0.45 scikit-learn-0.24.2 scipy-1.6.3 sentencepiece-0.1.95 tensorboardx-2.2 threadpoolctl-2.1.0 tokenizers-0.9.4 xgboost-1.3.3 xmltodict-0.12.0 xxhash-2.0.2 yacs-0.1.8
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip3 show autogluon
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Name: autogluon
Version: 0.2.0
Summary: AutoML for Text, Image, and Tabular Data
Home-page: https://github.com/awslabs/autogluon
Author: AutoGluon Community
Author-email: None
License: Apache-2.0
Location: /usr/local/lib/python3.7/dist-packages
Requires: autogluon.text, autogluon.mxnet, autogluon.features, autogluon.core, autogluon.extra, autogluon.tabular, autogluon.vision
Required-by: 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python3
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example">Example<a class="anchor-link" href="#Example">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !pip3 show dask</span>
<span class="c1"># from dask.utils import stringify</span>
<span class="o">!</span>bash
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>/bin/bash: shell: command not found
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">autogluon.tabular</span> <span class="k">import</span> <span class="n">TabularDataset</span><span class="p">,</span> <span class="n">TabularPredictor</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">TabularDataset</span><span class="p">(</span><span class="s1">&#39;https://autogluon.s3.amazonaws.com/datasets/Inc/train.csv&#39;</span><span class="p">)</span>
<span class="n">subsample_size</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># subsample subset of data for faster demo, try setting this to much larger values</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">subsample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;class&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summary of class variable: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save_path = &#39;agModels-predictClass&#39;  # specifies folder to store trained models</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>  <span class="c1"># , path=save_path</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="n">TabularDataset</span><span class="p">(</span><span class="s1">&#39;https://autogluon.s3.amazonaws.com/datasets/Inc/test.csv&#39;</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>  <span class="c1"># values to predict</span>
<span class="n">test_data_nolab</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>  <span class="c1"># delete label column to prove we&#39;re not cheating</span>
<span class="n">test_data_nolab</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">fit_summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AutoGluon infers problem type is: &quot;</span><span class="p">,</span> <span class="n">predictor</span><span class="o">.</span><span class="n">problem_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AutoGluon identified the following types of features:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictor</span><span class="o">.</span><span class="n">feature_metadata</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;LightGBM&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred_probs</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data_nolab</span><span class="p">)</span>
<span class="n">pred_probs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CLF_of_ECG">CLF_of_ECG<a class="anchor-link" href="#CLF_of_ECG">&#182;</a></h3><p>使用AutoML方法得到的结果评分为328。位次还可以，应该将这个数值看作AutoML的baseline，不必要在机器学习上花太多时间，毕竟当数据量达到一定程度，深度学习模型基本可以碾压机器学习模型。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">autogluon.tabular</span> <span class="k">import</span> <span class="n">TabularDataset</span><span class="p">,</span> <span class="n">TabularPredictor</span>
 
<span class="n">data_train_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/features_labels.csv&#39;</span>
 
<span class="n">model_save_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/Shareddrives/xucc1993.HK(CRN.NGO)/CLF_of_ECG_signals/AutoML-AutoDL/agModels-predictClass&#39;</span>
 
<span class="n">data_train</span> <span class="o">=</span> <span class="n">TabularDataset</span><span class="p">(</span><span class="n">data_train_path</span><span class="p">)</span>
 
<span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;label&#39;</span>
 
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">model_save_path</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train</span><span class="p">)</span>
 
<span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">fit_summary</span><span class="p">()</span>
 
<span class="c1"># print(predictor.feature_metadata)</span>
 
<span class="c1"># predictor.predict(X_val, model=&#39;LightGBM&#39;)</span>
 
<span class="c1"># predictor.leaderboard(test_data, silent=True)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Loaded data from: /content/drive/MyDrive/CLF_of_ECG_signals/Data/X_train.csv | Columns = 206 / 206 | Rows = 75000 -&gt; 75000
Loaded data from: /content/drive/MyDrive/CLF_of_ECG_signals/Data/y_train.csv | Columns = 2 / 2 | Rows = 75000 -&gt; 75000
Loaded data from: /content/drive/MyDrive/CLF_of_ECG_signals/Data/features_labels.csv | Columns = 208 / 208 | Rows = 100000 -&gt; 100000
No path specified. Models will be saved in: &#34;AutogluonModels/ag-20210511_030204/&#34;
Beginning AutoGluon training ...
AutoGluon will save models to &#34;AutogluonModels/ag-20210511_030204/&#34;
AutoGluon Version:  0.2.0
Train Data Rows:    100000
Train Data Columns: 207
Preprocessing data ...
AutoGluon infers your prediction problem is: &#39;multiclass&#39; (because dtype of label-column == float, but few unique label-values observed and label-values can be converted to int).
	4 unique label values:  [0.0, 2.0, 3.0, 1.0]
	If &#39;multiclass&#39; is not the correct problem_type, please manually specify the problem_type argument in fit() (You may specify problem_type as one of: [&#39;binary&#39;, &#39;multiclass&#39;, &#39;regression&#39;])
Train Data Class Count: 4
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    11780.44 MB
	Train Data (Original)  Memory Usage: 165.6 MB (1.4% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;float&#39;, []) : 206 | [&#39;id&#39;, &#39;s_0&#39;, &#39;s_1&#39;, &#39;s_2&#39;, &#39;s_3&#39;, ...]
		(&#39;int&#39;, [])   :   1 | [&#39;Unnamed: 0&#39;]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;float&#39;, []) : 206 | [&#39;id&#39;, &#39;s_0&#39;, &#39;s_1&#39;, &#39;s_2&#39;, &#39;s_3&#39;, ...]
		(&#39;int&#39;, [])   :   1 | [&#39;Unnamed: 0&#39;]
	1.7s = Fit runtime
	207 features in original data used to generate 207 features in processed data.
	Train Data (Processed) Memory Usage: 165.6 MB (1.4% of available memory)
Data preprocessing and feature engineering runtime = 2.04s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;accuracy&#39;
	To change this, specify the eval_metric argument of fit()
Automatically generating train/validation split with holdout_frac=0.025, Train Rows: 97500, Val Rows: 2500
Fitting model: KNeighborsUnif ...
	0.6072	 = Validation accuracy score
	0.19s	 = Training runtime
	10.03s	 = Validation runtime
Fitting model: KNeighborsDist ...
	0.5912	 = Validation accuracy score
	0.14s	 = Training runtime
	9.51s	 = Validation runtime
Fitting model: NeuralNetFastAI ...
	0.9924	 = Validation accuracy score
	104.11s	 = Training runtime
	0.11s	 = Validation runtime
Fitting model: LightGBMXT ...
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[1000]	train_set&#39;s multi_error: 0	valid_set&#39;s multi_error: 0.008
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>	0.9924	 = Validation accuracy score
	269.3s	 = Training runtime
	0.56s	 = Validation runtime
Fitting model: LightGBM ...
	0.9832	 = Validation accuracy score
	81.61s	 = Training runtime
	0.13s	 = Validation runtime
Fitting model: RandomForestGini ...
	0.9836	 = Validation accuracy score
	227.73s	 = Training runtime
	0.21s	 = Validation runtime
Fitting model: RandomForestEntr ...
	0.9852	 = Validation accuracy score
	244.89s	 = Training runtime
	0.21s	 = Validation runtime
Fitting model: CatBoost ...
	0.9628	 = Validation accuracy score
	106.97s	 = Training runtime
	0.01s	 = Validation runtime
Fitting model: ExtraTreesGini ...
	0.9844	 = Validation accuracy score
	46.43s	 = Training runtime
	0.21s	 = Validation runtime
Fitting model: ExtraTreesEntr ...
	0.9848	 = Validation accuracy score
	41.34s	 = Training runtime
	0.21s	 = Validation runtime
Fitting model: XGBoost ...
	0.98	 = Validation accuracy score
	1028.35s	 = Training runtime
	0.16s	 = Validation runtime
Fitting model: NeuralNetMXNet ...
	0.9932	 = Validation accuracy score
	779.5s	 = Training runtime
	0.57s	 = Validation runtime
Fitting model: LightGBMLarge ...
	0.9856	 = Validation accuracy score
	98.24s	 = Training runtime
	0.11s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ...
	0.9948	 = Validation accuracy score
	0.71s	 = Training runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 3089.44s ...
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&#34;AutogluonModels/ag-20210511_030204/&#34;)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>*** Summary of fit() ***
Estimated performance of each model:
                  model  score_val  pred_time_val     fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0   WeightedEnsemble_L2     0.9948       1.134994  1049.509962                0.003901           0.711680            2       True         14
1        NeuralNetMXNet     0.9932       0.573963   779.497032                0.573963         779.497032            1       True         12
2       NeuralNetFastAI     0.9924       0.110950   104.107766                0.110950         104.107766            1       True          3
3            LightGBMXT     0.9924       0.557130   269.301250                0.557130         269.301250            1       True          4
4         LightGBMLarge     0.9856       0.106029    98.238721                0.106029          98.238721            1       True         13
5      RandomForestEntr     0.9852       0.206998   244.889860                0.206998         244.889860            1       True          7
6        ExtraTreesEntr     0.9848       0.207398    41.340098                0.207398          41.340098            1       True         10
7        ExtraTreesGini     0.9844       0.206226    46.431425                0.206226          46.431425            1       True          9
8      RandomForestGini     0.9836       0.206634   227.733884                0.206634         227.733884            1       True          6
9              LightGBM     0.9832       0.131136    81.605152                0.131136          81.605152            1       True          5
10              XGBoost     0.9800       0.155610  1028.349480                0.155610        1028.349480            1       True         11
11             CatBoost     0.9628       0.011319   106.974802                0.011319         106.974802            1       True          8
12       KNeighborsUnif     0.6072      10.027151     0.194257               10.027151           0.194257            1       True          1
13       KNeighborsDist     0.5912       9.513411     0.138659                9.513411           0.138659            1       True          2
Number of models trained: 14
Types of models trained:
{&#39;LGBModel&#39;, &#39;RFModel&#39;, &#39;KNNModel&#39;, &#39;CatBoostModel&#39;, &#39;XGBoostModel&#39;, &#39;WeightedEnsembleModel&#39;, &#39;TabularNeuralNetModel&#39;, &#39;XTModel&#39;, &#39;NNFastAiTabularModel&#39;}
Bagging used: False 
Multi-layer stack-ensembling used: False 
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;float&#39;, []) : 206 | [&#39;id&#39;, &#39;s_0&#39;, &#39;s_1&#39;, &#39;s_2&#39;, &#39;s_3&#39;, ...]
(&#39;int&#39;, [])   :   1 | [&#39;Unnamed: 0&#39;]
Plot summary of models saved to file: AutogluonModels/ag-20210511_030204/SummaryOfModels.html
*** End of fit() summary ***
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 加载已有模型</span>
<span class="kn">from</span> <span class="nn">autogluon.tabular</span> <span class="k">import</span> <span class="n">TabularDataset</span><span class="p">,</span> <span class="n">TabularPredictor</span>
<span class="n">model_save_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/Shareddrives/xucc1993.HK(CRN.NGO)/CLF_of_ECG_signals/AutoML-AutoDL/agModels-predictClass&#39;</span>

<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_save_path</span><span class="p">)</span>  <span class="c1"># unnecessary, just demonstrates how to load previously-trained predictor from file</span>

<span class="n">data_test_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/features_X_test.csv&#39;</span>
<span class="c1"># id = &#39;id&#39;</span>
<span class="n">data_test</span> <span class="o">=</span> <span class="n">TabularDataset</span><span class="p">(</span><span class="n">data_test_path</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions:  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="c1"># perf = predictor.evaluate_predictions(y_true=y_test, y_pred=y_pred, auxiliary_metrics=True)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fsspec/__init__.py:47: DeprecationWarning: SelectableGroups dict interface is deprecated. Use select.
  for spec in entry_points.get(&#34;fsspec.specs&#34;, []):
/usr/local/lib/python3.7/dist-packages/_pytest/mark/structures.py:426: DeprecationWarning: The usage of `cmp` is deprecated and will be removed on or after 2021-06-01.  Please use `eq` and `order` instead.
  @attr.s(cmp=False, hash=False)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Predictions:  
 0        0.0
1        2.0
2        3.0
3        0.0
4        0.0
        ... 
19995    0.0
19996    0.0
19997    2.0
19998    0.0
19999    0.0
Name: label, Length: 20000, dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># type(y_pred)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1. 0. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]
 ...
 [0. 0. 1. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>
<span class="n">y_preds_subm</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">values</span>
<span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">y_preds_subm</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_preds_subm</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_preds_subm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_preds_subm</span><span class="p">)</span>

<span class="n">result</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/sample_submit.csv&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_1&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;label_3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y_preds_subm</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Result_Submission/submit.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># 最终提交得分为328，非常不错了</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1. 0. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]
 ...
 [0. 0. 1. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
           id  label_0  label_1  label_2  label_3
0      100000      1.0      0.0      0.0      0.0
1      100001      0.0      0.0      1.0      0.0
2      100002      0.0      0.0      0.0      1.0
3      100003      1.0      0.0      0.0      0.0
4      100004      1.0      0.0      0.0      0.0
...       ...      ...      ...      ...      ...
19995  119995      1.0      0.0      0.0      0.0
19996  119996      1.0      0.0      0.0      0.0
19997  119997      0.0      0.0      1.0      0.0
19998  119998      1.0      0.0      0.0      0.0
19999  119999      1.0      0.0      0.0      0.0

[20000 rows x 5 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !sudo pip3 show autogluon</span>
<span class="c1"># !sudo pip3 install autogluon</span>
<span class="c1"># !sudo pip3 install dask --upgrade</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Name: autogluon
Version: 0.2.0
Summary: AutoML for Text, Image, and Tabular Data
Home-page: https://github.com/awslabs/autogluon
Author: AutoGluon Community
Author-email: None
License: Apache-2.0
Location: /usr/local/lib/python3.7/dist-packages
Requires: autogluon.core, autogluon.vision, autogluon.features, autogluon.text, autogluon.extra, autogluon.tabular, autogluon.mxnet
Required-by: 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AutoKeras">AutoKeras<a class="anchor-link" href="#AutoKeras">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>sudo pip3 install autokeras
<span class="c1"># !pip3 show autokeras</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting autokeras
  Downloading https://files.pythonhosted.org/packages/09/12/cf698586ccc8245f08d1843dcafb65b064a2e9e2923b889dc58e1019f099/autokeras-1.0.12-py3-none-any.whl (164kB)
     |████████████████████████████████| 174kB 7.4MB/s 
Requirement already satisfied: tensorflow&gt;=2.3.0 in /usr/local/lib/python3.7/dist-packages (from autokeras) (2.4.1)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (from autokeras) (0.24.2)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from autokeras) (20.9)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from autokeras) (1.1.5)
Collecting keras-tuner&gt;=1.0.2
  Downloading https://files.pythonhosted.org/packages/20/ec/1ef246787174b1e2bb591c95f29d3c1310070cad877824f907faba3dade9/keras-tuner-1.0.2.tar.gz (62kB)
     |████████████████████████████████| 71kB 9.5MB/s 
Requirement already satisfied: opt-einsum~=3.3.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (3.3.0)
Requirement already satisfied: wheel~=0.35 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (0.36.2)
Requirement already satisfied: absl-py~=0.10 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (0.12.0)
Requirement already satisfied: flatbuffers~=1.12.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.12)
Requirement already satisfied: google-pasta~=0.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (0.2.0)
Requirement already satisfied: numpy~=1.19.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.19.5)
Requirement already satisfied: astunparse~=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.6.3)
Requirement already satisfied: termcolor~=1.1.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.1.0)
Requirement already satisfied: h5py~=2.10.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (2.10.0)
Requirement already satisfied: tensorboard~=2.4 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (2.4.1)
Requirement already satisfied: protobuf&gt;=3.9.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (3.12.4)
Requirement already satisfied: gast==0.3.3 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (0.3.3)
Requirement already satisfied: wrapt~=1.12.1 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.12.1)
Requirement already satisfied: keras-preprocessing~=1.1.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.1.2)
Requirement already satisfied: grpcio~=1.32.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.32.0)
Requirement already satisfied: six~=1.15.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (1.15.0)
Requirement already satisfied: typing-extensions~=3.7.4 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (3.7.4.3)
Requirement already satisfied: tensorflow-estimator&lt;2.5.0,&gt;=2.4.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=2.3.0-&gt;autokeras) (2.4.0)
Requirement already satisfied: scipy&gt;=0.19.1 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;autokeras) (1.6.3)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;autokeras) (1.0.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;autokeras) (2.1.0)
Requirement already satisfied: pyparsing&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging-&gt;autokeras) (2.4.7)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;autokeras) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;autokeras) (2.8.1)
Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from keras-tuner&gt;=1.0.2-&gt;autokeras) (0.16.0)
Requirement already satisfied: tabulate in /usr/local/lib/python3.7/dist-packages (from keras-tuner&gt;=1.0.2-&gt;autokeras) (0.8.9)
Collecting terminaltables
  Downloading https://files.pythonhosted.org/packages/9b/c4/4a21174f32f8a7e1104798c445dacdc1d4df86f2f26722767034e4de4bff/terminaltables-3.1.0.tar.gz
Collecting colorama
  Downloading https://files.pythonhosted.org/packages/44/98/5b86278fbbf250d239ae0ecb724f8572af1c91f4a11edf4d36a206189440/colorama-0.4.4-py2.py3-none-any.whl
Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from keras-tuner&gt;=1.0.2-&gt;autokeras) (4.41.1)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from keras-tuner&gt;=1.0.2-&gt;autokeras) (2.23.0)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (1.8.0)
Requirement already satisfied: werkzeug&gt;=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (1.0.1)
Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (0.4.4)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (3.3.4)
Requirement already satisfied: setuptools&gt;=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (56.1.0)
Requirement already satisfied: google-auth&lt;2,&gt;=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (1.28.1)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;keras-tuner&gt;=1.0.2-&gt;autokeras) (2.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;keras-tuner&gt;=1.0.2-&gt;autokeras) (2020.12.5)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;keras-tuner&gt;=1.0.2-&gt;autokeras) (1.24.3)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;keras-tuner&gt;=1.0.2-&gt;autokeras) (3.0.4)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.7/dist-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (1.3.0)
Requirement already satisfied: importlib-metadata; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.7/dist-packages (from markdown&gt;=2.6.8-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (3.10.1)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4; python_version &gt;= &#34;3.6&#34; in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (4.7.2)
Requirement already satisfied: cachetools&lt;5.0,&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (4.2.1)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (0.2.8)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.7/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (3.1.0)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version &lt; &#34;3.8&#34;-&gt;markdown&gt;=2.6.8-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (3.4.1)
Requirement already satisfied: pyasn1&gt;=0.1.3 in /usr/local/lib/python3.7/dist-packages (from rsa&lt;5,&gt;=3.1.4; python_version &gt;= &#34;3.6&#34;-&gt;google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.3.0-&gt;autokeras) (0.4.8)
Building wheels for collected packages: keras-tuner, terminaltables
  Building wheel for keras-tuner (setup.py) ... done
  Created wheel for keras-tuner: filename=keras_tuner-1.0.2-cp37-none-any.whl size=78938 sha256=5f98e61043ff6be3d2ec6399fa315629021e1ba8f699766f9c49e0c436fa0ecd
  Stored in directory: /root/.cache/pip/wheels/bb/a1/8a/7c3de0efb3707a1701b36ebbfdbc4e67aedf6d4943a1f463d6
  Building wheel for terminaltables (setup.py) ... done
  Created wheel for terminaltables: filename=terminaltables-3.1.0-cp37-none-any.whl size=15356 sha256=7151631a93875c67fea26e91e38abb19cd545aaf86f781033658f174a07ef2fc
  Stored in directory: /root/.cache/pip/wheels/30/6b/50/6c75775b681fb36cdfac7f19799888ef9d8813aff9e379663e
Successfully built keras-tuner terminaltables
Installing collected packages: terminaltables, colorama, keras-tuner, autokeras
Successfully installed autokeras-1.0.12 colorama-0.4.4 keras-tuner-1.0.2 terminaltables-3.1.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>sudo pip3 install emcee
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting emcee
  Downloading https://files.pythonhosted.org/packages/97/f4/00151f5f843088337c6a53edd6cbb2df340f1044d23080c662f95219cc3f/emcee-3.0.2-py2.py3-none-any.whl (41kB)
     |████████████████████████████████| 51kB 4.5MB/s 
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from emcee) (1.19.5)
Installing collected packages: emcee
Successfully installed emcee-3.0.2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CLF_of_ECG">CLF_of_ECG<a class="anchor-link" href="#CLF_of_ECG">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 划分X_train, X_val, y_train, y_val</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
 
<span class="c1"># 导入模型前预处理</span>
<span class="c1"># X_train = X_train.values.reshape(X_train.shape[0],X_train.shape[1],1)</span>
<span class="c1"># X_val = X_val.values.reshape(X_val.shape[0],X_val.shape[1],1)</span>
<span class="c1"># y_train = y_train.values.reshape(y_train.shape[0],1)</span>
<span class="c1"># y_val = y_val.values.reshape(y_val.shape[0],1)</span>
 
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">X_val</span><span class="p">),</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y_val</span><span class="p">),</span><span class="n">y_val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; (75000, 205)
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; (25000, 205)
&lt;class &#39;pandas.core.series.Series&#39;&gt; (75000,)
&lt;class &#39;pandas.core.series.Series&#39;&gt; (25000,)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&quot;&quot;&quot;GPU设置为按需增长&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tensorflow.compat.v1</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="c1"># from tensorflow.compat.v1 import ConfigProto</span>
<span class="kn">from</span> <span class="nn">tensorflow.compat.v1.keras.backend</span> <span class="k">import</span> <span class="n">set_session</span>
 
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="c1">#有多个GPU时可以指定只使用第几号GPU</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ConfigProto</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">allow_soft_placement</span><span class="o">=</span><span class="kc">True</span> <span class="c1">#允许动态放置张量和操作符</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">per_process_gpu_memory_fraction</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1">#最多使用40%GPU内存</span>
<span class="n">config</span><span class="o">.</span><span class="n">gpu_options</span><span class="o">.</span><span class="n">allow_growth</span><span class="o">=</span><span class="kc">True</span>   <span class="c1">#初始化时不全部占满GPU显存, 按需分配 </span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">)</span>
<span class="n">set_session</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_features_labels_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/features_labels.csv&#39;</span>
<span class="n">data_train_features_labels_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train_features_labels.csv&#39;</span>
<span class="n">data_val_features_labels_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/val_features_labels.csv&#39;</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data_features_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_features_labels_path</span><span class="p">)</span>
<span class="n">shape_0</span> <span class="o">=</span> <span class="n">data_features_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">shape_1</span> <span class="o">=</span> <span class="n">data_features_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data_train_features_labels</span> <span class="o">=</span> <span class="n">data_features_labels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.75</span><span class="o">*</span><span class="n">shape_0</span><span class="p">),:]</span>
<span class="n">data_train_features_labels</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_train_features_labels_path</span><span class="p">)</span>

<span class="n">data_val_features_labels</span> <span class="o">=</span> <span class="n">data_features_labels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.75</span><span class="o">*</span><span class="n">shape_0</span><span class="p">):,:]</span>
<span class="n">data_val_features_labels</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_val_features_labels_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">cd</span> /content/drive/Shareddrives/xucc1993.HK(CRN.NGO)/CLF_of_ECG_signals/AutoML-AutoDL/akModels-predictClass
<span class="c1"># !pwd</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>/content/drive/Shareddrives/xucc1993.HK(CRN.NGO)/CLF_of_ECG_signals/AutoML-AutoDL/akModels-predictClass
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>


<span class="kn">import</span> <span class="nn">autokeras</span> <span class="k">as</span> <span class="nn">ak</span>

<span class="n">data_train_features_labels_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/train_features_labels.csv&#39;</span>
<span class="n">data_val_features_labels_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/CLF_of_ECG_signals/Data/val_features_labels.csv&#39;</span>

<span class="c1"># data_train_features_labels_path = tf.keras.utils.get_file(data_train_features_labels_path, )</span>
<span class="c1"># data_val_features_labels_path = tf.keras.utils.get_file(data_val_features_labels_path, )</span>

<span class="c1"># Initialize the structured data classifier.</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">ak</span><span class="o">.</span><span class="n">StructuredDataClassifier</span><span class="p">(</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_trials</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>  <span class="c1"># It tries 3 different models.</span>
<span class="c1"># Feed the structured data classifier with training data.</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="c1"># The path to the train.csv file.</span>
    <span class="n">data_train_features_labels_path</span><span class="p">,</span>
    <span class="c1"># The name of the label column.</span>
    <span class="s2">&quot;label&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Predict with the best model.</span>
<span class="n">predicted_y</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_val_features_labels_path</span><span class="p">)</span>
<span class="c1"># Evaluate the best model with testing data.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data_val_features_labels_path</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Trial 2 Complete [00h 03m 28s]
val_accuracy: 1.0

Best val_accuracy So Far: 1.0
Total elapsed time: 00h 06m 54s
Epoch 1/5
[WARNING] [2021-05-12 15:52:16,666:tensorflow] AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x7fdf9e96e680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x7fdf9e96e680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2344/2344 [==============================] - 24s 10ms/step - loss: 0.0000e+00 - accuracy: 0.3240
Epoch 2/5
2344/2344 [==============================] - 23s 10ms/step - loss: 0.0000e+00 - accuracy: 0.2537
Epoch 3/5
2344/2344 [==============================] - 23s 10ms/step - loss: 0.0000e+00 - accuracy: 0.2501
Epoch 4/5
2344/2344 [==============================] - 23s 10ms/step - loss: 0.0000e+00 - accuracy: 0.2470
Epoch 5/5
2344/2344 [==============================] - 23s 10ms/step - loss: 0.0000e+00 - accuracy: 0.2509
[WARNING] [2021-05-12 15:54:16,459:tensorflow] AutoGraph could not transform &lt;function canonicalize_signatures.&lt;locals&gt;.signature_wrapper at 0x7fdf9ee4a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function canonicalize_signatures.&lt;locals&gt;.signature_wrapper at 0x7fdf9ee4a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,565:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ee4a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ee4a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,586:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dfe0f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dfe0f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,605:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e502950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e502950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,624:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced69e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced69e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,638:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e52cb90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e52cb90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,659:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1d8c680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1d8c680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,673:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9dfe0c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9dfe0c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,695:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced6e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced6e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,709:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9dfe0950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9dfe0950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,729:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee2dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee2dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,743:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2ef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2ef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,764:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced6170&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced6170&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,780:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced6560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced6560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,800:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee28c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee28c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,820:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c51add0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c51add0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,846:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee2200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee2200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,859:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,879:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced6200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9ced6200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,892:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1d8cb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1d8cb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,919:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dfe0d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dfe0d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,933:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1d8cb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1d8cb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,951:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45ce60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45ce60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,965:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e45ccb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e45ccb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:16,986:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee2b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cee2b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,001:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,028:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45ce60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45ce60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,042:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e52c290&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e52c290&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,074:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c51a320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c51a320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,090:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e52c290&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e52c290&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,109:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45c440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45c440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,130:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c5a48c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c5a48c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,150:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45c680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45c680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,165:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ee4a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ee4a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,187:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a4b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a4b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,209:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,229:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45cf80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e45cf80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,246:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55ab00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55ab00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,268:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a44d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a44d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,284:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c51a9e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c51a9e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,305:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55a950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55a950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,320:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,345:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a4dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a4dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,359:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c5a44d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c5a44d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,379:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,393:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fcd40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fcd40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,414:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55ad40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55ad40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,428:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e45c320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e45c320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,453:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a48c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c5a48c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,468:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c5a4680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c5a4680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,489:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,507:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,529:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d5fcb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d5fcb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,548:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fc5f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fc5f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,569:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,584:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1d8ca70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1d8ca70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,606:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55a680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55a680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,629:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,650:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,666:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1b75dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1b75dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,693:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00b00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00b00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,707:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55a680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55a680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,729:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1b75320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1b75320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,744:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9ced63b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,765:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,779:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e738b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e738b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,801:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,815:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1b758c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1b758c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,835:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e738c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e738c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,850:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fccb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fccb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,869:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9fc00440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,883:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,904:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1905c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1905c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,917:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cee2c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,938:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1b75e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1b75e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,959:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:17,984:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1905b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1905b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,001:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,021:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e738710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e738710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,042:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d7ae680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d7ae680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,063:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e738710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e738710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,077:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa19050e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa19050e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,098:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d7aecb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d7aecb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,114:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9fc00320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,134:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1905f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1905f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,151:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55a710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,171:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e7389e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e7389e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,186:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e7389e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e7389e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,206:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19ecb90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19ecb90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,221:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e738710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e738710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,242:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55acb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c55acb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,256:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55acb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c55acb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,276:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c4279e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c4279e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,292:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c4277a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c4277a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,312:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d7aeef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d7aeef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,328:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d7ae5f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d7ae5f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,351:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c427d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c427d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,372:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fc9e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d5fc9e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:18,393:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19ece60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19ece60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,332:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9de54560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9de54560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,356:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e954440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e954440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,372:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9de54710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9de54710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,393:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9548c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9548c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,407:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,434:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9618c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9618c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,450:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9de54dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9de54dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,471:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9610e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9610e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,487:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961050&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961050&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,507:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e955680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e955680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,522:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,544:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e961ef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e961ef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,559:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,579:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9554d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e9554d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,596:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e955c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e955c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,617:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6d4dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6d4dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,633:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e9543b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e9543b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,657:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,672:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,692:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6c18c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6c18c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,710:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e9545f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e9545f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,732:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6c1dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6c1dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,752:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,773:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6d4680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6d4680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,788:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6d4320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6d4320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,810:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6c1ef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6c1ef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,832:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6c1b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6c1b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,855:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa0692f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa0692f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,871:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,895:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6d4a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9c6d4a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,912:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,935:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa0692c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa0692c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,950:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,972:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd56d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd56d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:23,988:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,009:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa0692c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa0692c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,025:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e955560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e955560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,047:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd56d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd56d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,061:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd32b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd32b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,083:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,100:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,128:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd324d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd324d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,150:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e961f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,171:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,190:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e349c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e349c20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,209:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd32560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd32560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,227:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd324d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd324d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,249:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e3493b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e3493b0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,267:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6d4680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6d4680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,288:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d466d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d466d40&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,304:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6c1710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9c6c1710&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,324:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,345:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e349e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e349e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,367:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d466f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9d466f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,382:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e349cb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e349cb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,405:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf99fa5dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf99fa5dd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,420:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd56b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd56b90&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,441:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,459:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d466b00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d466b00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,481:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf99fa5f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf99fa5f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,498:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b757950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b757950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,519:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd56e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd56e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,537:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,559:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9b757a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9b757a70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,575:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd56e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd56e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,598:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd32e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9cd32e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,617:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa198ec20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa198ec20&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,638:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e349440&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,654:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b757200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b757200&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,677:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa198ea70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa198ea70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,692:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa198e5f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa198e5f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,713:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19797a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19797a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,729:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d466560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9d466560&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,752:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa198ecb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa198ecb0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,768:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b7579e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b7579e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,789:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19797a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19797a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,808:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b7574d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b7574d0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,831:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9bcfa9e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9bcfa9e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,847:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9bcfadd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9bcfadd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,869:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19790e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa19790e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,886:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf99fa5680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf99fa5680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,909:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9bcfaa70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9bcfaa70&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,926:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd32e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd32e60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,945:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e68bf80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e68bf80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,960:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954170&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e954170&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,983:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9bcfa7a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9bcfa7a0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:24,998:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd56b00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9cd56b00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,023:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e68bdd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e68bdd0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,038:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf99fa5680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf99fa5680&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,068:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dc1e8c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dc1e8c0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,085:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9dc1ee60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9dc1ee60&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,108:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e68bf80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9e68bf80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,126:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e68b320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9e68b320&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,156:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1979f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdfa1979f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,171:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1979f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdfa1979f80&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,193:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9deedef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9deedef0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,209:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b7575f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.save_fn at 0x7fdf9b7575f0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:25,229:tensorflow] AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dc1e950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function _trace_save_and_restore_function.&lt;locals&gt;.restore_fn at 0x7fdf9dc1e950&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:30,916:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc1200&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,927:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc5cb0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,939:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce3dc20&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,950:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce4cb90&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,960:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce4c680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,974:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbb1cb0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,984:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99b61680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:30,994:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce545f0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,005:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a213a70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,014:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce54e60&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,023:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc1950&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,032:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbb1320&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,042:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a1f94d0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,051:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a22f950&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,062:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce3db00&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,072:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc1170&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,083:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a213cb0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,096:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a21d3b0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,104:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a21d7a0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,113:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a213320&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,121:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc55f0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,132:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a1f9a70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,140:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a201290&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,148:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a1f9e60&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,159:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc1440&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,168:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a22fb00&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,177:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a201cb0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,187:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c1b170&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,197:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a201710&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,206:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce54680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,215:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a1f9830&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,230:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c1bb90&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,242:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c1b680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,251:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d9f2200&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,260:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a201a70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,268:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce4c170&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,279:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c100e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,289:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cbc7a70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,297:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a21d200&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:31,308:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9a219290&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,101:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c10b00&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,112:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99bfff80&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,123:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c10290&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,134:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce6bd40&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,143:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce4c440&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,152:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c0e9e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,162:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c0e7a0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,170:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c0c320&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,181:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf99c1b9e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:32,685:tensorflow] AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7fdfa1be3830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7fdfa1be3830&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING] [2021-05-12 15:54:49,590:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d6fbe60&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,598:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9defab90&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,609:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df1d680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,622:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d71a950&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,630:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d722b00&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,643:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9defa950&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,652:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9defadd0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,661:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d6f0170&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,673:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df04200&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,681:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9defb8c0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,692:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d702950&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,701:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d6fba70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,709:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df04a70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,718:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d71a9e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,728:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ceac170&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,736:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cea3ef0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,745:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d6f98c0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,754:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df1d5f0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,761:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ceacb00&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,770:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce90a70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,779:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce90050&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,788:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df1d950&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,797:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9defae60&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,810:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cea59e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,818:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cea3cb0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,827:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df04680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,835:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cea5ef0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,845:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc494d0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,856:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc51ef0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,867:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ce90dd0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,875:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9ceac0e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,884:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9cea3d40&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,895:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc5fa70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,905:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc5f8c0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,912:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d71a4d0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,923:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9d702680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,933:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc660e0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,946:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc68e60&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,960:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc517a0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,969:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df17200&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,978:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc66680&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,987:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc60ef0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:49,996:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc5f440&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,006:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9df1db90&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,016:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc68560&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,025:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dcfa3b0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,032:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dd27ef0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,044:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dcfaa70&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,053:tensorflow] 11 out of the last 11 calls to &lt;function recreate_function.&lt;locals&gt;.restored_function_body at 0x7fdf9dc51b90&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[WARNING] [2021-05-12 15:54:50,554:tensorflow] AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x7fdf9da5bb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x7fdf9da5bb00&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: smac attempted to use a functionality that requires module skopt, but it couldn&#39;t be loaded. Please install skopt and retry.
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
782/782 [==============================] - 13s 15ms/step - loss: 0.0000e+00 - accuracy: 0.0000e+00
[0.0, 0.0]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>
</body>

 

<script type="application/vnd.jupyter.widget-state+json">
{"17566945d6ab40829d27a2c02d70928e": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1a386842f8c04f018f1a6bc82671b03d": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_532ecb5e555343449e2afef2f7c29971", "max": 16, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_c5bd0614b2df48728cb82154f6560497", "value": 16}}, "2058430a95174fd698ed6719a0dc4dec": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_3b215c73f1014eb9b62fd8bf54a80a6c", "IPY_MODEL_1a386842f8c04f018f1a6bc82671b03d", "IPY_MODEL_f7095d4380494a59a32950ef7ecfd50b"], "layout": "IPY_MODEL_b9ad6debbbb04e3283f8947b4b36f646"}}, "23604b8b0bdf48a281736e7b45fbc1c0": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "242ab962063b43c0aa70095148e5476e": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "3b215c73f1014eb9b62fd8bf54a80a6c": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_17566945d6ab40829d27a2c02d70928e", "placeholder": "\u200b", "style": "IPY_MODEL_242ab962063b43c0aa70095148e5476e", "value": "Summarize dataset: 100%"}}, "471313f08acc429ea93aa0614117d019": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_7220a2a95b8f423f90b2c71631aae85e", "placeholder": "\u200b", "style": "IPY_MODEL_a3464d70e65740aabb37d9b4daaf2b41", "value": " 1/1 [00:00&lt;00:00,  1.59it/s]"}}, "532ecb5e555343449e2afef2f7c29971": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "577ac48c48a740c9a2470507bb6c3a60": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "58e5bab52f22484a91c48700156d7cb8": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5d5ebbb51bd741bcbed8d15a9983bf20": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5e64d698c6c1457b9ea0754c5969567f": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "66cac038e50d4f2291bbd63409de6b05": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5d5ebbb51bd741bcbed8d15a9983bf20", "max": 1, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_7e96301d6b80451fa455bd143aa6f015", "value": 1}}, "685edc46ad494e97babff3247f47858c": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8ca991303adf42318898ea2054235705", "max": 1, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_6a281ccafcee46e9bddd670357e1fab9", "value": 1}}, "6a281ccafcee46e9bddd670357e1fab9": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "7220a2a95b8f423f90b2c71631aae85e": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7ccc142146e847ae92869c5a6a3493a7": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "7e96301d6b80451fa455bd143aa6f015": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "7fda10bb8e1748f99aeb6fb6df5836f3": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "8ca991303adf42318898ea2054235705": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "932ee9a6254547e483b877e6f6ee3f37": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "95320707fc8c4c1c85ca85509b222d0b": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9579edb7b78f4ab595edf541942e2da7": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "959b835107294c0992ef46127c7bea96": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_58e5bab52f22484a91c48700156d7cb8", "max": 1, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_9579edb7b78f4ab595edf541942e2da7", "value": 1}}, "9ce8864d9c19454692dedb787a4276a5": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "9e4a003ecfa8410d9dc4abb882da22c0": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_ddcf9de53741443baed426267ff6ecf1", "placeholder": "\u200b", "style": "IPY_MODEL_7ccc142146e847ae92869c5a6a3493a7", "value": "Render HTML: 100%"}}, "a3464d70e65740aabb37d9b4daaf2b41": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "a85ffdd82f984c5694b7060afcb639e0": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ac42e4c91e8c4962871b5c5ffea1e382": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_b23942e6aaa04c0a92688689c6e7e8d2", "placeholder": "\u200b", "style": "IPY_MODEL_932ee9a6254547e483b877e6f6ee3f37", "value": "Export report to file: 100%"}}, "b23942e6aaa04c0a92688689c6e7e8d2": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b35a6dedfd2d4c36bd59d2159515d988": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b9ad6debbbb04e3283f8947b4b36f646": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bfda2581b5f64bc2b02c1932011cc239": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5bd0614b2df48728cb82154f6560497": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c9767270ac404f6d99a4c1465b69f36e": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e064dce707a1430fa4dded5095c71204", "IPY_MODEL_959b835107294c0992ef46127c7bea96", "IPY_MODEL_fb0d4c2ca5a5431bbbd3515f70df71a0"], "layout": "IPY_MODEL_cf4be2286ea84901873eccdd9a22dda9"}}, "cb7885884585433ba2e95b16a76f2bf8": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf4be2286ea84901873eccdd9a22dda9": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ddcf9de53741443baed426267ff6ecf1": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e064dce707a1430fa4dded5095c71204": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_bfda2581b5f64bc2b02c1932011cc239", "placeholder": "\u200b", "style": "IPY_MODEL_a85ffdd82f984c5694b7060afcb639e0", "value": "Generate report structure: 100%"}}, "e7582ea428f44afa906452124c43ddb7": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_577ac48c48a740c9a2470507bb6c3a60", "placeholder": "\u200b", "style": "IPY_MODEL_9ce8864d9c19454692dedb787a4276a5", "value": " 1/1 [00:00&lt;00:00,  2.71it/s]"}}, "f7095d4380494a59a32950ef7ecfd50b": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_95320707fc8c4c1c85ca85509b222d0b", "placeholder": "\u200b", "style": "IPY_MODEL_7fda10bb8e1748f99aeb6fb6df5836f3", "value": " 16/16 [00:25&lt;00:00,  1.04s/it, Completed]"}}, "f8a653e1d4c54ee8bf86bd07c866bb65": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_ac42e4c91e8c4962871b5c5ffea1e382", "IPY_MODEL_685edc46ad494e97babff3247f47858c", "IPY_MODEL_471313f08acc429ea93aa0614117d019"], "layout": "IPY_MODEL_cb7885884585433ba2e95b16a76f2bf8"}}, "fb0d4c2ca5a5431bbbd3515f70df71a0": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_23604b8b0bdf48a281736e7b45fbc1c0", "placeholder": "\u200b", "style": "IPY_MODEL_5e64d698c6c1457b9ea0754c5969567f", "value": " 1/1 [00:02&lt;00:00,  2.84s/it]"}}, "fe4b0d91c3454918a9e45b7c69dc7c62": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9e4a003ecfa8410d9dc4abb882da22c0", "IPY_MODEL_66cac038e50d4f2291bbd63409de6b05", "IPY_MODEL_e7582ea428f44afa906452124c43ddb7"], "layout": "IPY_MODEL_b35a6dedfd2d4c36bd59d2159515d988"}}}
</script>


</html>
